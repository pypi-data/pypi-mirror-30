
binomial.test <- function(success.gpc, success.macs, total.gpc, total.macs) {
    n.gpc <- sum(total.gpc)
    n.macs <- sum(total.macs) 
    p.hat.gpc <- sum(success.gpc)/n.gpc
    p.hat.macs <- sum(success.macs)/n.macs
    p.hat <- weighted.mean(c(p.hat.gpc, p.hat.macs), c(n.gpc, n.macs))
    standard.error <- sqrt(p.hat*(1-p.hat)*(1/n.gpc+1/n.macs))
    z = (p.hat.gpc-p.hat.macs)/standard.error
    return pnorm(z, lower.tail=F)
}
