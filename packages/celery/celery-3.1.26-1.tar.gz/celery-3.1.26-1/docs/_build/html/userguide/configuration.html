
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Configuration and defaults &#8212; Celery 4.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Documenting Tasks with Sphinx" href="sphinx.html" />
    <link rel="prev" title="Extensions and Bootsteps" href="extending.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sphinx.html" title="Documenting Tasks with Sphinx"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="extending.html" title="Extensions and Bootsteps"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Celery 4.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">User Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
<div class="deck">

    
        <p>
        This document describes the current stable version of Celery (4.2).
        For development docs,
        <a href="http://docs.celeryproject.org/en/master/userguide/configuration.html">go here</a>.
        </p>
    

</div>
    <div class="section" id="configuration-and-defaults">
<span id="configuration"></span><h1>Configuration and defaults<a class="headerlink" href="#configuration-and-defaults" title="Permalink to this headline">¶</a></h1>
<p>This document describes the configuration options available.</p>
<p>If you’re using the default loader, you must create the <code class="file docutils literal notranslate"><span class="pre">celeryconfig.py</span></code>
module and make sure it’s available on the Python path.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#example-configuration-file" id="id7">Example configuration file</a></li>
<li><a class="reference internal" href="#new-lowercase-settings" id="id8">New lowercase settings</a></li>
<li><a class="reference internal" href="#configuration-directives" id="id9">Configuration Directives</a><ul>
<li><a class="reference internal" href="#general-settings" id="id10">General settings</a></li>
<li><a class="reference internal" href="#time-and-date-settings" id="id11">Time and date settings</a></li>
<li><a class="reference internal" href="#task-settings" id="id12">Task settings</a></li>
<li><a class="reference internal" href="#task-execution-settings" id="id13">Task execution settings</a></li>
<li><a class="reference internal" href="#task-result-backend-settings" id="id14">Task result backend settings</a></li>
<li><a class="reference internal" href="#database-backend-settings" id="id15">Database backend settings</a></li>
<li><a class="reference internal" href="#rpc-backend-settings" id="id16">RPC backend settings</a></li>
<li><a class="reference internal" href="#cache-backend-settings" id="id17">Cache backend settings</a></li>
<li><a class="reference internal" href="#redis-backend-settings" id="id18">Redis backend settings</a></li>
<li><a class="reference internal" href="#cassandra-backend-settings" id="id19">Cassandra backend settings</a></li>
<li><a class="reference internal" href="#elasticsearch-backend-settings" id="id20">Elasticsearch backend settings</a></li>
<li><a class="reference internal" href="#riak-backend-settings" id="id21">Riak backend settings</a></li>
<li><a class="reference internal" href="#aws-dynamodb-backend-settings" id="id22">AWS DynamoDB backend settings</a></li>
<li><a class="reference internal" href="#ironcache-backend-settings" id="id23">IronCache backend settings</a></li>
<li><a class="reference internal" href="#couchbase-backend-settings" id="id24">Couchbase backend settings</a></li>
<li><a class="reference internal" href="#couchdb-backend-settings" id="id25">CouchDB backend settings</a></li>
<li><a class="reference internal" href="#file-system-backend-settings" id="id26">File-system backend settings</a></li>
<li><a class="reference internal" href="#consul-k-v-store-backend-settings" id="id27">Consul K/V store backend settings</a></li>
<li><a class="reference internal" href="#message-routing" id="id28">Message Routing</a></li>
<li><a class="reference internal" href="#broker-settings" id="id29">Broker Settings</a></li>
<li><a class="reference internal" href="#worker" id="id30">Worker</a></li>
<li><a class="reference internal" href="#events" id="id31">Events</a></li>
<li><a class="reference internal" href="#remote-control-commands" id="id32">Remote Control Commands</a></li>
<li><a class="reference internal" href="#logging" id="id33">Logging</a></li>
<li><a class="reference internal" href="#security" id="id34">Security</a></li>
<li><a class="reference internal" href="#custom-component-classes-advanced" id="id35">Custom Component Classes (advanced)</a></li>
<li><a class="reference internal" href="#beat-settings-celery-beat" id="id36">Beat Settings (<strong class="program">celery beat</strong>)</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="example-configuration-file">
<span id="conf-example"></span><h2><a class="toc-backref" href="#id7">Example configuration file</a><a class="headerlink" href="#example-configuration-file" title="Permalink to this headline">¶</a></h2>
<p>This is an example configuration file to get you started.
It should contain all you need to run a basic Celery set-up.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## Broker settings.</span>
<span class="n">broker_url</span> <span class="o">=</span> <span class="s1">&#39;amqp://guest:guest@localhost:5672//&#39;</span>

<span class="c1"># List of modules to import when the Celery worker starts.</span>
<span class="n">imports</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;myapp.tasks&#39;</span><span class="p">,)</span>

<span class="c1">## Using the database to store task state and results.</span>
<span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;db+sqlite:///results.db&#39;</span>

<span class="n">task_annotations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rate_limit&#39;</span><span class="p">:</span> <span class="s1">&#39;10/s&#39;</span><span class="p">}}</span>
</pre></div>
</div>
</div>
<div class="section" id="new-lowercase-settings">
<span id="conf-old-settings-map"></span><h2><a class="toc-backref" href="#id8">New lowercase settings</a><a class="headerlink" href="#new-lowercase-settings" title="Permalink to this headline">¶</a></h2>
<p>Version 4.0 introduced new lower case settings and setting organization.</p>
<p>The major difference between previous versions, apart from the lower case
names, are the renaming of some prefixes, like <code class="docutils literal notranslate"><span class="pre">celerybeat_</span></code> to <code class="docutils literal notranslate"><span class="pre">beat_</span></code>,
<code class="docutils literal notranslate"><span class="pre">celeryd_</span></code> to <code class="docutils literal notranslate"><span class="pre">worker_</span></code>, and most of the top level <code class="docutils literal notranslate"><span class="pre">celery_</span></code> settings
have been moved into a new  <code class="docutils literal notranslate"><span class="pre">task_</span></code> prefix.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Celery will still be able to read old configuration files, so
there’s no rush in moving to the new settings format. Furthermore,
we provide the <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">upgrade</span></code> command that should handle plenty
of cases (including <a class="reference internal" href="../history/whatsnew-4.0.html#latentcall-django-admonition"><span class="std std-ref">Django</span></a>).</p>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Setting name</strong></th>
<th class="head"><strong>Replace with</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_ACCEPT_CONTENT</span></code></td>
<td><a class="reference internal" href="#std:setting-accept_content"><code class="xref std std-setting docutils literal notranslate"><span class="pre">accept_content</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_ENABLE_UTC</span></code></td>
<td><a class="reference internal" href="#std:setting-enable_utc"><code class="xref std std-setting docutils literal notranslate"><span class="pre">enable_utc</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_IMPORTS</span></code></td>
<td><a class="reference internal" href="#std:setting-imports"><code class="xref std std-setting docutils literal notranslate"><span class="pre">imports</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_INCLUDE</span></code></td>
<td><a class="reference internal" href="#std:setting-include"><code class="xref std std-setting docutils literal notranslate"><span class="pre">include</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TIMEZONE</span></code></td>
<td><a class="reference internal" href="#std:setting-timezone"><code class="xref std std-setting docutils literal notranslate"><span class="pre">timezone</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYBEAT_MAX_LOOP_INTERVAL</span></code></td>
<td><a class="reference internal" href="#std:setting-beat_max_loop_interval"><code class="xref std std-setting docutils literal notranslate"><span class="pre">beat_max_loop_interval</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYBEAT_SCHEDULE</span></code></td>
<td><a class="reference internal" href="#std:setting-beat_schedule"><code class="xref std std-setting docutils literal notranslate"><span class="pre">beat_schedule</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYBEAT_SCHEDULER</span></code></td>
<td><a class="reference internal" href="#std:setting-beat_scheduler"><code class="xref std std-setting docutils literal notranslate"><span class="pre">beat_scheduler</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYBEAT_SCHEDULE_FILENAME</span></code></td>
<td><a class="reference internal" href="#std:setting-beat_schedule_filename"><code class="xref std std-setting docutils literal notranslate"><span class="pre">beat_schedule_filename</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYBEAT_SYNC_EVERY</span></code></td>
<td><a class="reference internal" href="#std:setting-beat_sync_every"><code class="xref std std-setting docutils literal notranslate"><span class="pre">beat_sync_every</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">BROKER_URL</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_url"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_url</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">BROKER_TRANSPORT</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_transport</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">BROKER_TRANSPORT_OPTIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_transport_options"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_transport_options</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">BROKER_CONNECTION_TIMEOUT</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_connection_timeout"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_connection_timeout</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">BROKER_CONNECTION_RETRY</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_connection_retry"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_connection_retry</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">BROKER_CONNECTION_MAX_RETRIES</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_connection_max_retries"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_connection_max_retries</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">BROKER_FAILOVER_STRATEGY</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_failover_strategy"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_failover_strategy</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">BROKER_HEARTBEAT</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_heartbeat"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_heartbeat</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">BROKER_LOGIN_METHOD</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_login_method"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_login_method</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">BROKER_POOL_LIMIT</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_pool_limit"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_pool_limit</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">BROKER_USE_SSL</span></code></td>
<td><a class="reference internal" href="#std:setting-broker_use_ssl"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_use_ssl</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_CACHE_BACKEND</span></code></td>
<td><a class="reference internal" href="#std:setting-cache_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cache_backend</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_CACHE_BACKEND_OPTIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-cache_backend_options"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cache_backend_options</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_COLUMN_FAMILY</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_table"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_table</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_ENTRY_TTL</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_entry_ttl"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_entry_ttl</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_KEYSPACE</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_keyspace"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_keyspace</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_PORT</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_port"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_port</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_READ_CONSISTENCY</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_read_consistency"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_read_consistency</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_SERVERS</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_servers"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_servers</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_WRITE_CONSISTENCY</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_write_consistency"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_write_consistency</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CASSANDRA_OPTIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-cassandra_options"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cassandra_options</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_COUCHBASE_BACKEND_SETTINGS</span></code></td>
<td><a class="reference internal" href="#std:setting-couchbase_backend_settings"><code class="xref std std-setting docutils literal notranslate"><span class="pre">couchbase_backend_settings</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_MONGODB_BACKEND_SETTINGS</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">mongodb_backend_settings</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_EVENT_QUEUE_EXPIRES</span></code></td>
<td><a class="reference internal" href="#std:setting-event_queue_expires"><code class="xref std std-setting docutils literal notranslate"><span class="pre">event_queue_expires</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_EVENT_QUEUE_TTL</span></code></td>
<td><a class="reference internal" href="#std:setting-event_queue_ttl"><code class="xref std std-setting docutils literal notranslate"><span class="pre">event_queue_ttl</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_EVENT_QUEUE_PREFIX</span></code></td>
<td><a class="reference internal" href="#std:setting-event_queue_prefix"><code class="xref std std-setting docutils literal notranslate"><span class="pre">event_queue_prefix</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_EVENT_SERIALIZER</span></code></td>
<td><a class="reference internal" href="#std:setting-event_serializer"><code class="xref std std-setting docutils literal notranslate"><span class="pre">event_serializer</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_REDIS_DB</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">redis_db</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_REDIS_HOST</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">redis_host</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_REDIS_MAX_CONNECTIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-redis_max_connections"><code class="xref std std-setting docutils literal notranslate"><span class="pre">redis_max_connections</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_REDIS_PASSWORD</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">redis_password</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_REDIS_PORT</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">redis_port</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_BACKEND</span></code></td>
<td><a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_MAX_CACHED_RESULTS</span></code></td>
<td><a class="reference internal" href="#std:setting-result_cache_max"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_cache_max</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_MESSAGE_COMPRESSION</span></code></td>
<td><a class="reference internal" href="#std:setting-result_compression"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_compression</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_EXCHANGE</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_exchange</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_EXCHANGE_TYPE</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_exchange_type</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code></td>
<td><a class="reference internal" href="#std:setting-result_expires"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_expires</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_PERSISTENT</span></code></td>
<td><a class="reference internal" href="#std:setting-result_persistent"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_persistent</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_SERIALIZER</span></code></td>
<td><a class="reference internal" href="#std:setting-result_serializer"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_serializer</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_DBURI</span></code></td>
<td>Use <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a> instead.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_ENGINE_OPTIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-database_engine_options"><code class="xref std std-setting docutils literal notranslate"><span class="pre">database_engine_options</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">[...]_DB_SHORT_LIVED_SESSIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-database_short_lived_sessions"><code class="xref std std-setting docutils literal notranslate"><span class="pre">database_short_lived_sessions</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_RESULT_DB_TABLE_NAMES</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">database_db_names</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_SECURITY_CERTIFICATE</span></code></td>
<td><a class="reference internal" href="#std:setting-security_certificate"><code class="xref std std-setting docutils literal notranslate"><span class="pre">security_certificate</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_SECURITY_CERT_STORE</span></code></td>
<td><a class="reference internal" href="#std:setting-security_cert_store"><code class="xref std std-setting docutils literal notranslate"><span class="pre">security_cert_store</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_SECURITY_KEY</span></code></td>
<td><a class="reference internal" href="#std:setting-security_key"><code class="xref std std-setting docutils literal notranslate"><span class="pre">security_key</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_ACKS_LATE</span></code></td>
<td><a class="reference internal" href="#std:setting-task_acks_late"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_acks_late</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_ALWAYS_EAGER</span></code></td>
<td><a class="reference internal" href="#std:setting-task_always_eager"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_always_eager</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_ANNOTATIONS</span></code></td>
<td><a class="reference internal" href="#std:setting-task_annotations"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_annotations</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_COMPRESSION</span></code></td>
<td><a class="reference internal" href="#std:setting-task_compression"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_compression</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_CREATE_MISSING_QUEUES</span></code></td>
<td><a class="reference internal" href="#std:setting-task_create_missing_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_create_missing_queues</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_DEFAULT_DELIVERY_MODE</span></code></td>
<td><a class="reference internal" href="#std:setting-task_default_delivery_mode"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_default_delivery_mode</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_DEFAULT_EXCHANGE</span></code></td>
<td><a class="reference internal" href="#std:setting-task_default_exchange"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_default_exchange</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_DEFAULT_EXCHANGE_TYPE</span></code></td>
<td><a class="reference internal" href="#std:setting-task_default_exchange_type"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_default_exchange_type</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_DEFAULT_QUEUE</span></code></td>
<td><a class="reference internal" href="#std:setting-task_default_queue"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_default_queue</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_DEFAULT_RATE_LIMIT</span></code></td>
<td><a class="reference internal" href="#std:setting-task_default_rate_limit"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_default_rate_limit</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_DEFAULT_ROUTING_KEY</span></code></td>
<td><a class="reference internal" href="#std:setting-task_default_routing_key"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_default_routing_key</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_EAGER_PROPAGATES</span></code></td>
<td><a class="reference internal" href="#std:setting-task_eager_propagates"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_eager_propagates</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_IGNORE_RESULT</span></code></td>
<td><a class="reference internal" href="#std:setting-task_ignore_result"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_ignore_result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_PUBLISH_RETRY</span></code></td>
<td><a class="reference internal" href="#std:setting-task_publish_retry"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_publish_retry</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_PUBLISH_RETRY_POLICY</span></code></td>
<td><a class="reference internal" href="#std:setting-task_publish_retry_policy"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_publish_retry_policy</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_QUEUES</span></code></td>
<td><a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_ROUTES</span></code></td>
<td><a class="reference internal" href="#std:setting-task_routes"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_routes</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_SEND_SENT_EVENT</span></code></td>
<td><a class="reference internal" href="#std:setting-task_send_sent_event"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_send_sent_event</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TASK_SERIALIZER</span></code></td>
<td><a class="reference internal" href="#std:setting-task_serializer"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_serializer</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_TASK_SOFT_TIME_LIMIT</span></code></td>
<td><a class="reference internal" href="#std:setting-task_soft_time_limit"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_soft_time_limit</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_TASK_TIME_LIMIT</span></code></td>
<td><a class="reference internal" href="#std:setting-task_time_limit"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_time_limit</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_TRACK_STARTED</span></code></td>
<td><a class="reference internal" href="#std:setting-task_track_started"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_track_started</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_AGENT</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_agent</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_AUTOSCALER</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_autoscaler"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_autoscaler</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_CONCURRENCY</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_concurrency"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_concurrency</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_CONSUMER</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_consumer"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_consumer</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_WORKER_DIRECT</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_direct"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_direct</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERY_DISABLE_RATE_LIMITS</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_disable_rate_limits"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_disable_rate_limits</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERY_ENABLE_REMOTE_CONTROL</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_enable_remote_control"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_enable_remote_control</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_HIJACK_ROOT_LOGGER</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_hijack_root_logger"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_hijack_root_logger</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_LOG_COLOR</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_log_color"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_log_color</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_LOG_FORMAT</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_log_format"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_log_format</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_WORKER_LOST_WAIT</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_lost_wait"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_lost_wait</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_MAX_TASKS_PER_CHILD</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_max_tasks_per_child"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_max_tasks_per_child</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_POOL</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_pool"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_pool</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_POOL_PUTLOCKS</span></code></td>
<td><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_pool_putlocks</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_POOL_RESTARTS</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_pool_restarts"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_pool_restarts</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_PREFETCH_MULTIPLIER</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_prefetch_multiplier"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_prefetch_multiplier</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_REDIRECT_STDOUTS</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_redirect_stdouts"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_redirect_stdouts</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_REDIRECT_STDOUTS_LEVEL</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_redirect_stdouts_level"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_redirect_stdouts_level</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_SEND_EVENTS</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_send_task_events"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_send_task_events</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_STATE_DB</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_state_db"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_state_db</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_TASK_LOG_FORMAT</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_task_log_format"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_task_log_format</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_TIMER</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_timer"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_timer</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">CELERYD_TIMER_PRECISION</span></code></td>
<td><a class="reference internal" href="#std:setting-worker_timer_precision"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_timer_precision</span></code></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configuration-directives">
<h2><a class="toc-backref" href="#id9">Configuration Directives</a><a class="headerlink" href="#configuration-directives" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-settings">
<span id="conf-datetime"></span><h3><a class="toc-backref" href="#id10">General settings</a><a class="headerlink" href="#general-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="accept-content">
<span id="std:setting-accept_content"></span><h4><code class="docutils literal notranslate"><span class="pre">accept_content</span></code><a class="headerlink" href="#accept-content" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{'json'}</span></code>  (set, list, or tuple).</p>
<p>A white-list of content-types/serializers to allow.</p>
<p>If a message is received that’s not in this list then
the message will be discarded with an error.</p>
<p>By default any content type is enabled, including pickle and yaml,
so make sure untrusted parties don’t have access to your broker.
See <a class="reference internal" href="security.html#guide-security"><span class="std std-ref">Security</span></a> for more.</p>
<p>Example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using serializer name</span>
<span class="n">accept_content</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;json&#39;</span><span class="p">]</span>

<span class="c1"># or the actual content-type (MIME)</span>
<span class="n">accept_content</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;application/json&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="time-and-date-settings">
<h3><a class="toc-backref" href="#id11">Time and date settings</a><a class="headerlink" href="#time-and-date-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="enable-utc">
<span id="std:setting-enable_utc"></span><h4><code class="docutils literal notranslate"><span class="pre">enable_utc</span></code><a class="headerlink" href="#enable-utc" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>Default: Enabled by default since version 3.0.</p>
<p>If enabled dates and times in messages will be converted to use
the UTC timezone.</p>
<p>Note that workers running Celery versions below 2.5 will assume a local
timezone for all messages, so only enable if all workers have been
upgraded.</p>
</div>
<div class="section" id="timezone">
<span id="std:setting-timezone"></span><h4><code class="docutils literal notranslate"><span class="pre">timezone</span></code><a class="headerlink" href="#timezone" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;UTC&quot;</span></code>.</p>
<p>Configure Celery to use a custom time zone.
The timezone value can be any time zone supported by the <a class="reference external" href="https://pypi.python.org/pypi/pytz/">pytz</a>
library.</p>
<p>If not set the UTC timezone is used. For backwards compatibility
there’s also a <a class="reference internal" href="#std:setting-enable_utc"><code class="xref std std-setting docutils literal notranslate"><span class="pre">enable_utc</span></code></a> setting, and this is set
to false the system local timezone is used instead.</p>
</div>
</div>
<div class="section" id="task-settings">
<span id="conf-tasks"></span><h3><a class="toc-backref" href="#id12">Task settings</a><a class="headerlink" href="#task-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="task-annotations">
<span id="std:setting-task_annotations"></span><h4><code class="docutils literal notranslate"><span class="pre">task_annotations</span></code><a class="headerlink" href="#task-annotations" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This setting can be used to rewrite any task attribute from the
configuration. The setting can be a dict, or a list of annotation
objects that filter for tasks and return a map of attributes
to change.</p>
<p>This will change the <code class="docutils literal notranslate"><span class="pre">rate_limit</span></code> attribute for the <code class="docutils literal notranslate"><span class="pre">tasks.add</span></code>
task:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_annotations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rate_limit&#39;</span><span class="p">:</span> <span class="s1">&#39;10/s&#39;</span><span class="p">}}</span>
</pre></div>
</div>
<p>or change the same for all tasks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_annotations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rate_limit&#39;</span><span class="p">:</span> <span class="s1">&#39;10/s&#39;</span><span class="p">}}</span>
</pre></div>
</div>
<p>You can change methods too, for example the <code class="docutils literal notranslate"><span class="pre">on_failure</span></code> handler:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_on_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">einfo</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Oh no! Task failed: {0!r}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span>

<span class="n">task_annotations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;on_failure&#39;</span><span class="p">:</span> <span class="n">my_on_failure</span><span class="p">}}</span>
</pre></div>
</div>
<p>If you need more flexibility then you can use objects
instead of a dict to choose the tasks to annotate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyAnnotate</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">annotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">task</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tasks.&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;rate_limit&#39;</span><span class="p">:</span> <span class="s1">&#39;10/s&#39;</span><span class="p">}</span>

<span class="n">task_annotations</span> <span class="o">=</span> <span class="p">(</span><span class="n">MyAnnotate</span><span class="p">(),</span> <span class="p">{</span><span class="n">other</span><span class="p">,})</span>
</pre></div>
</div>
</div>
<div class="section" id="task-compression">
<span id="std:setting-task_compression"></span><h4><code class="docutils literal notranslate"><span class="pre">task_compression</span></code><a class="headerlink" href="#task-compression" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code></p>
<p>Default compression used for task messages.
Can be <code class="docutils literal notranslate"><span class="pre">gzip</span></code>, <code class="docutils literal notranslate"><span class="pre">bzip2</span></code> (if available), or any custom
compression schemes registered in the Kombu compression registry.</p>
<p>The default is to send uncompressed messages.</p>
</div>
<div class="section" id="task-protocol">
<span id="std:setting-task_protocol"></span><h4><code class="docutils literal notranslate"><span class="pre">task_protocol</span></code><a class="headerlink" href="#task-protocol" title="Permalink to this headline">¶</a></h4>
<p>Default: 2 (since 4.0).</p>
<p>Set the default task message protocol version used to send tasks.
Supports protocols: 1 and 2.</p>
<p>Protocol 2 is supported by 3.1.24 and 4.x+.</p>
</div>
<div class="section" id="task-serializer">
<span id="std:setting-task_serializer"></span><h4><code class="docutils literal notranslate"><span class="pre">task_serializer</span></code><a class="headerlink" href="#task-serializer" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;json&quot;</span></code> (since 4.0, earlier: pickle).</p>
<p>A string identifying the default serialization method to use. Can be
<cite>json</cite> (default), <cite>pickle</cite>, <cite>yaml</cite>, <cite>msgpack</cite>, or any custom serialization
methods that have been registered with <code class="xref py py-mod docutils literal notranslate"><span class="pre">kombu.serialization.registry</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="calling.html#calling-serializers"><span class="std std-ref">Serializers</span></a>.</p>
</div>
</div>
<div class="section" id="task-publish-retry">
<span id="std:setting-task_publish_retry"></span><h4><code class="docutils literal notranslate"><span class="pre">task_publish_retry</span></code><a class="headerlink" href="#task-publish-retry" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>Default: Enabled.</p>
<p>Decides if publishing task messages will be retried in the case
of connection loss or other connection errors.
See also <a class="reference internal" href="#std:setting-task_publish_retry_policy"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_publish_retry_policy</span></code></a>.</p>
</div>
<div class="section" id="task-publish-retry-policy">
<span id="std:setting-task_publish_retry_policy"></span><h4><code class="docutils literal notranslate"><span class="pre">task_publish_retry_policy</span></code><a class="headerlink" href="#task-publish-retry-policy" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>Default: See <a class="reference internal" href="calling.html#calling-retry"><span class="std std-ref">Message Sending Retry</span></a>.</p>
<p>Defines the default policy when retrying publishing a task message in
the case of connection loss or other connection errors.</p>
</div>
</div>
<div class="section" id="task-execution-settings">
<span id="conf-task-execution"></span><h3><a class="toc-backref" href="#id13">Task execution settings</a><a class="headerlink" href="#task-execution-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="task-always-eager">
<span id="std:setting-task_always_eager"></span><h4><code class="docutils literal notranslate"><span class="pre">task_always_eager</span></code><a class="headerlink" href="#task-always-eager" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>If this is <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, all tasks will be executed locally by blocking until
the task returns. <code class="docutils literal notranslate"><span class="pre">apply_async()</span></code> and <code class="docutils literal notranslate"><span class="pre">Task.delay()</span></code> will return
an <a class="reference internal" href="../reference/celery.result.html#celery.result.EagerResult" title="celery.result.EagerResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">EagerResult</span></code></a> instance, that emulates the API
and behavior of <a class="reference internal" href="../reference/celery.result.html#celery.result.AsyncResult" title="celery.result.AsyncResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncResult</span></code></a>, except the result
is already evaluated.</p>
<p>That is, tasks will be executed locally instead of being sent to
the queue.</p>
</div>
<div class="section" id="task-eager-propagates">
<span id="std:setting-task_eager_propagates"></span><h4><code class="docutils literal notranslate"><span class="pre">task_eager_propagates</span></code><a class="headerlink" href="#task-eager-propagates" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>If this is <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, eagerly executed tasks (applied by <cite>task.apply()</cite>,
or when the <a class="reference internal" href="#std:setting-task_always_eager"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_always_eager</span></code></a> setting is enabled), will
propagate exceptions.</p>
<p>It’s the same as always running <code class="docutils literal notranslate"><span class="pre">apply()</span></code> with <code class="docutils literal notranslate"><span class="pre">throw=True</span></code>.</p>
</div>
<div class="section" id="task-remote-tracebacks">
<span id="std:setting-task_remote_tracebacks"></span><h4><code class="docutils literal notranslate"><span class="pre">task_remote_tracebacks</span></code><a class="headerlink" href="#task-remote-tracebacks" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>If enabled task results will include the workers stack when re-raising
task errors.</p>
<p>This requires the <a class="reference external" href="https://pypi.python.org/pypi/tblib/">tblib</a> library, that can be installed using
<strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>tblib<span class="o">]</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for information on combining multiple extension
requirements.</p>
</div>
<div class="section" id="task-ignore-result">
<span id="std:setting-task_ignore_result"></span><h4><code class="docutils literal notranslate"><span class="pre">task_ignore_result</span></code><a class="headerlink" href="#task-ignore-result" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>Whether to store the task return values or not (tombstones).
If you still want to store errors, just not successful return values,
you can set <a class="reference internal" href="#std:setting-task_store_errors_even_if_ignored"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_store_errors_even_if_ignored</span></code></a>.</p>
</div>
<div class="section" id="task-store-errors-even-if-ignored">
<span id="std:setting-task_store_errors_even_if_ignored"></span><h4><code class="docutils literal notranslate"><span class="pre">task_store_errors_even_if_ignored</span></code><a class="headerlink" href="#task-store-errors-even-if-ignored" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>If set, the worker stores all task errors in the result store even if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Task.ignore_result</span></code> is on.</p>
</div>
<div class="section" id="task-track-started">
<span id="std:setting-task_track_started"></span><h4><code class="docutils literal notranslate"><span class="pre">task_track_started</span></code><a class="headerlink" href="#task-track-started" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>If <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> the task will report its status as ‘started’ when the
task is executed by a worker. The default value is <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code> as
the normal behavior is to not report that level of granularity. Tasks
are either pending, finished, or waiting to be retried. Having a ‘started’
state can be useful for when there are long running tasks and there’s a
need to report what task is currently running.</p>
</div>
<div class="section" id="task-time-limit">
<span id="std:setting-task_time_limit"></span><h4><code class="docutils literal notranslate"><span class="pre">task_time_limit</span></code><a class="headerlink" href="#task-time-limit" title="Permalink to this headline">¶</a></h4>
<p>Default: No time limit.</p>
<p>Task hard time limit in seconds. The worker processing the task will
be killed and replaced with a new one when this is exceeded.</p>
</div>
<div class="section" id="task-soft-time-limit">
<span id="std:setting-task_soft_time_limit"></span><h4><code class="docutils literal notranslate"><span class="pre">task_soft_time_limit</span></code><a class="headerlink" href="#task-soft-time-limit" title="Permalink to this headline">¶</a></h4>
<p>Default: No soft time limit.</p>
<p>Task soft time limit in seconds.</p>
<p>The <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.SoftTimeLimitExceeded" title="celery.exceptions.SoftTimeLimitExceeded"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SoftTimeLimitExceeded</span></code></a> exception will be
raised when this is exceeded. For example, the task can catch this to
clean up before the hard time limit comes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">celery.exceptions</span> <span class="kn">import</span> <span class="n">SoftTimeLimitExceeded</span>

<span class="nd">@app.task</span>
<span class="k">def</span> <span class="nf">mytask</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">do_work</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">SoftTimeLimitExceeded</span><span class="p">:</span>
        <span class="n">cleanup_in_a_hurry</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="task-acks-late">
<span id="std:setting-task_acks_late"></span><h4><code class="docutils literal notranslate"><span class="pre">task_acks_late</span></code><a class="headerlink" href="#task-acks-late" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>Late ack means the task messages will be acknowledged <strong>after</strong> the task
has been executed, not <em>just before</em> (the default behavior).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">FAQ: <a class="reference internal" href="../faq.html#faq-acks-late-vs-retry"><span class="std std-ref">Should I use retry or acks_late?</span></a>.</p>
</div>
</div>
<div class="section" id="task-reject-on-worker-lost">
<span id="std:setting-task_reject_on_worker_lost"></span><h4><code class="docutils literal notranslate"><span class="pre">task_reject_on_worker_lost</span></code><a class="headerlink" href="#task-reject-on-worker-lost" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>Even if <a class="reference internal" href="#std:setting-task_acks_late"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_acks_late</span></code></a> is enabled, the worker will
acknowledge tasks when the worker process executing them abruptly
exits or is signaled (e.g., <code class="xref std std-sig docutils literal notranslate"><span class="pre">KILL</span></code>/<code class="xref std std-sig docutils literal notranslate"><span class="pre">INT</span></code>, etc).</p>
<p>Setting this to true allows the message to be re-queued instead,
so that the task will execute again by the same worker, or another
worker.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Enabling this can cause message loops; make sure you know
what you’re doing.</p>
</div>
</div>
<div class="section" id="task-default-rate-limit">
<span id="std:setting-task_default_rate_limit"></span><h4><code class="docutils literal notranslate"><span class="pre">task_default_rate_limit</span></code><a class="headerlink" href="#task-default-rate-limit" title="Permalink to this headline">¶</a></h4>
<p>Default: No rate limit.</p>
<p>The global default rate limit for tasks.</p>
<p>This value is used for tasks that doesn’t have a custom rate limit</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The setting:<cite>worker_disable_rate_limits</cite> setting can
disable all rate limits.</p>
</div>
</div>
</div>
<div class="section" id="task-result-backend-settings">
<span id="conf-result-backend"></span><h3><a class="toc-backref" href="#id14">Task result backend settings</a><a class="headerlink" href="#task-result-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="result-backend">
<span id="std:setting-result_backend"></span><h4><code class="docutils literal notranslate"><span class="pre">result_backend</span></code><a class="headerlink" href="#result-backend" title="Permalink to this headline">¶</a></h4>
<p>Default: No result backend enabled by default.</p>
<p>The backend used to store task results (tombstones).
Can be one of the following:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">rpc</span></code></dt>
<dd>Send results back as AMQP messages
See <a class="reference internal" href="#conf-rpc-result-backend"><span class="std std-ref">RPC backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">database</span></code></dt>
<dd>Use a relational database supported by <a class="reference external" href="http://sqlalchemy.org">SQLAlchemy</a>.
See <a class="reference internal" href="#conf-database-result-backend"><span class="std std-ref">Database backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">redis</span></code></dt>
<dd>Use <a class="reference external" href="https://redis.io">Redis</a> to store the results.
See <a class="reference internal" href="#conf-redis-result-backend"><span class="std std-ref">Redis backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">cache</span></code></dt>
<dd>Use <a class="reference external" href="http://memcached.org">Memcached</a> to store the results.
See <a class="reference internal" href="#conf-cache-result-backend"><span class="std std-ref">Cache backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">cassandra</span></code></dt>
<dd>Use <a class="reference external" href="http://cassandra.apache.org/">Cassandra</a> to store the results.
See <a class="reference internal" href="#conf-cassandra-result-backend"><span class="std std-ref">Cassandra backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">elasticsearch</span></code></dt>
<dd>Use <a class="reference external" href="https://aws.amazon.com/elasticsearch-service/">Elasticsearch</a> to store the results.
See <a class="reference internal" href="#conf-elasticsearch-result-backend"><span class="std std-ref">Elasticsearch backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">ironcache</span></code></dt>
<dd>Use <a class="reference external" href="http://www.iron.io/cache">IronCache</a> to store the results.
See <a class="reference internal" href="#conf-ironcache-result-backend"><span class="std std-ref">IronCache backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">couchbase</span></code></dt>
<dd>Use <a class="reference external" href="https://www.couchbase.com/">Couchbase</a> to store the results.
See <a class="reference internal" href="#conf-couchbase-result-backend"><span class="std std-ref">Couchbase backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">couchdb</span></code></dt>
<dd>Use <a class="reference external" href="http://www.couchdb.com/">CouchDB</a> to store the results.
See <a class="reference internal" href="#conf-couchdb-result-backend"><span class="std std-ref">CouchDB backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">filesystem</span></code></dt>
<dd>Use a shared directory to store the results.
See <a class="reference internal" href="#conf-filesystem-result-backend"><span class="std std-ref">File-system backend settings</span></a>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">consul</span></code></dt>
<dd>Use the <a class="reference external" href="https://consul.io/">Consul</a> K/V store to store the results
See <a class="reference internal" href="#conf-consul-result-backend"><span class="std std-ref">Consul K/V store backend settings</span></a>.</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="result-backend-transport-options">
<span id="std:setting-result_backend_transport_options"></span><h4><code class="docutils literal notranslate"><span class="pre">result_backend_transport_options</span></code><a class="headerlink" href="#result-backend-transport-options" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>A dict of additional options passed to the underlying transport.</p>
<p>See your transport user manual for supported options (if any).</p>
<p>Example setting the visibility timeout (supported by Redis and SQS
transports):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend_transport_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;visibility_timeout&#39;</span><span class="p">:</span> <span class="mi">18000</span><span class="p">}</span>  <span class="c1"># 5 hours</span>
</pre></div>
</div>
</div>
<div class="section" id="result-serializer">
<span id="std:setting-result_serializer"></span><h4><code class="docutils literal notranslate"><span class="pre">result_serializer</span></code><a class="headerlink" href="#result-serializer" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">json</span></code> since 4.0 (earlier: pickle).</p>
<p>Result serialization format.</p>
<p>See <a class="reference internal" href="calling.html#calling-serializers"><span class="std std-ref">Serializers</span></a> for information about supported
serialization formats.</p>
</div>
<div class="section" id="result-compression">
<span id="std:setting-result_compression"></span><h4><code class="docutils literal notranslate"><span class="pre">result_compression</span></code><a class="headerlink" href="#result-compression" title="Permalink to this headline">¶</a></h4>
<p>Default: No compression.</p>
<p>Optional compression method used for task results.
Supports the same options as the <a class="reference internal" href="#std:setting-task_serializer"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_serializer</span></code></a> setting.</p>
</div>
<div class="section" id="result-expires">
<span id="std:setting-result_expires"></span><h4><code class="docutils literal notranslate"><span class="pre">result_expires</span></code><a class="headerlink" href="#result-expires" title="Permalink to this headline">¶</a></h4>
<p>Default: Expire after 1 day.</p>
<p>Time (in seconds, or a <a class="reference external" href="https://docs.python.org/dev/library/datetime.html#datetime.timedelta" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">timedelta</span></code></a> object) for when after
stored task tombstones will be deleted.</p>
<p>A built-in periodic task will delete the results after this time
(<code class="docutils literal notranslate"><span class="pre">celery.backend_cleanup</span></code>), assuming that <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">beat</span></code> is
enabled. The task runs daily at 4am.</p>
<p>A value of <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> or 0 means results will never expire (depending
on backend specifications).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>For the moment this only works with the AMQP, database, cache,
and Redis backends.</p>
<p class="last">When using the database backend, <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">beat</span></code> must be
running for the results to be expired.</p>
</div>
</div>
<div class="section" id="result-cache-max">
<span id="std:setting-result_cache_max"></span><h4><code class="docutils literal notranslate"><span class="pre">result_cache_max</span></code><a class="headerlink" href="#result-cache-max" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled by default.</p>
<p>Enables client caching of results.</p>
<p>This can be useful for the old deprecated
‘amqp’ backend where the result is unavailable as soon as one result instance
consumes it.</p>
<p>This is the total number of results to cache before older results are evicted.
A value of 0 or None means no limit, and a value of <code class="xref py py-const docutils literal notranslate"><span class="pre">-1</span></code>
will disable the cache.</p>
<p>Disabled by default.</p>
</div>
</div>
<div class="section" id="database-backend-settings">
<span id="conf-database-result-backend"></span><h3><a class="toc-backref" href="#id15">Database backend settings</a><a class="headerlink" href="#database-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="database-url-examples">
<h4>Database URL Examples<a class="headerlink" href="#database-url-examples" title="Permalink to this headline">¶</a></h4>
<p>To use the database backend you have to configure the
<a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a> setting with a connection URL and the <code class="docutils literal notranslate"><span class="pre">db+</span></code>
prefix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;db+scheme://user:password@host:port/dbname&#39;</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sqlite (filename)</span>
<span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;db+sqlite:///results.sqlite&#39;</span>

<span class="c1"># mysql</span>
<span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;db+mysql://scott:tiger@localhost/foo&#39;</span>

<span class="c1"># postgresql</span>
<span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;db+postgresql://scott:tiger@localhost/mydatabase&#39;</span>

<span class="c1"># oracle</span>
<span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;db+oracle://scott:tiger@127.0.0.1:1521/sidname&#39;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>Please see <a class="reference external" href="http://www.sqlalchemy.org/docs/core/engines.html#supported-databases">Supported Databases</a> for a table of supported databases,
and <a class="reference external" href="http://www.sqlalchemy.org/docs/core/engines.html#database-urls">Connection String</a> for more information about connection
strings (this is the part of the URI that comes after the <code class="docutils literal notranslate"><span class="pre">db+</span></code> prefix).</p>
</div>
<div class="section" id="database-engine-options">
<span id="std:setting-database_engine_options"></span><h4><code class="docutils literal notranslate"><span class="pre">database_engine_options</span></code><a class="headerlink" href="#database-engine-options" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>To specify additional SQLAlchemy database engine options you can use
the <code class="xref std std-setting docutils literal notranslate"><span class="pre">sqlalchmey_engine_options</span></code> setting:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># echo enables verbose logging from SQLAlchemy.</span>
<span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">database_engine_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;echo&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="database-short-lived-sessions">
<span id="std:setting-database_short_lived_sessions"></span><h4><code class="docutils literal notranslate"><span class="pre">database_short_lived_sessions</span></code><a class="headerlink" href="#database-short-lived-sessions" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled by default.</p>
<p>Short lived sessions are disabled by default. If enabled they can drastically reduce
performance, especially on systems processing lots of tasks. This option is useful
on low-traffic workers that experience errors as a result of cached database connections
going stale through inactivity. For example, intermittent errors like
<cite>(OperationalError) (2006, ‘MySQL server has gone away’)</cite> can be fixed by enabling
short lived sessions. This option only affects the database backend.</p>
</div>
<div class="section" id="database-table-names">
<span id="std:setting-database_table_names"></span><h4><code class="docutils literal notranslate"><span class="pre">database_table_names</span></code><a class="headerlink" href="#database-table-names" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>When SQLAlchemy is configured as the result backend, Celery automatically
creates two tables to store result meta-data for tasks. This setting allows
you to customize the table names:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use custom table names for the database result backend.</span>
<span class="n">database_table_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp_taskmeta&#39;</span><span class="p">,</span>
    <span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="s1">&#39;myapp_groupmeta&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rpc-backend-settings">
<span id="conf-rpc-result-backend"></span><h3><a class="toc-backref" href="#id16">RPC backend settings</a><a class="headerlink" href="#rpc-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="result-persistent">
<span id="std:setting-result_persistent"></span><h4><code class="docutils literal notranslate"><span class="pre">result_persistent</span></code><a class="headerlink" href="#result-persistent" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled by default (transient messages).</p>
<p>If set to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, result messages will be persistent. This means the
messages won’t be lost after a broker restart.</p>
</div>
<div class="section" id="example-configuration">
<h4>Example configuration<a class="headerlink" href="#example-configuration" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;rpc://&#39;</span>
<span class="n">result_persistent</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cache-backend-settings">
<span id="conf-cache-result-backend"></span><h3><a class="toc-backref" href="#id17">Cache backend settings</a><a class="headerlink" href="#cache-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The cache backend supports the <a class="reference external" href="https://pypi.python.org/pypi/pylibmc/">pylibmc</a> and <a class="reference external" href="https://pypi.python.org/pypi/python-memcached/">python-memcached</a>
libraries. The latter is used only if <a class="reference external" href="https://pypi.python.org/pypi/pylibmc/">pylibmc</a> isn’t installed.</p>
</div>
<p>Using a single Memcached server:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;cache+memcached://127.0.0.1:11211/&#39;</span>
</pre></div>
</div>
<p>Using multiple Memcached servers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    cache+memcached://172.19.26.240:11211;172.19.26.242:11211/</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
<p>The “memory” backend stores the cache in memory only:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;cache&#39;</span>
<span class="n">cache_backend</span> <span class="o">=</span> <span class="s1">&#39;memory&#39;</span>
</pre></div>
</div>
<div class="section" id="cache-backend-options">
<span id="std:setting-cache_backend_options"></span><h4><code class="docutils literal notranslate"><span class="pre">cache_backend_options</span></code><a class="headerlink" href="#cache-backend-options" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>You can set <a class="reference external" href="https://pypi.python.org/pypi/pylibmc/">pylibmc</a> options using the <a class="reference internal" href="#std:setting-cache_backend_options"><code class="xref std std-setting docutils literal notranslate"><span class="pre">cache_backend_options</span></code></a>
setting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cache_backend_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;binary&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="s1">&#39;behaviors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;tcp_nodelay&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cache-backend">
<span id="std:setting-cache_backend"></span><h4><code class="docutils literal notranslate"><span class="pre">cache_backend</span></code><a class="headerlink" href="#cache-backend" title="Permalink to this headline">¶</a></h4>
<p>This setting is no longer used as it’s now possible to specify
the cache backend directly in the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a> setting.</p>
</div>
</div>
<div class="section" id="redis-backend-settings">
<span id="conf-redis-result-backend"></span><h3><a class="toc-backref" href="#id18">Redis backend settings</a><a class="headerlink" href="#redis-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="configuring-the-backend-url">
<h4>Configuring the backend URL<a class="headerlink" href="#configuring-the-backend-url" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Redis backend requires the <a class="reference external" href="https://pypi.python.org/pypi/redis/">redis</a> library.</p>
<p>To install this package use <strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>redis<span class="o">]</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for information on combining multiple extension
requirements.</p>
</div>
<p>This backend requires the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a>
setting to be set to a Redis URL:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;redis://:password@host:port/db&#39;</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;redis://localhost/0&#39;</span>
</pre></div>
</div>
<p>is the same as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;redis://&#39;</span>
</pre></div>
</div>
<p>The fields of the URL are defined as follows:</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">password</span></code></p>
<blockquote>
<div><p>Password used to connect to the database.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">host</span></code></p>
<blockquote>
<div><p>Host name or IP address of the Redis server (e.g., <cite>localhost</cite>).</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">port</span></code></p>
<blockquote>
<div><p>Port to the Redis server. Default is 6379.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">db</span></code></p>
<blockquote>
<div><p>Database number to use. Default is 0.
The db can include an optional leading slash.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="redis-backend-use-ssl">
<span id="std:setting-redis_backend_use_ssl"></span><h4><code class="docutils literal notranslate"><span class="pre">redis_backend_use_ssl</span></code><a class="headerlink" href="#redis-backend-use-ssl" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>The Redis backend supports SSL. The valid values of this options are the same
as <a class="reference internal" href="#std:setting-broker_use_ssl"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_use_ssl</span></code></a>.</p>
</div>
<div class="section" id="redis-max-connections">
<span id="std:setting-redis_max_connections"></span><h4><code class="docutils literal notranslate"><span class="pre">redis_max_connections</span></code><a class="headerlink" href="#redis-max-connections" title="Permalink to this headline">¶</a></h4>
<p>Default: No limit.</p>
<p>Maximum number of connections available in the Redis connection
pool used for sending and retrieving results.</p>
</div>
<div class="section" id="redis-socket-connect-timeout">
<span id="std:setting-redis_socket_connect_timeout"></span><h4><code class="docutils literal notranslate"><span class="pre">redis_socket_connect_timeout</span></code><a class="headerlink" href="#redis-socket-connect-timeout" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.0.1.</span></p>
</div>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code></p>
<p>Socket timeout for connections to Redis from the result backend
in seconds (int/float)</p>
</div>
<div class="section" id="redis-socket-timeout">
<span id="std:setting-redis_socket_timeout"></span><h4><code class="docutils literal notranslate"><span class="pre">redis_socket_timeout</span></code><a class="headerlink" href="#redis-socket-timeout" title="Permalink to this headline">¶</a></h4>
<p>Default: 120.0 seconds.</p>
<p>Socket timeout for reading/writing operations to the Redis server
in seconds (int/float), used by the redis result backend.</p>
</div>
</div>
<div class="section" id="cassandra-backend-settings">
<span id="conf-cassandra-result-backend"></span><h3><a class="toc-backref" href="#id19">Cassandra backend settings</a><a class="headerlink" href="#cassandra-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This Cassandra backend driver requires <a class="reference external" href="https://pypi.python.org/pypi/cassandra-driver/">cassandra-driver</a>.</p>
<p>To install, use <strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>cassandra<span class="o">]</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for information on combining multiple extension
requirements.</p>
</div>
<p>This backend requires the following configuration directives to be set.</p>
<div class="section" id="cassandra-servers">
<span id="std:setting-cassandra_servers"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_servers</span></code><a class="headerlink" href="#cassandra-servers" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code> (empty list).</p>
<p>List of <code class="docutils literal notranslate"><span class="pre">host</span></code> Cassandra servers. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cassandra_servers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;localhost&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="cassandra-port">
<span id="std:setting-cassandra_port"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_port</span></code><a class="headerlink" href="#cassandra-port" title="Permalink to this headline">¶</a></h4>
<p>Default: 9042.</p>
<p>Port to contact the Cassandra servers on.</p>
</div>
<div class="section" id="cassandra-keyspace">
<span id="std:setting-cassandra_keyspace"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_keyspace</span></code><a class="headerlink" href="#cassandra-keyspace" title="Permalink to this headline">¶</a></h4>
<p>Default: None.</p>
<p>The key-space in which to store the results. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cassandra_keyspace</span> <span class="o">=</span> <span class="s1">&#39;tasks_keyspace&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="cassandra-table">
<span id="std:setting-cassandra_table"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_table</span></code><a class="headerlink" href="#cassandra-table" title="Permalink to this headline">¶</a></h4>
<p>Default: None.</p>
<p>The table (column family) in which to store the results. For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">cassandra_table</span> <span class="o">=</span> <span class="s1">&#39;tasks&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="cassandra-read-consistency">
<span id="std:setting-cassandra_read_consistency"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_read_consistency</span></code><a class="headerlink" href="#cassandra-read-consistency" title="Permalink to this headline">¶</a></h4>
<p>Default: None.</p>
<p>The read consistency used. Values can be <code class="docutils literal notranslate"><span class="pre">ONE</span></code>, <code class="docutils literal notranslate"><span class="pre">TWO</span></code>, <code class="docutils literal notranslate"><span class="pre">THREE</span></code>, <code class="docutils literal notranslate"><span class="pre">QUORUM</span></code>, <code class="docutils literal notranslate"><span class="pre">ALL</span></code>,
<code class="docutils literal notranslate"><span class="pre">LOCAL_QUORUM</span></code>, <code class="docutils literal notranslate"><span class="pre">EACH_QUORUM</span></code>, <code class="docutils literal notranslate"><span class="pre">LOCAL_ONE</span></code>.</p>
</div>
<div class="section" id="cassandra-write-consistency">
<span id="std:setting-cassandra_write_consistency"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_write_consistency</span></code><a class="headerlink" href="#cassandra-write-consistency" title="Permalink to this headline">¶</a></h4>
<p>Default: None.</p>
<p>The write consistency used. Values can be <code class="docutils literal notranslate"><span class="pre">ONE</span></code>, <code class="docutils literal notranslate"><span class="pre">TWO</span></code>, <code class="docutils literal notranslate"><span class="pre">THREE</span></code>, <code class="docutils literal notranslate"><span class="pre">QUORUM</span></code>, <code class="docutils literal notranslate"><span class="pre">ALL</span></code>,
<code class="docutils literal notranslate"><span class="pre">LOCAL_QUORUM</span></code>, <code class="docutils literal notranslate"><span class="pre">EACH_QUORUM</span></code>, <code class="docutils literal notranslate"><span class="pre">LOCAL_ONE</span></code>.</p>
</div>
<div class="section" id="cassandra-entry-ttl">
<span id="std:setting-cassandra_entry_ttl"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_entry_ttl</span></code><a class="headerlink" href="#cassandra-entry-ttl" title="Permalink to this headline">¶</a></h4>
<p>Default: None.</p>
<p>Time-to-live for status entries. They will expire and be removed after that many seconds
after adding. A value of <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> (default) means they will never expire.</p>
</div>
<div class="section" id="cassandra-auth-provider">
<span id="std:setting-cassandra_auth_provider"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_auth_provider</span></code><a class="headerlink" href="#cassandra-auth-provider" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>AuthProvider class within <code class="docutils literal notranslate"><span class="pre">cassandra.auth</span></code> module to use. Values can be
<code class="docutils literal notranslate"><span class="pre">PlainTextAuthProvider</span></code> or <code class="docutils literal notranslate"><span class="pre">SaslAuthProvider</span></code>.</p>
</div>
<div class="section" id="cassandra-auth-kwargs">
<span id="std:setting-cassandra_auth_kwargs"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_auth_kwargs</span></code><a class="headerlink" href="#cassandra-auth-kwargs" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>Named arguments to pass into the authentication provider. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cassandra_auth_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">username</span><span class="p">:</span> <span class="s1">&#39;cassandra&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="p">:</span> <span class="s1">&#39;cassandra&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cassandra-options">
<span id="std:setting-cassandra_options"></span><h4><code class="docutils literal notranslate"><span class="pre">cassandra_options</span></code><a class="headerlink" href="#cassandra-options" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>Named arguments to pass into the <code class="docutils literal notranslate"><span class="pre">cassandra.cluster</span></code> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cassandra_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cql_version&#39;</span><span class="p">:</span> <span class="s1">&#39;3.2.1&#39;</span>
    <span class="s1">&#39;protocol_version&#39;</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>Example configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cassandra_servers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;localhost&#39;</span><span class="p">]</span>
<span class="n">cassandra_keyspace</span> <span class="o">=</span> <span class="s1">&#39;celery&#39;</span>
<span class="n">cassandra_table</span> <span class="o">=</span> <span class="s1">&#39;tasks&#39;</span>
<span class="n">cassandra_read_consistency</span> <span class="o">=</span> <span class="s1">&#39;ONE&#39;</span>
<span class="n">cassandra_write_consistency</span> <span class="o">=</span> <span class="s1">&#39;ONE&#39;</span>
<span class="n">cassandra_entry_ttl</span> <span class="o">=</span> <span class="mi">86400</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="elasticsearch-backend-settings">
<span id="conf-elasticsearch-result-backend"></span><h3><a class="toc-backref" href="#id20">Elasticsearch backend settings</a><a class="headerlink" href="#elasticsearch-backend-settings" title="Permalink to this headline">¶</a></h3>
<p>To use <a class="reference external" href="https://aws.amazon.com/elasticsearch-service/">Elasticsearch</a> as the result backend you simply need to
configure the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a> setting with the correct URL.</p>
<div class="section" id="id2">
<h4>Example configuration<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;elasticsearch://example.com:9200/index_name/doc_type&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="elasticsearch-retry-on-timeout">
<span id="std:setting-elasticsearch_retry_on_timeout"></span><h4><code class="docutils literal notranslate"><span class="pre">elasticsearch_retry_on_timeout</span></code><a class="headerlink" href="#elasticsearch-retry-on-timeout" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code></p>
<p>Should timeout trigger a retry on different node?</p>
</div>
<div class="section" id="elasticsearch-max-retries">
<span id="std:setting-elasticsearch_max_retries"></span><h4><code class="docutils literal notranslate"><span class="pre">elasticsearch_max_retries</span></code><a class="headerlink" href="#elasticsearch-max-retries" title="Permalink to this headline">¶</a></h4>
<p>Default: 3.</p>
<p>Maximum number of retries before an exception is propagated.</p>
</div>
<div class="section" id="elasticsearch-timeout">
<span id="std:setting-elasticsearch_timeout"></span><h4><code class="docutils literal notranslate"><span class="pre">elasticsearch_timeout</span></code><a class="headerlink" href="#elasticsearch-timeout" title="Permalink to this headline">¶</a></h4>
<p>Default: 10.0 seconds.</p>
<p>Global timeout,used by the elasticsearch result backend.</p>
</div>
</div>
<div class="section" id="riak-backend-settings">
<span id="conf-riak-result-backend"></span><h3><a class="toc-backref" href="#id21">Riak backend settings</a><a class="headerlink" href="#riak-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Riak backend requires the <a class="reference external" href="https://pypi.python.org/pypi/riak/">riak</a> library.</p>
<p>To install the this package use <strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>riak<span class="o">]</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for information on combining multiple extension
requirements.</p>
</div>
<p>This backend requires the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a>
setting to be set to a Riak URL:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;riak://host:port/bucket&#39;</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;riak://localhost/celery</span>
</pre></div>
</div>
<p>is the same as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;riak://&#39;</span>
</pre></div>
</div>
<p>The fields of the URL are defined as follows:</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">host</span></code></p>
<blockquote>
<div><p>Host name or IP address of the Riak server (e.g., <cite>‘localhost’</cite>).</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">port</span></code></p>
<blockquote>
<div><p>Port to the Riak server using the protobuf protocol. Default is 8087.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bucket</span></code></p>
<blockquote>
<div><p>Bucket name to use. Default is <cite>celery</cite>.
The bucket needs to be a string with ASCII characters only.</p>
</div></blockquote>
</li>
</ol>
<p>Alternatively, this backend can be configured with the following configuration directives.</p>
<div class="section" id="std:setting-riak_backend_settings">
<span id="id3"></span><h4><code class="docutils literal notranslate"><span class="pre">riak_backend_settings</span></code><a class="headerlink" href="#std:setting-riak_backend_settings" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>This is a dict supporting the following keys:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">host</span></code></p>
<blockquote>
<div><p>The host name of the Riak server. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;localhost&quot;</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">port</span></code></p>
<blockquote>
<div><p>The port the Riak server is listening to. Defaults to 8087.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bucket</span></code></p>
<blockquote>
<div><p>The bucket name to connect to. Defaults to “celery”.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">protocol</span></code></p>
<blockquote>
<div><p>The protocol to use to connect to the Riak server. This isn’t configurable
via <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a></p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="aws-dynamodb-backend-settings">
<span id="conf-dynamodb-result-backend"></span><h3><a class="toc-backref" href="#id22">AWS DynamoDB backend settings</a><a class="headerlink" href="#aws-dynamodb-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Dynamodb backend requires the <a class="reference external" href="https://pypi.python.org/pypi/boto3/">boto3</a> library.</p>
<p>To install this package use <strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>dynamodb<span class="o">]</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for information on combining multiple extension
requirements.</p>
</div>
<p>This backend requires the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a>
setting to be set to a DynamoDB URL:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;dynamodb://aws_access_key_id:aws_secret_access_key@region:port/table?read=n&amp;write=m&#39;</span>
</pre></div>
</div>
<p>For example, specifying the AWS region and the table name:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;dynamodb://@us-east-1/celery_results</span>
</pre></div>
</div>
<p>or retrieving AWS configuration parameters from the environment, using the default table name (<code class="docutils literal notranslate"><span class="pre">celery</span></code>)
and specifying read and write provisioned throughput:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;dynamodb://@/?read=5&amp;write=5&#39;</span>
</pre></div>
</div>
<p>or using the <a class="reference external" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.html">downloadable version</a>
of DynamoDB
<a class="reference external" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.Endpoint.html">locally</a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;dynamodb://@localhost:8000&#39;</span>
</pre></div>
</div>
<p>or using downloadable version or other service with conforming API deployed on any host:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;dynamodb://@us-east-1&#39;</span>
<span class="n">dynamodb_endpoint_url</span> <span class="o">=</span> <span class="s1">&#39;http://192.168.0.40:8000&#39;</span>
</pre></div>
</div>
<p>The fields of the DynamoDB URL in <code class="docutils literal notranslate"><span class="pre">result_backend</span></code> are defined as follows:</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">aws_access_key_id</span> <span class="pre">&amp;</span> <span class="pre">aws_secret_access_key</span></code></p>
<blockquote>
<div><p>The credentials for accessing AWS API resources. These can also be resolved
by the <a class="reference external" href="https://pypi.python.org/pypi/boto3/">boto3</a> library from various sources, as
described <a class="reference external" href="http://boto3.readthedocs.io/en/latest/guide/configuration.html#configuring-credentials">here</a>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">region</span></code></p>
<blockquote>
<div><p>The AWS region, e.g. <code class="docutils literal notranslate"><span class="pre">us-east-1</span></code> or <code class="docutils literal notranslate"><span class="pre">localhost</span></code> for the <a class="reference external" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.html">Downloadable Version</a>.
See the <a class="reference external" href="https://pypi.python.org/pypi/boto3/">boto3</a> library <a class="reference external" href="http://boto3.readthedocs.io/en/latest/guide/configuration.html#environment-variable-configuration">documentation</a>
for definition options.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">port</span></code></p>
<p>The listening port of the local DynamoDB instance, if you are using the downloadable version.
If you have not specified the <code class="docutils literal notranslate"><span class="pre">region</span></code> parameter as <code class="docutils literal notranslate"><span class="pre">localhost</span></code>,
setting this parameter has <strong>no effect</strong>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">table</span></code></p>
<blockquote>
<div><p>Table name to use. Default is <code class="docutils literal notranslate"><span class="pre">celery</span></code>.
See the <a class="reference external" href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Limits.html#limits-naming-rules">DynamoDB Naming Rules</a>
for information on the allowed characters and length.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">read</span> <span class="pre">&amp;</span> <span class="pre">write</span></code></p>
<blockquote>
<div><p>The Read &amp; Write Capacity Units for the created DynamoDB table. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code> for both read and write.
More details can be found in the <a class="reference external" href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ProvisionedThroughput.html">Provisioned Throughput documentation</a>.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="ironcache-backend-settings">
<span id="conf-ironcache-result-backend"></span><h3><a class="toc-backref" href="#id23">IronCache backend settings</a><a class="headerlink" href="#ironcache-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The IronCache backend requires the <a class="reference external" href="https://pypi.python.org/pypi/iron_celery/">iron_celery</a> library:</p>
<p>To install this package use <strong class="command">pip</strong>:</p>
<div class="last highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install iron_celery
</pre></div>
</div>
</div>
<p>IronCache is configured via the URL provided in <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a>, for example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;ironcache://project_id:token@&#39;</span>
</pre></div>
</div>
<p>Or to change the cache name:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">ironcache</span><span class="p">::</span><span class="o">//</span><span class="n">project_id</span><span class="p">:</span><span class="n">token</span><span class="o">@/</span><span class="n">awesomecache</span>
</pre></div>
</div>
<p>For more information, see: <a class="reference external" href="https://github.com/iron-io/iron_celery">https://github.com/iron-io/iron_celery</a></p>
</div>
<div class="section" id="couchbase-backend-settings">
<span id="conf-couchbase-result-backend"></span><h3><a class="toc-backref" href="#id24">Couchbase backend settings</a><a class="headerlink" href="#couchbase-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Couchbase backend requires the <a class="reference external" href="https://pypi.python.org/pypi/couchbase/">couchbase</a> library.</p>
<p>To install this package use <strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>couchbase<span class="o">]</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for instructions how to combine multiple extension
requirements.</p>
</div>
<p>This backend can be configured via the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a>
set to a Couchbase URL:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;couchbase://username:password@host:port/bucket&#39;</span>
</pre></div>
</div>
<div class="section" id="std:setting-couchbase_backend_settings">
<span id="id5"></span><h4><code class="docutils literal notranslate"><span class="pre">couchbase_backend_settings</span></code><a class="headerlink" href="#std:setting-couchbase_backend_settings" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>This is a dict supporting the following keys:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">host</span></code></p>
<blockquote>
<div><p>Host name of the Couchbase server. Defaults to <code class="docutils literal notranslate"><span class="pre">localhost</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">port</span></code></p>
<blockquote>
<div><p>The port the Couchbase server is listening to. Defaults to <code class="docutils literal notranslate"><span class="pre">8091</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bucket</span></code></p>
<blockquote>
<div><p>The default bucket the Couchbase server is writing to.
Defaults to <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">username</span></code></p>
<blockquote>
<div><p>User name to authenticate to the Couchbase server as (optional).</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">password</span></code></p>
<blockquote>
<div><p>Password to authenticate to the Couchbase server (optional).</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="couchdb-backend-settings">
<span id="conf-couchdb-result-backend"></span><h3><a class="toc-backref" href="#id25">CouchDB backend settings</a><a class="headerlink" href="#couchdb-backend-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The CouchDB backend requires the <a class="reference external" href="https://pypi.python.org/pypi/pycouchdb/">pycouchdb</a> library:</p>
<p>To install this Couchbase package use <strong class="command">pip</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install celery<span class="o">[</span>couchdb<span class="o">]</span>
</pre></div>
</div>
<p class="last">See <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">Bundles</span></a> for information on combining multiple extension
requirements.</p>
</div>
<p>This backend can be configured via the <a class="reference internal" href="#std:setting-result_backend"><code class="xref std std-setting docutils literal notranslate"><span class="pre">result_backend</span></code></a>
set to a CouchDB URL:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_backend</span> <span class="o">=</span> <span class="s1">&#39;couchdb://username:password@host:port/container&#39;</span>
</pre></div>
</div>
<p>The URL is formed out of the following parts:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">username</span></code></p>
<blockquote>
<div><p>User name to authenticate to the CouchDB server as (optional).</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">password</span></code></p>
<blockquote>
<div><p>Password to authenticate to the CouchDB server (optional).</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">host</span></code></p>
<blockquote>
<div><p>Host name of the CouchDB server. Defaults to <code class="docutils literal notranslate"><span class="pre">localhost</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">port</span></code></p>
<blockquote>
<div><p>The port the CouchDB server is listening to. Defaults to <code class="docutils literal notranslate"><span class="pre">8091</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">container</span></code></p>
<blockquote>
<div><p>The default container the CouchDB server is writing to.
Defaults to <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="file-system-backend-settings">
<span id="conf-filesystem-result-backend"></span><h3><a class="toc-backref" href="#id26">File-system backend settings</a><a class="headerlink" href="#file-system-backend-settings" title="Permalink to this headline">¶</a></h3>
<p>This backend can be configured using a file URL, for example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;file:///var/celery/results&#39;</span>
</pre></div>
</div>
<p>The configured directory needs to be shared and writable by all servers using
the backend.</p>
<p>If you’re trying Celery on a single system you can simply use the backend
without any further configuration. For larger clusters you could use NFS,
<a class="reference external" href="http://www.gluster.org/">GlusterFS</a>, CIFS, <a class="reference external" href="http://hadoop.apache.org/">HDFS</a> (using FUSE), or any other file-system.</p>
</div>
<div class="section" id="consul-k-v-store-backend-settings">
<span id="conf-consul-result-backend"></span><h3><a class="toc-backref" href="#id27">Consul K/V store backend settings</a><a class="headerlink" href="#consul-k-v-store-backend-settings" title="Permalink to this headline">¶</a></h3>
<p>The Consul backend can be configured using a URL, for example:</p>
<blockquote>
<div>CELERY_RESULT_BACKEND = ‘consul://localhost:8500/’</div></blockquote>
<p>The backend will storage results in the K/V store of Consul
as individual keys.</p>
<p>The backend supports auto expire of results using TTLs in Consul.</p>
</div>
<div class="section" id="message-routing">
<span id="conf-messaging"></span><h3><a class="toc-backref" href="#id28">Message Routing</a><a class="headerlink" href="#message-routing" title="Permalink to this headline">¶</a></h3>
<span class="target" id="conf-messaging-routing"></span><div class="section" id="task-queues">
<span id="std:setting-task_queues"></span><h4><code class="docutils literal notranslate"><span class="pre">task_queues</span></code><a class="headerlink" href="#task-queues" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> (queue taken from default queue settings).</p>
<p>Most users will not want to specify this setting and should rather use
the <a class="reference internal" href="routing.html#routing-automatic"><span class="std std-ref">automatic routing facilities</span></a>.</p>
<p>If you really want to configure advanced routing, this setting should
be a list of <a class="reference external" href="http://kombu.readthedocs.io/en/master/reference/kombu.html#kombu.Queue" title="(in Kombu v4.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">kombu.Queue</span></code></a> objects the worker will consume from.</p>
<p>Note that workers can be overridden this setting via the
<a class="reference internal" href="../reference/celery.bin.worker.html#cmdoption-celery-worker-q"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Q</span></code></a> option, or individual queues from this
list (by name) can be excluded using the <a class="reference internal" href="../reference/celery.bin.worker.html#cmdoption-celery-worker-x"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span></code></a>
option.</p>
<p>Also see <a class="reference internal" href="routing.html#routing-basics"><span class="std std-ref">Basics</span></a> for more information.</p>
<p>The default is a queue/exchange/binding key of <code class="docutils literal notranslate"><span class="pre">celery</span></code>, with
exchange type <code class="docutils literal notranslate"><span class="pre">direct</span></code>.</p>
<p>See also <a class="reference internal" href="#std:setting-task_routes"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_routes</span></code></a></p>
</div>
<div class="section" id="task-routes">
<span id="std:setting-task_routes"></span><h4><code class="docutils literal notranslate"><span class="pre">task_routes</span></code><a class="headerlink" href="#task-routes" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>A list of routers, or a single router used to route tasks to queues.
When deciding the final destination of a task the routers are consulted
in order.</p>
<p>A router can be specified as either:</p>
<ul class="simple">
<li>A function with the signature <code class="docutils literal notranslate"><span class="pre">(name,</span> <span class="pre">args,</span> <span class="pre">kwargs,</span>
<span class="pre">options,</span> <span class="pre">task=None,</span> <span class="pre">**kwargs)</span></code></li>
<li>A string providing the path to a router function.</li>
<li><dl class="first docutils">
<dt>A dict containing router specification:</dt>
<dd>Will be converted to a <code class="xref py py-class docutils literal notranslate"><span class="pre">celery.routes.MapRoute</span></code> instance.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>A list of <code class="docutils literal notranslate"><span class="pre">(pattern,</span> <span class="pre">route)</span></code> tuples:</dt>
<dd>Will be converted to a <code class="xref py py-class docutils literal notranslate"><span class="pre">celery.routes.MapRoute</span></code> instance.</dd>
</dl>
</li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_routes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;celery.ping&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mytasks.add&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu-bound&#39;</span><span class="p">,</span>
    <span class="s1">&#39;feed.tasks.*&#39;</span><span class="p">:</span> <span class="s1">&#39;feeds&#39;</span><span class="p">,</span>                           <span class="c1"># &lt;-- glob pattern</span>
    <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(image|video)\.tasks\..*&#39;</span><span class="p">):</span> <span class="s1">&#39;media&#39;</span><span class="p">,</span>  <span class="c1"># &lt;-- regex</span>
    <span class="s1">&#39;video.encode&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;queue&#39;</span><span class="p">:</span> <span class="s1">&#39;video&#39;</span><span class="p">,</span>
        <span class="s1">&#39;exchange&#39;</span><span class="p">:</span> <span class="s1">&#39;media&#39;</span>
        <span class="s1">&#39;routing_key&#39;</span><span class="p">:</span> <span class="s1">&#39;media.video.encode&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">task_routes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;myapp.tasks.route_task&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;celery.ping&#39;</span><span class="p">:</span> <span class="s1">&#39;default})</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">myapp.tasks.route_task</span></code> could be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">route_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">task</span> <span class="o">==</span> <span class="s1">&#39;celery.ping&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;queue&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">route_task</span></code> may return a string or a dict. A string then means
it’s a queue name in <a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a>, a dict means it’s a custom route.</p>
<p>When sending tasks, the routers are consulted in order. The first
router that doesn’t return <code class="docutils literal notranslate"><span class="pre">None</span></code> is the route to use. The message options
is then merged with the found route settings, where the routers settings
have priority.</p>
<p>Example if <code class="xref py py-func docutils literal notranslate"><span class="pre">apply_async()</span></code> has these arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Task</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">immediate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s1">&#39;video&#39;</span><span class="p">,</span>
                 <span class="n">routing_key</span><span class="o">=</span><span class="s1">&#39;video.compress&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and a router returns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;immediate&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;exchange&#39;</span><span class="p">:</span> <span class="s1">&#39;urgent&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>the final message options will be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">immediate</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s1">&#39;urgent&#39;</span><span class="p">,</span> <span class="n">routing_key</span><span class="o">=</span><span class="s1">&#39;video.compress&#39;</span>
</pre></div>
</div>
<p>(and any default message options defined in the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> class)</p>
<p>Values defined in <a class="reference internal" href="#std:setting-task_routes"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_routes</span></code></a> have precedence over values defined in
<a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a> when merging the two.</p>
<p>With the follow settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_queues</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;cpubound&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;exchange&#39;</span><span class="p">:</span> <span class="s1">&#39;cpubound&#39;</span><span class="p">,</span>
        <span class="s1">&#39;routing_key&#39;</span><span class="p">:</span> <span class="s1">&#39;cpubound&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">task_routes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;queue&#39;</span><span class="p">:</span> <span class="s1">&#39;cpubound&#39;</span><span class="p">,</span>
        <span class="s1">&#39;routing_key&#39;</span><span class="p">:</span> <span class="s1">&#39;tasks.add&#39;</span><span class="p">,</span>
        <span class="s1">&#39;serializer&#39;</span><span class="p">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The final routing options for <code class="docutils literal notranslate"><span class="pre">tasks.add</span></code> will become:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;exchange&#39;</span><span class="o">:</span> <span class="s1">&#39;cpubound&#39;</span><span class="p">,</span>
 <span class="s1">&#39;routing_key&#39;</span><span class="o">:</span> <span class="s1">&#39;tasks.add&#39;</span><span class="p">,</span>
 <span class="s1">&#39;serializer&#39;</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="routing.html#routers"><span class="std std-ref">Routers</span></a> for more examples.</p>
</div>
<div class="section" id="task-queue-ha-policy">
<span id="std:setting-task_queue_ha_policy"></span><h4><code class="docutils literal notranslate"><span class="pre">task_queue_ha_policy</span></code><a class="headerlink" href="#task-queue-ha-policy" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">brokers:</th><td class="field-body">RabbitMQ</td>
</tr>
</tbody>
</table>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This will set the default HA policy for a queue, and the value
can either be a string (usually <code class="docutils literal notranslate"><span class="pre">all</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_queue_ha_policy</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
</pre></div>
</div>
<p>Using ‘all’ will replicate the queue to all current nodes,
Or you can give it a list of nodes to replicate to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_queue_ha_policy</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rabbit@host1&#39;</span><span class="p">,</span> <span class="s1">&#39;rabbit@host2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Using a list will implicitly set <code class="docutils literal notranslate"><span class="pre">x-ha-policy</span></code> to ‘nodes’ and
<code class="docutils literal notranslate"><span class="pre">x-ha-policy-params</span></code> to the given list of nodes.</p>
<p>See <a class="reference external" href="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</a> for more information.</p>
</div>
<div class="section" id="task-queue-max-priority">
<span id="std:setting-task_queue_max_priority"></span><h4><code class="docutils literal notranslate"><span class="pre">task_queue_max_priority</span></code><a class="headerlink" href="#task-queue-max-priority" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">brokers:</th><td class="field-body">RabbitMQ</td>
</tr>
</tbody>
</table>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>See <a class="reference internal" href="routing.html#routing-options-rabbitmq-priorities"><span class="std std-ref">RabbitMQ Message Priorities</span></a>.</p>
</div>
<div class="section" id="worker-direct">
<span id="std:setting-worker_direct"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_direct</span></code><a class="headerlink" href="#worker-direct" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled.</p>
<p>This option enables so that every worker has a dedicated queue,
so that tasks can be routed to specific workers.</p>
<p>The queue name for each worker is automatically generated based on
the worker hostname and a <code class="docutils literal notranslate"><span class="pre">.dq</span></code> suffix, using the <code class="docutils literal notranslate"><span class="pre">C.dq</span></code> exchange.</p>
<p>For example the queue name for the worker with node name <code class="docutils literal notranslate"><span class="pre">w1&#64;example.com</span></code>
becomes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">w1</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">.</span><span class="n">dq</span>
</pre></div>
</div>
<p>Then you can route the task to the task by specifying the hostname
as the routing key and the <code class="docutils literal notranslate"><span class="pre">C.dq</span></code> exchange:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">task_routes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;exchange&#39;</span><span class="p">:</span> <span class="s1">&#39;C.dq&#39;</span><span class="p">,</span> <span class="s1">&#39;routing_key&#39;</span><span class="p">:</span> <span class="s1">&#39;w1@example.com&#39;</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="task-create-missing-queues">
<span id="std:setting-task_create_missing_queues"></span><h4><code class="docutils literal notranslate"><span class="pre">task_create_missing_queues</span></code><a class="headerlink" href="#task-create-missing-queues" title="Permalink to this headline">¶</a></h4>
<p>Default: Enabled.</p>
<p>If enabled (default), any queues specified that aren’t defined in
<a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a> will be automatically created. See
<a class="reference internal" href="routing.html#routing-automatic"><span class="std std-ref">Automatic routing</span></a>.</p>
</div>
<div class="section" id="task-default-queue">
<span id="std:setting-task_default_queue"></span><h4><code class="docutils literal notranslate"><span class="pre">task_default_queue</span></code><a class="headerlink" href="#task-default-queue" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celery&quot;</span></code>.</p>
<p>The name of the default queue used by <cite>.apply_async</cite> if the message has
no route or no custom queue has been specified.</p>
<p>This queue must be listed in <a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a>.
If <a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a> isn’t specified then it’s automatically
created containing one queue entry, where this name is used as the name of
that queue.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="routing.html#routing-changing-default-queue"><span class="std std-ref">Changing the name of the default queue</span></a></p>
</div>
</div>
<div class="section" id="task-default-exchange">
<span id="std:setting-task_default_exchange"></span><h4><code class="docutils literal notranslate"><span class="pre">task_default_exchange</span></code><a class="headerlink" href="#task-default-exchange" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celery&quot;</span></code>.</p>
<p>Name of the default exchange to use when no custom exchange is
specified for a key in the <a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a> setting.</p>
</div>
<div class="section" id="task-default-exchange-type">
<span id="std:setting-task_default_exchange_type"></span><h4><code class="docutils literal notranslate"><span class="pre">task_default_exchange_type</span></code><a class="headerlink" href="#task-default-exchange-type" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;direct&quot;</span></code>.</p>
<p>Default exchange type used when no custom exchange type is specified
for a key in the <a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a> setting.</p>
</div>
<div class="section" id="task-default-routing-key">
<span id="std:setting-task_default_routing_key"></span><h4><code class="docutils literal notranslate"><span class="pre">task_default_routing_key</span></code><a class="headerlink" href="#task-default-routing-key" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celery&quot;</span></code>.</p>
<p>The default routing key used when no custom routing key
is specified for a key in the <a class="reference internal" href="#std:setting-task_queues"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_queues</span></code></a> setting.</p>
</div>
<div class="section" id="task-default-delivery-mode">
<span id="std:setting-task_default_delivery_mode"></span><h4><code class="docutils literal notranslate"><span class="pre">task_default_delivery_mode</span></code><a class="headerlink" href="#task-default-delivery-mode" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;persistent&quot;</span></code>.</p>
<p>Can be <cite>transient</cite> (messages not written to disk) or <cite>persistent</cite> (written to
disk).</p>
</div>
</div>
<div class="section" id="broker-settings">
<span id="conf-broker-settings"></span><h3><a class="toc-backref" href="#id29">Broker Settings</a><a class="headerlink" href="#broker-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="broker-url">
<span id="std:setting-broker_url"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_url</span></code><a class="headerlink" href="#broker-url" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;amqp://&quot;</span></code></p>
<p>Default broker URL. This must be a URL in the form of:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">transport</span><span class="p">:</span><span class="o">//</span><span class="n">userid</span><span class="p">:</span><span class="n">password</span><span class="nd">@hostname</span><span class="p">:</span><span class="n">port</span><span class="o">/</span><span class="n">virtual_host</span>
</pre></div>
</div>
<p>Only the scheme part (<code class="docutils literal notranslate"><span class="pre">transport://</span></code>) is required, the rest
is optional, and defaults to the specific transports default values.</p>
<p>The transport part is the broker implementation to use, and the
default is <code class="docutils literal notranslate"><span class="pre">amqp</span></code>, (uses <code class="docutils literal notranslate"><span class="pre">librabbitmq</span></code> if installed or falls back to
<code class="docutils literal notranslate"><span class="pre">pyamqp</span></code>). There are also other choices available, including;
<code class="docutils literal notranslate"><span class="pre">redis://</span></code>, <code class="docutils literal notranslate"><span class="pre">sqs://</span></code>, and <code class="docutils literal notranslate"><span class="pre">qpid://</span></code>.</p>
<p>The scheme can also be a fully qualified path to your own transport
implementation:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">broker_url</span> <span class="o">=</span> <span class="s1">&#39;proj.transports.MyTransport://localhost&#39;</span>
</pre></div>
</div>
<p>More than one broker URL, of the same transport, can also be specified.
The broker URLs can be passed in as a single string that’s semicolon delimited:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">broker_url</span> <span class="o">=</span> <span class="s1">&#39;transport://userid:password@hostname:port//;transport://userid:password@hostname:port//&#39;</span>
</pre></div>
</div>
<p>Or as a list:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">broker_url</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;transport://userid:password@localhost:port//&#39;</span><span class="p">,</span>
    <span class="s1">&#39;transport://userid:password@hostname:port//&#39;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The brokers will then be used in the <a class="reference internal" href="#std:setting-broker_failover_strategy"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_failover_strategy</span></code></a>.</p>
<p>See <a class="reference external" href="http://kombu.readthedocs.io/en/master/userguide/connections.html#connection-urls" title="(in Kombu v4.2)"><span>URLs</span></a> in the Kombu documentation for more
information.</p>
<span class="target" id="std:setting-broker_read_url"></span></div>
<div class="section" id="broker-read-url-broker-write-url">
<span id="std:setting-broker_write_url"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_read_url</span></code> / <code class="docutils literal notranslate"><span class="pre">broker_write_url</span></code><a class="headerlink" href="#broker-read-url-broker-write-url" title="Permalink to this headline">¶</a></h4>
<p>Default: Taken from <a class="reference internal" href="#std:setting-broker_url"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_url</span></code></a>.</p>
<p>These settings can be configured, instead of <a class="reference internal" href="#std:setting-broker_url"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_url</span></code></a> to specify
different connection parameters for broker connections used for consuming and
producing.</p>
<p>Example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">broker_read_url</span> <span class="o">=</span> <span class="s1">&#39;amqp://user:pass@broker.example.com:56721&#39;</span>
<span class="n">broker_write_url</span> <span class="o">=</span> <span class="s1">&#39;amqp://user:pass@broker.example.com:56722&#39;</span>
</pre></div>
</div>
<p>Both options can also be specified as a list for failover alternates, see
<a class="reference internal" href="#std:setting-broker_url"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_url</span></code></a> for more information.</p>
</div>
<div class="section" id="broker-failover-strategy">
<span id="std:setting-broker_failover_strategy"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_failover_strategy</span></code><a class="headerlink" href="#broker-failover-strategy" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;round-robin&quot;</span></code>.</p>
<p>Default failover strategy for the broker Connection object. If supplied,
may map to a key in ‘kombu.connection.failover_strategies’, or be a reference
to any method that yields a single item from a supplied list.</p>
<p>Example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Random failover strategy</span>
<span class="k">def</span> <span class="nf">random_failover_strategy</span><span class="p">(</span><span class="n">servers</span><span class="p">):</span>
    <span class="n">it</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">servers</span><span class="p">)</span>  <span class="c1"># don&#39;t modify callers list</span>
    <span class="n">shuffle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">repeat</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">shuffle</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">broker_failover_strategy</span> <span class="o">=</span> <span class="n">random_failover_strategy</span>
</pre></div>
</div>
</div>
<div class="section" id="broker-heartbeat">
<span id="std:setting-broker_heartbeat"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_heartbeat</span></code><a class="headerlink" href="#broker-heartbeat" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">transports supported:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><code class="docutils literal notranslate"><span class="pre">pyamqp</span></code></td>
</tr>
</tbody>
</table>
<p>Default: <code class="docutils literal notranslate"><span class="pre">120.0</span></code> (negotiated by server).</p>
<p>Note: This value is only used by the worker, clients do not use
a heartbeat at the moment.</p>
<p>It’s not always possible to detect connection loss in a timely
manner using TCP/IP alone, so AMQP defines something called heartbeats
that’s is used both by the client and the broker to detect if
a connection was closed.</p>
<p>If the heartbeat value is 10 seconds, then
the heartbeat will be monitored at the interval specified
by the <a class="reference internal" href="#std:setting-broker_heartbeat_checkrate"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_heartbeat_checkrate</span></code></a> setting (by default
this is set to double the rate of the heartbeat value,
so for the 10 seconds, the heartbeat is checked every 5 seconds).</p>
</div>
<div class="section" id="broker-heartbeat-checkrate">
<span id="std:setting-broker_heartbeat_checkrate"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_heartbeat_checkrate</span></code><a class="headerlink" href="#broker-heartbeat-checkrate" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">transports supported:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><code class="docutils literal notranslate"><span class="pre">pyamqp</span></code></td>
</tr>
</tbody>
</table>
<p>Default: 2.0.</p>
<p>At intervals the worker will monitor that the broker hasn’t missed
too many heartbeats. The rate at which this is checked is calculated
by dividing the <a class="reference internal" href="#std:setting-broker_heartbeat"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_heartbeat</span></code></a> value with this value,
so if the heartbeat is 10.0 and the rate is the default 2.0, the check
will be performed every 5 seconds (twice the heartbeat sending rate).</p>
</div>
<div class="section" id="broker-use-ssl">
<span id="std:setting-broker_use_ssl"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_use_ssl</span></code><a class="headerlink" href="#broker-use-ssl" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">transports supported:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><code class="docutils literal notranslate"><span class="pre">pyamqp</span></code>, <code class="docutils literal notranslate"><span class="pre">redis</span></code></td>
</tr>
</tbody>
</table>
<p>Default: Disabled.</p>
<p>Toggles SSL usage on broker connection and SSL settings.</p>
<p>The valid values for this option vary by transport.</p>
<div class="section" id="pyamqp">
<h5><code class="docutils literal notranslate"><span class="pre">pyamqp</span></code><a class="headerlink" href="#pyamqp" title="Permalink to this headline">¶</a></h5>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> the connection will use SSL with default SSL settings.
If set to a dict, will configure SSL connection according to the specified
policy. The format used is Python’s <a class="reference external" href="https://docs.python.org/dev/library/ssl.html#ssl.wrap_socket" title="(in Python v3.8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">ssl.wrap_socket()</span></code></a> options.</p>
<p>Note that SSL socket is generally served on a separate port by the broker.</p>
<p>Example providing a client cert and validating the server cert against a custom
certificate authority:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ssl</span>

<span class="n">broker_use_ssl</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;keyfile&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/ssl/private/worker-key.pem&#39;</span><span class="p">,</span>
  <span class="s1">&#39;certfile&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/ssl/amqp-server-cert.pem&#39;</span><span class="p">,</span>
  <span class="s1">&#39;ca_certs&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/ssl/myca.pem&#39;</span><span class="p">,</span>
  <span class="s1">&#39;cert_reqs&#39;</span><span class="p">:</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Be careful using <code class="docutils literal notranslate"><span class="pre">broker_use_ssl=True</span></code>. It’s possible that your default
configuration won’t validate the server cert at all. Please read Python
<a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl-security">ssl module security
considerations</a>.</p>
</div>
</div>
<div class="section" id="id6">
<h5><code class="docutils literal notranslate"><span class="pre">redis</span></code><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<p>The setting must be a dict the keys:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">ssl_cert_reqs</span></code> (required): one of the <code class="docutils literal notranslate"><span class="pre">SSLContext.verify_mode</span></code> values:</dt>
<dd><ul class="first last">
<li><code class="docutils literal notranslate"><span class="pre">ssl.CERT_NONE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ssl.CERT_OPTIONAL</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ssl.CERT_REQUIRED</span></code></li>
</ul>
</dd>
</dl>
</li>
<li><code class="docutils literal notranslate"><span class="pre">ssl_ca_certs</span></code> (optional): path to the CA certificate</li>
<li><code class="docutils literal notranslate"><span class="pre">ssl_certfile</span></code> (optional): path to the client certificate</li>
<li><code class="docutils literal notranslate"><span class="pre">ssl_keyfile</span></code> (optional): path to the client key</li>
</ul>
</div>
</div>
<div class="section" id="broker-pool-limit">
<span id="std:setting-broker_pool_limit"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_pool_limit</span></code><a class="headerlink" href="#broker-pool-limit" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<p>Default: 10.</p>
<p>The maximum number of connections that can be open in the connection pool.</p>
<p>The pool is enabled by default since version 2.5, with a default limit of ten
connections. This number can be tweaked depending on the number of
threads/green-threads (eventlet/gevent) using a connection. For example
running eventlet with 1000 greenlets that use a connection to the broker,
contention can arise and you should consider increasing the limit.</p>
<p>If set to <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> or 0 the connection pool will be disabled and
connections will be established and closed for every use.</p>
</div>
<div class="section" id="broker-connection-timeout">
<span id="std:setting-broker_connection_timeout"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_connection_timeout</span></code><a class="headerlink" href="#broker-connection-timeout" title="Permalink to this headline">¶</a></h4>
<p>Default: 4.0.</p>
<p>The default timeout in seconds before we give up establishing a connection
to the AMQP server. This setting is disabled when using
gevent.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The broker connection timeout only applies to a worker attempting to
connect to the broker. It does not apply to producer sending a task, see
<a class="reference internal" href="#std:setting-broker_transport_options"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_transport_options</span></code></a> for how to provide a timeout for that
situation.</p>
</div>
</div>
<div class="section" id="broker-connection-retry">
<span id="std:setting-broker_connection_retry"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_connection_retry</span></code><a class="headerlink" href="#broker-connection-retry" title="Permalink to this headline">¶</a></h4>
<p>Default: Enabled.</p>
<p>Automatically try to re-establish the connection to the AMQP broker if lost.</p>
<p>The time between retries is increased for each retry, and is
not exhausted before <a class="reference internal" href="#std:setting-broker_connection_max_retries"><code class="xref std std-setting docutils literal notranslate"><span class="pre">broker_connection_max_retries</span></code></a> is
exceeded.</p>
</div>
<div class="section" id="broker-connection-max-retries">
<span id="std:setting-broker_connection_max_retries"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_connection_max_retries</span></code><a class="headerlink" href="#broker-connection-max-retries" title="Permalink to this headline">¶</a></h4>
<p>Default: 100.</p>
<p>Maximum number of retries before we give up re-establishing a connection
to the AMQP broker.</p>
<p>If this is set to <code class="xref py py-const docutils literal notranslate"><span class="pre">0</span></code> or <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>, we’ll retry forever.</p>
</div>
<div class="section" id="broker-login-method">
<span id="std:setting-broker_login_method"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_login_method</span></code><a class="headerlink" href="#broker-login-method" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;AMQPLAIN&quot;</span></code>.</p>
<p>Set custom amqp login method.</p>
</div>
<div class="section" id="broker-transport-options">
<span id="std:setting-broker_transport_options"></span><h4><code class="docutils literal notranslate"><span class="pre">broker_transport_options</span></code><a class="headerlink" href="#broker-transport-options" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>A dict of additional options passed to the underlying transport.</p>
<p>See your transport user manual for supported options (if any).</p>
<p>Example setting the visibility timeout (supported by Redis and SQS
transports):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">broker_transport_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;visibility_timeout&#39;</span><span class="p">:</span> <span class="mi">18000</span><span class="p">}</span>  <span class="c1"># 5 hours</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="worker">
<span id="conf-worker"></span><h3><a class="toc-backref" href="#id30">Worker</a><a class="headerlink" href="#worker" title="Permalink to this headline">¶</a></h3>
<div class="section" id="imports">
<span id="std:setting-imports"></span><h4><code class="docutils literal notranslate"><span class="pre">imports</span></code><a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code> (empty list).</p>
<p>A sequence of modules to import when the worker starts.</p>
<p>This is used to specify the task modules to import, but also
to import signal handlers and additional remote control commands, etc.</p>
<p>The modules will be imported in the original order.</p>
</div>
<div class="section" id="include">
<span id="std:setting-include"></span><h4><code class="docutils literal notranslate"><span class="pre">include</span></code><a class="headerlink" href="#include" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">[]</span></code> (empty list).</p>
<p>Exact same semantics as <a class="reference internal" href="#std:setting-imports"><code class="xref std std-setting docutils literal notranslate"><span class="pre">imports</span></code></a>, but can be used as a means
to have different import categories.</p>
<p>The modules in this setting are imported after the modules in
<a class="reference internal" href="#std:setting-imports"><code class="xref std std-setting docutils literal notranslate"><span class="pre">imports</span></code></a>.</p>
<span class="target" id="conf-concurrency"></span></div>
<div class="section" id="worker-concurrency">
<span id="std:setting-worker_concurrency"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_concurrency</span></code><a class="headerlink" href="#worker-concurrency" title="Permalink to this headline">¶</a></h4>
<p>Default: Number of CPU cores.</p>
<p>The number of concurrent worker processes/threads/green threads executing
tasks.</p>
<p>If you’re doing mostly I/O you can have more processes,
but if mostly CPU-bound, try to keep it close to the
number of CPUs on your machine. If not set, the number of CPUs/cores
on the host will be used.</p>
</div>
<div class="section" id="worker-prefetch-multiplier">
<span id="std:setting-worker_prefetch_multiplier"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_prefetch_multiplier</span></code><a class="headerlink" href="#worker-prefetch-multiplier" title="Permalink to this headline">¶</a></h4>
<p>Default: 4.</p>
<p>How many messages to prefetch at a time multiplied by the number of
concurrent processes. The default is 4 (four messages for each
process). The default setting is usually a good choice, however – if you
have very long running tasks waiting in the queue and you have to start the
workers, note that the first worker to start will receive four times the
number of messages initially. Thus the tasks may not be fairly distributed
to the workers.</p>
<p>To disable prefetching, set <a class="reference internal" href="#std:setting-worker_prefetch_multiplier"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_prefetch_multiplier</span></code></a> to 1.
Changing that setting to 0 will allow the worker to keep consuming
as many messages as it wants.</p>
<p>For more on prefetching, read <a class="reference internal" href="optimizing.html#optimizing-prefetch-limit"><span class="std std-ref">Prefetch Limits</span></a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tasks with ETA/countdown aren’t affected by prefetch limits.</p>
</div>
</div>
<div class="section" id="worker-lost-wait">
<span id="std:setting-worker_lost_wait"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_lost_wait</span></code><a class="headerlink" href="#worker-lost-wait" title="Permalink to this headline">¶</a></h4>
<p>Default: 10.0 seconds.</p>
<p>In some cases a worker may be killed without proper cleanup,
and the worker may have published a result before terminating.
This value specifies how long we wait for any missing results before
raising a <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.WorkerLostError" title="celery.exceptions.WorkerLostError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">WorkerLostError</span></code></a> exception.</p>
</div>
<div class="section" id="worker-max-tasks-per-child">
<span id="std:setting-worker_max_tasks_per_child"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_max_tasks_per_child</span></code><a class="headerlink" href="#worker-max-tasks-per-child" title="Permalink to this headline">¶</a></h4>
<p>Maximum number of tasks a pool worker process can execute before
it’s replaced with a new one. Default is no limit.</p>
</div>
<div class="section" id="worker-max-memory-per-child">
<span id="std:setting-worker_max_memory_per_child"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_max_memory_per_child</span></code><a class="headerlink" href="#worker-max-memory-per-child" title="Permalink to this headline">¶</a></h4>
<p>Default: No limit.
Type: int (kilobytes)</p>
<p>Maximum amount of resident memory, in kilobytes, that may be consumed by a
worker before it will be replaced by a new worker. If a single
task causes a worker to exceed this limit, the task will be
completed, and the worker will be replaced afterwards.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worker_max_memory_per_child</span> <span class="o">=</span> <span class="mi">12000</span>  <span class="c1"># 12MB</span>
</pre></div>
</div>
</div>
<div class="section" id="worker-disable-rate-limits">
<span id="std:setting-worker_disable_rate_limits"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_disable_rate_limits</span></code><a class="headerlink" href="#worker-disable-rate-limits" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled (rate limits enabled).</p>
<p>Disable all rate limits, even if tasks has explicit rate limits set.</p>
</div>
<div class="section" id="worker-state-db">
<span id="std:setting-worker_state_db"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_state_db</span></code><a class="headerlink" href="#worker-state-db" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Name of the file used to stores persistent worker state (like revoked tasks).
Can be a relative or absolute path, but be aware that the suffix <cite>.db</cite>
may be appended to the file name (depending on Python version).</p>
<p>Can also be set via the <a class="reference internal" href="../reference/celery.bin.worker.html#cmdoption-celery-worker-statedb"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">--statedb</span></code></a> argument.</p>
</div>
<div class="section" id="worker-timer-precision">
<span id="std:setting-worker_timer_precision"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_timer_precision</span></code><a class="headerlink" href="#worker-timer-precision" title="Permalink to this headline">¶</a></h4>
<p>Default: 1.0 seconds.</p>
<p>Set the maximum time in seconds that the ETA scheduler can sleep between
rechecking the schedule.</p>
<p>Setting this value to 1 second means the schedulers precision will
be 1 second. If you need near millisecond precision you can set this to 0.1.</p>
</div>
<div class="section" id="worker-enable-remote-control">
<span id="std:setting-worker_enable_remote_control"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_enable_remote_control</span></code><a class="headerlink" href="#worker-enable-remote-control" title="Permalink to this headline">¶</a></h4>
<p>Default: Enabled by default.</p>
<p>Specify if remote control of the workers is enabled.</p>
</div>
</div>
<div class="section" id="events">
<span id="conf-events"></span><h3><a class="toc-backref" href="#id31">Events</a><a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h3>
<div class="section" id="worker-send-task-events">
<span id="std:setting-worker_send_task_events"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_send_task_events</span></code><a class="headerlink" href="#worker-send-task-events" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled by default.</p>
<p>Send task-related events so that tasks can be monitored using tools like
<cite>flower</cite>. Sets the default value for the workers
<a class="reference internal" href="../reference/celery.bin.worker.html#cmdoption-celery-worker-e"><code class="xref std std-option docutils literal notranslate"><span class="pre">-E</span></code></a> argument.</p>
</div>
<div class="section" id="task-send-sent-event">
<span id="std:setting-task_send_sent_event"></span><h4><code class="docutils literal notranslate"><span class="pre">task_send_sent_event</span></code><a class="headerlink" href="#task-send-sent-event" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>Default: Disabled by default.</p>
<p>If enabled, a <a class="reference internal" href="monitoring.html#std:event-task-sent"><code class="xref std std-event docutils literal notranslate"><span class="pre">task-sent</span></code></a> event will be sent for every task so tasks can be
tracked before they’re consumed by a worker.</p>
</div>
<div class="section" id="event-queue-ttl">
<span id="std:setting-event_queue_ttl"></span><h4><code class="docutils literal notranslate"><span class="pre">event_queue_ttl</span></code><a class="headerlink" href="#event-queue-ttl" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">transports supported:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><code class="docutils literal notranslate"><span class="pre">amqp</span></code></td>
</tr>
</tbody>
</table>
<p>Default: 5.0 seconds.</p>
<p>Message expiry time in seconds (int/float) for when messages sent to a monitor clients
event queue is deleted (<code class="docutils literal notranslate"><span class="pre">x-message-ttl</span></code>)</p>
<p>For example, if this value is set to 10 then a message delivered to this queue
will be deleted after 10 seconds.</p>
</div>
<div class="section" id="event-queue-expires">
<span id="std:setting-event_queue_expires"></span><h4><code class="docutils literal notranslate"><span class="pre">event_queue_expires</span></code><a class="headerlink" href="#event-queue-expires" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">transports supported:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><code class="docutils literal notranslate"><span class="pre">amqp</span></code></td>
</tr>
</tbody>
</table>
<p>Default: 60.0 seconds.</p>
<p>Expiry time in seconds (int/float) for when after a monitor clients
event queue will be deleted (<code class="docutils literal notranslate"><span class="pre">x-expires</span></code>).</p>
</div>
<div class="section" id="event-queue-prefix">
<span id="std:setting-event_queue_prefix"></span><h4><code class="docutils literal notranslate"><span class="pre">event_queue_prefix</span></code><a class="headerlink" href="#event-queue-prefix" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celeryev&quot;</span></code>.</p>
<p>The prefix to use for event receiver queue names.</p>
</div>
<div class="section" id="event-serializer">
<span id="std:setting-event_serializer"></span><h4><code class="docutils literal notranslate"><span class="pre">event_serializer</span></code><a class="headerlink" href="#event-serializer" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;json&quot;</span></code>.</p>
<p>Message serialization format used when sending event messages.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="calling.html#calling-serializers"><span class="std std-ref">Serializers</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="remote-control-commands">
<span id="conf-control"></span><h3><a class="toc-backref" href="#id32">Remote Control Commands</a><a class="headerlink" href="#remote-control-commands" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To disable remote control commands see
the <a class="reference internal" href="#std:setting-worker_enable_remote_control"><code class="xref std std-setting docutils literal notranslate"><span class="pre">worker_enable_remote_control</span></code></a> setting.</p>
</div>
<div class="section" id="control-queue-ttl">
<span id="std:setting-control_queue_ttl"></span><h4><code class="docutils literal notranslate"><span class="pre">control_queue_ttl</span></code><a class="headerlink" href="#control-queue-ttl" title="Permalink to this headline">¶</a></h4>
<p>Default: 300.0</p>
<p>Time in seconds, before a message in a remote control command queue
will expire.</p>
<p>If using the default of 300 seconds, this means that if a remote control
command is sent and no worker picks it up within 300 seconds, the command
is discarded.</p>
<p>This setting also applies to remote control reply queues.</p>
</div>
<div class="section" id="control-queue-expires">
<span id="std:setting-control_queue_expires"></span><h4><code class="docutils literal notranslate"><span class="pre">control_queue_expires</span></code><a class="headerlink" href="#control-queue-expires" title="Permalink to this headline">¶</a></h4>
<p>Default: 10.0</p>
<p>Time in seconds, before an unused remote control command queue is deleted
from the broker.</p>
<p>This setting also applies to remote control reply queues.</p>
</div>
</div>
<div class="section" id="logging">
<span id="conf-logging"></span><h3><a class="toc-backref" href="#id33">Logging</a><a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<div class="section" id="worker-hijack-root-logger">
<span id="std:setting-worker_hijack_root_logger"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_hijack_root_logger</span></code><a class="headerlink" href="#worker-hijack-root-logger" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>Default: Enabled by default (hijack root logger).</p>
<p>By default any previously configured handlers on the root logger will be
removed. If you want to customize your own logging handlers, then you
can disable this behavior by setting
<cite>worker_hijack_root_logger = False</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Logging can also be customized by connecting to the
<code class="xref std std-signal docutils literal notranslate"><span class="pre">celery.signals.setup_logging</span></code> signal.</p>
</div>
</div>
<div class="section" id="worker-log-color">
<span id="std:setting-worker_log_color"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_log_color</span></code><a class="headerlink" href="#worker-log-color" title="Permalink to this headline">¶</a></h4>
<p>Default: Enabled if app is logging to a terminal.</p>
<p>Enables/disables colors in logging output by the Celery apps.</p>
</div>
<div class="section" id="worker-log-format">
<span id="std:setting-worker_log_format"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_log_format</span></code><a class="headerlink" href="#worker-log-format" title="Permalink to this headline">¶</a></h4>
<p>Default:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;[%(asctime)s: %(levelname)s/%(processName)s] %(message)s&quot;
</pre></div>
</div>
<p>The format to use for log messages.</p>
<p>See the Python <a class="reference external" href="https://docs.python.org/dev/library/logging.html#module-logging" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a> module for more information about log
formats.</p>
</div>
<div class="section" id="worker-task-log-format">
<span id="std:setting-worker_task_log_format"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_task_log_format</span></code><a class="headerlink" href="#worker-task-log-format" title="Permalink to this headline">¶</a></h4>
<p>Default:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;[%(asctime)s: %(levelname)s/%(processName)s]
    [%(task_name)s(%(task_id)s)] %(message)s&quot;
</pre></div>
</div>
<p>The format to use for log messages logged in tasks.</p>
<p>See the Python <a class="reference external" href="https://docs.python.org/dev/library/logging.html#module-logging" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a> module for more information about log
formats.</p>
</div>
<div class="section" id="worker-redirect-stdouts">
<span id="std:setting-worker_redirect_stdouts"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_redirect_stdouts</span></code><a class="headerlink" href="#worker-redirect-stdouts" title="Permalink to this headline">¶</a></h4>
<p>Default: Enabled by default.</p>
<p>If enabled <cite>stdout</cite> and <cite>stderr</cite> will be redirected
to the current logger.</p>
<p>Used by <strong class="program">celery worker</strong> and <strong class="program">celery beat</strong>.</p>
</div>
<div class="section" id="worker-redirect-stdouts-level">
<span id="std:setting-worker_redirect_stdouts_level"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_redirect_stdouts_level</span></code><a class="headerlink" href="#worker-redirect-stdouts-level" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">WARNING</span></code>.</p>
<p>The log level output to <cite>stdout</cite> and <cite>stderr</cite> is logged as.
Can be one of <code class="xref py py-const docutils literal notranslate"><span class="pre">DEBUG</span></code>, <code class="xref py py-const docutils literal notranslate"><span class="pre">INFO</span></code>, <code class="xref py py-const docutils literal notranslate"><span class="pre">WARNING</span></code>,
<code class="xref py py-const docutils literal notranslate"><span class="pre">ERROR</span></code>, or <code class="xref py py-const docutils literal notranslate"><span class="pre">CRITICAL</span></code>.</p>
</div>
</div>
<div class="section" id="security">
<span id="conf-security"></span><h3><a class="toc-backref" href="#id34">Security</a><a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h3>
<div class="section" id="security-key">
<span id="std:setting-security_key"></span><h4><code class="docutils literal notranslate"><span class="pre">security_key</span></code><a class="headerlink" href="#security-key" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>The relative or absolute path to a file containing the private key
used to sign messages when <a class="reference internal" href="security.html#message-signing"><span class="std std-ref">Message Signing</span></a> is used.</p>
</div>
<div class="section" id="security-certificate">
<span id="std:setting-security_certificate"></span><h4><code class="docutils literal notranslate"><span class="pre">security_certificate</span></code><a class="headerlink" href="#security-certificate" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>The relative or absolute path to an X.509 certificate file
used to sign messages when <a class="reference internal" href="security.html#message-signing"><span class="std std-ref">Message Signing</span></a> is used.</p>
</div>
<div class="section" id="security-cert-store">
<span id="std:setting-security_cert_store"></span><h4><code class="docutils literal notranslate"><span class="pre">security_cert_store</span></code><a class="headerlink" href="#security-cert-store" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.5.</span></p>
</div>
<p>The directory containing X.509 certificates used for
<a class="reference internal" href="security.html#message-signing"><span class="std std-ref">Message Signing</span></a>. Can be a glob with wild-cards,
(for example <code class="file docutils literal notranslate"><span class="pre">/etc/certs/*.pem</span></code>).</p>
</div>
</div>
<div class="section" id="custom-component-classes-advanced">
<span id="conf-custom-components"></span><h3><a class="toc-backref" href="#id35">Custom Component Classes (advanced)</a><a class="headerlink" href="#custom-component-classes-advanced" title="Permalink to this headline">¶</a></h3>
<div class="section" id="worker-pool">
<span id="std:setting-worker_pool"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_pool</span></code><a class="headerlink" href="#worker-pool" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;prefork&quot;</span></code> (<code class="docutils literal notranslate"><span class="pre">celery.concurrency.prefork:TaskPool</span></code>).</p>
<p>Name of the pool class used by the worker.</p>
<div class="admonition-eventlet-gevent admonition">
<p class="first admonition-title">Eventlet/Gevent</p>
<p class="last">Never use this option to select the eventlet or gevent pool.
You must use the <a class="reference internal" href="../reference/celery.bin.worker.html#cmdoption-celery-worker-p"><code class="xref std std-option docutils literal notranslate"><span class="pre">-P</span></code></a> option to
<strong class="program">celery worker</strong> instead, to ensure the monkey patches
aren’t applied too late, causing things to break in strange ways.</p>
</div>
</div>
<div class="section" id="worker-pool-restarts">
<span id="std:setting-worker_pool_restarts"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_pool_restarts</span></code><a class="headerlink" href="#worker-pool-restarts" title="Permalink to this headline">¶</a></h4>
<p>Default: Disabled by default.</p>
<p>If enabled the worker pool can be restarted using the
<code class="xref std std-control docutils literal notranslate"><span class="pre">pool_restart</span></code> remote control command.</p>
</div>
<div class="section" id="worker-autoscaler">
<span id="std:setting-worker_autoscaler"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_autoscaler</span></code><a class="headerlink" href="#worker-autoscaler" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celery.worker.autoscale:Autoscaler&quot;</span></code>.</p>
<p>Name of the autoscaler class to use.</p>
</div>
<div class="section" id="worker-consumer">
<span id="std:setting-worker_consumer"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_consumer</span></code><a class="headerlink" href="#worker-consumer" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celery.worker.consumer:Consumer&quot;</span></code>.</p>
<p>Name of the consumer class used by the worker.</p>
</div>
<div class="section" id="worker-timer">
<span id="std:setting-worker_timer"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_timer</span></code><a class="headerlink" href="#worker-timer" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;kombu.async.hub.timer:Timer&quot;</span></code>.</p>
<p>Name of the ETA scheduler class used by the worker.
Default is or set by the pool implementation.</p>
</div>
</div>
<div class="section" id="beat-settings-celery-beat">
<span id="conf-celerybeat"></span><h3><a class="toc-backref" href="#id36">Beat Settings (<strong class="program">celery beat</strong>)</a><a class="headerlink" href="#beat-settings-celery-beat" title="Permalink to this headline">¶</a></h3>
<div class="section" id="beat-schedule">
<span id="std:setting-beat_schedule"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_schedule</span></code><a class="headerlink" href="#beat-schedule" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">{}</span></code> (empty mapping).</p>
<p>The periodic task schedule used by <a class="reference internal" href="../reference/celery.bin.beat.html#module-celery.bin.beat" title="celery.bin.beat"><code class="xref py py-mod docutils literal notranslate"><span class="pre">beat</span></code></a>.
See <a class="reference internal" href="periodic-tasks.html#beat-entries"><span class="std std-ref">Entries</span></a>.</p>
</div>
<div class="section" id="beat-scheduler">
<span id="std:setting-beat_scheduler"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_scheduler</span></code><a class="headerlink" href="#beat-scheduler" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celery.beat:PersistentScheduler&quot;</span></code>.</p>
<p>The default scheduler class. May be set to
<code class="docutils literal notranslate"><span class="pre">&quot;django_celery_beat.schedulers:DatabaseScheduler&quot;</span></code> for instance,
if used alongside <cite>django-celery-beat</cite> extension.</p>
<p>Can also be set via the <a class="reference internal" href="../reference/celery.bin.beat.html#cmdoption-celery-beat-scheduler"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">beat</span> <span class="pre">-S</span></code></a> argument.</p>
</div>
<div class="section" id="beat-schedule-filename">
<span id="std:setting-beat_schedule_filename"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_schedule_filename</span></code><a class="headerlink" href="#beat-schedule-filename" title="Permalink to this headline">¶</a></h4>
<p>Default: <code class="docutils literal notranslate"><span class="pre">&quot;celerybeat-schedule&quot;</span></code>.</p>
<p>Name of the file used by <cite>PersistentScheduler</cite> to store the last run times
of periodic tasks. Can be a relative or absolute path, but be aware that the
suffix <cite>.db</cite> may be appended to the file name (depending on Python version).</p>
<p>Can also be set via the <a class="reference internal" href="../reference/celery.bin.beat.html#cmdoption-celery-beat-s"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">beat</span> <span class="pre">--schedule</span></code></a> argument.</p>
</div>
<div class="section" id="beat-sync-every">
<span id="std:setting-beat_sync_every"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_sync_every</span></code><a class="headerlink" href="#beat-sync-every" title="Permalink to this headline">¶</a></h4>
<p>Default: 0.</p>
<p>The number of periodic tasks that can be called before another database sync
is issued.
A value of 0 (default) means sync based on timing - default of 3 minutes as determined by
scheduler.sync_every. If set to 1, beat will call sync after every task
message sent.</p>
</div>
<div class="section" id="beat-max-loop-interval">
<span id="std:setting-beat_max_loop_interval"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_max_loop_interval</span></code><a class="headerlink" href="#beat-max-loop-interval" title="Permalink to this headline">¶</a></h4>
<p>Default: 0.</p>
<p>The maximum number of seconds <a class="reference internal" href="../reference/celery.bin.beat.html#module-celery.bin.beat" title="celery.bin.beat"><code class="xref py py-mod docutils literal notranslate"><span class="pre">beat</span></code></a> can sleep
between checking the schedule.</p>
<p>The default for this value is scheduler specific.
For the default Celery beat scheduler the value is 300 (5 minutes),
but for the <a class="reference external" href="https://pypi.python.org/pypi/django-celery-beat/">django-celery-beat</a> database scheduler it’s 5 seconds
because the schedule may be changed externally, and so it must take
changes to the schedule into account.</p>
<p>Also when running Celery beat embedded (<a class="reference internal" href="../reference/celery.bin.worker.html#cmdoption-celery-worker-b"><code class="xref std std-option docutils literal notranslate"><span class="pre">-B</span></code></a>)
on Jython as a thread the max interval is overridden and set to 1 so
that it’s possible to shut down in a timely manner.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/celery_512.png" alt="Logo"/>
            </a></p><iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
<div id="donate">
    <b>Please help support this community project with a donation:</b>
    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
    <input type="hidden" name="cmd" value="_s-xclick">
    <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHTwYJKoZIhvcNAQcEoIIHQDCCBzwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYA2+c723xlntHKQYQR9yn9BEtUhDoUUlnOqhniqvNMWB4k2R0JpVkrNSu5JCbdjNOqDXKHoRfIWe3HXJJMPZBJKFMD5Izprb6xEZlTGaWnlrGXFfkdBaILQQgWYqV0DnuNmtDXCvfYmyu0p1K04wLjAJ1ufnBSP1UaS6BTcoIOOuTELMAkGBSsOAwIaBQAwgcwGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIFg/2qPwa7UCAgah20QLIllcp0VHazYo2C9h8c6gn8MTcTnpW0WFXhz9ylc/i5dCXabkrrLBBfg8NygAuvYRr4k1zdC0AJIgsV/6rSAhehabRvjRDH2EZ8OieqHfIPfkAcTm+JqbS6Z27lXkebYPnJzhkZxW7+ZC6hU/H40JFXChTag8lhqJfZELiOZLWxxilj2mkwlkdMx1YL6lcPAA7ajpAwjsnJYd/9VxLA6MDmcOu+TKgggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xNTEyMTAxOTEzMzBaMCMGCSqGSIb3DQEJBDEWBBTUno4gI/mmaVaGVpgB/CWwQd3DeDANBgkqhkiG9w0BAQEFAASBgFmZ1j1Ss/FNl/JRIOakhBJEdm2KGLH0d2ewwTYIgIkEKSdc5Rg2/2xFS/dglcs5Te3R2GzaqjGlNSKldsk/MgZP/BudpHAASQ09hrfDy5TaBlRRl1Yu0WzGBKcVm/WRh0v2TVV8vBHVGiJD+aY5epgRXXI/XUKD0bp8tVV1T7LS-----END PKCS7-----
    ">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="extending.html"
                        title="previous chapter">Extensions and Bootsteps</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="sphinx.html"
                        title="next chapter">Documenting Tasks with Sphinx</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/userguide/configuration.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sphinx.html" title="Documenting Tasks with Sphinx"
             >next</a> |</li>
        <li class="right" >
          <a href="extending.html" title="Extensions and Bootsteps"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Celery 4.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >User Guide</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2009-2017, Ask Solem &amp; contributors.
    </div>
  </body>
</html>