
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Change history for Celery 1.0 &#8212; Celery 4.2.0 documentation</title>
    <link rel="stylesheet" href="../_static/celery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Glossary" href="../glossary.html" />
    <link rel="prev" title="Change history for Celery 2.0" href="changelog-2.0.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../glossary.html" title="Glossary"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="changelog-2.0.html" title="Change history for Celery 2.0"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Celery 4.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">History</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
<div class="deck">

    
        <p>
        This document describes the current stable version of Celery (4.2).
        For development docs,
        <a href="http://docs.celeryproject.org/en/master/history/changelog-1.0.html">go here</a>.
        </p>
    

</div>
    <div class="section" id="change-history-for-celery-1-0">
<span id="changelog-1-0"></span><h1>Change history for Celery 1.0<a class="headerlink" href="#change-history-for-celery-1-0" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#version-1-0-6" id="id41">1.0.6</a></li>
<li><a class="reference internal" href="#version-1-0-5" id="id42">1.0.5</a><ul>
<li><a class="reference internal" href="#critical" id="id43">Critical</a></li>
<li><a class="reference internal" href="#changes" id="id44">Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-1-0-4" id="id45">1.0.4</a></li>
<li><a class="reference internal" href="#version-1-0-3" id="id46">1.0.3</a><ul>
<li><a class="reference internal" href="#important-notes" id="id47">Important notes</a></li>
<li><a class="reference internal" href="#news" id="id48">News</a></li>
<li><a class="reference internal" href="#remote-control-commands" id="id49">Remote control commands</a></li>
<li><a class="reference internal" href="#fixes" id="id50">Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-1-0-2" id="id51">1.0.2</a></li>
<li><a class="reference internal" href="#version-1-0-1" id="id52">1.0.1</a></li>
<li><a class="reference internal" href="#version-1-0-0" id="id53">1.0.0</a><ul>
<li><a class="reference internal" href="#backward-incompatible-changes" id="id54">Backward incompatible changes</a></li>
<li><a class="reference internal" href="#deprecations" id="id55">Deprecations</a></li>
<li><a class="reference internal" href="#id8" id="id56">News</a></li>
<li><a class="reference internal" href="#v100-changes" id="id57">Changes</a></li>
<li><a class="reference internal" href="#bugs" id="id58">Bugs</a></li>
<li><a class="reference internal" href="#documentation" id="id59">Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-0-8-4" id="id60">0.8.4</a></li>
<li><a class="reference internal" href="#version-0-8-3" id="id61">0.8.3</a></li>
<li><a class="reference internal" href="#version-0-8-2" id="id62">0.8.2</a></li>
<li><a class="reference internal" href="#version-0-8-1" id="id63">0.8.1</a><ul>
<li><a class="reference internal" href="#very-important-note" id="id64">Very important note</a></li>
<li><a class="reference internal" href="#important-changes" id="id65">Important changes</a></li>
<li><a class="reference internal" href="#v081-changes" id="id66">Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-0-8-0" id="id67">0.8.0</a><ul>
<li><a class="reference internal" href="#v080-incompatible" id="id68">Backward incompatible changes</a></li>
<li><a class="reference internal" href="#v080-important" id="id69">Important changes</a></li>
<li><a class="reference internal" href="#v080-news" id="id70">News</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-0-6-0" id="id71">0.6.0</a><ul>
<li><a class="reference internal" href="#v060-important" id="id72">Important changes</a></li>
<li><a class="reference internal" href="#v060-news" id="id73">News</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-0-4-1" id="id74">0.4.1</a></li>
<li><a class="reference internal" href="#version-0-4-0" id="id75">0.4.0</a></li>
<li><a class="reference internal" href="#version-0-3-20" id="id76">0.3.20</a></li>
<li><a class="reference internal" href="#version-0-3-7" id="id77">0.3.7</a></li>
<li><a class="reference internal" href="#version-0-3-3" id="id78">0.3.3</a></li>
<li><a class="reference internal" href="#version-0-3-2" id="id79">0.3.2</a></li>
<li><a class="reference internal" href="#version-0-3-1" id="id80">0.3.1</a></li>
<li><a class="reference internal" href="#version-0-3-0" id="id81">0.3.0</a></li>
<li><a class="reference internal" href="#version-0-2-0" id="id82">0.2.0</a></li>
<li><a class="reference internal" href="#pre3" id="id83">0.2.0-pre3</a></li>
<li><a class="reference internal" href="#pre2" id="id84">0.2.0-pre2</a></li>
<li><a class="reference internal" href="#pre1" id="id85">0.2.0-pre1</a></li>
<li><a class="reference internal" href="#version-0-1-15" id="id86">0.1.15</a></li>
<li><a class="reference internal" href="#version-0-1-14" id="id87">0.1.14</a></li>
<li><a class="reference internal" href="#version-0-1-13" id="id88">0.1.13</a></li>
<li><a class="reference internal" href="#version-0-1-12" id="id89">0.1.12</a></li>
<li><a class="reference internal" href="#version-0-1-11" id="id90">0.1.11</a></li>
<li><a class="reference internal" href="#version-0-1-10" id="id91">0.1.10</a></li>
<li><a class="reference internal" href="#version-0-1-8" id="id92">0.1.8</a></li>
<li><a class="reference internal" href="#version-0-1-7" id="id93">0.1.7</a></li>
<li><a class="reference internal" href="#version-0-1-6" id="id94">0.1.6</a></li>
<li><a class="reference internal" href="#version-0-1-0" id="id95">0.1.0</a></li>
</ul>
</div>
<div class="section" id="version-1-0-6">
<span id="id1"></span><h2><a class="toc-backref" href="#id41">1.0.6</a><a class="headerlink" href="#version-1-0-6" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-06-30 09:57 a.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">RabbitMQ 1.8.0 has extended their exchange equivalence tests to
include <cite>auto_delete</cite> and <cite>durable</cite>. This broke the AMQP backend.</p>
<p>If you’ve already used the AMQP backend this means you have to
delete the previous definitions:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> camqadm exchange.delete celeryresults
</pre></div>
</div>
<p>or:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> python manage.py camqadm exchange.delete celeryresults
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="version-1-0-5">
<span id="id2"></span><h2><a class="toc-backref" href="#id42">1.0.5</a><a class="headerlink" href="#version-1-0-5" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-06-01 02:36 p.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="critical">
<span id="v105-critical"></span><h3><a class="toc-backref" href="#id43">Critical</a><a class="headerlink" href="#critical" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><code class="xref std std-sig docutils literal notranslate"><span class="pre">INT</span></code>/<kbd class="kbd docutils literal notranslate">Control-c</kbd> killed the pool, abruptly terminating the
currently executing tasks.</p>
<blockquote>
<div><p>Fixed by making the pool worker processes ignore <code class="xref py py-const docutils literal notranslate"><span class="pre">SIGINT</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first">Shouldn’t close the consumers before the pool is terminated, just cancel
the consumers.</p>
<blockquote>
<div><p>See <span class="xref issue">issue #122</span>.</p>
</div></blockquote>
</li>
<li><p class="first">Now depends on <a class="reference external" href="https://pypi.python.org/pypi/billiard/">billiard</a> &gt;= 0.3.1</p>
</li>
<li><p class="first">worker: Previously exceptions raised by worker components could stall
start-up, now it correctly logs the exceptions and shuts down.</p>
</li>
<li><p class="first">worker: Prefetch counts was set too late. QoS is now set as early as possible,
so the worker: can’t slurp in all the messages at start-up.</p>
</li>
</ul>
</div>
<div class="section" id="changes">
<span id="v105-changes"></span><h3><a class="toc-backref" href="#id44">Changes</a><a class="headerlink" href="#changes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><a class="reference internal" href="../reference/celery.contrib.abortable.html#module-celery.contrib.abortable" title="celery.contrib.abortable"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.contrib.abortable</span></code></a>: Abortable tasks.</p>
<blockquote>
<div><p>Tasks that defines steps of execution, the task can then
be aborted after each step has completed.</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="../reference/celery.events.html#celery.events.EventDispatcher" title="celery.events.EventDispatcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventDispatcher</span></code></a>: No longer creates AMQP channel
if events are disabled</p>
</li>
<li><p class="first">Added required RPM package names under <cite>[bdist_rpm]</cite> section, to support building RPMs
from the sources using <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code>.</p>
</li>
<li><p class="first">Running unit tests: <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NOSE_VERBOSE</span></code> environment var now enables verbose output from Nose.</p>
</li>
<li><p class="first"><code class="xref py py-func docutils literal notranslate"><span class="pre">celery.execute.apply()</span></code>: Pass log file/log level arguments as task kwargs.</p>
<blockquote>
<div><p>See <span class="xref issue">issue #110</span>.</p>
</div></blockquote>
</li>
<li><p class="first">celery.execute.apply: Should return exception, not
<code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionInfo</span></code> on error.</p>
<blockquote>
<div><p>See <span class="xref issue">issue #111</span>.</p>
</div></blockquote>
</li>
<li><p class="first">Added new entries to the <a class="reference internal" href="../faq.html#faq"><span class="std std-ref">FAQs</span></a>:</p>
<blockquote>
<div><ul class="simple">
<li>Should I use retry or acks_late?</li>
<li>Can I call a task by name?</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="version-1-0-4">
<span id="id3"></span><h2><a class="toc-backref" href="#id45">1.0.4</a><a class="headerlink" href="#version-1-0-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-05-31 09:54 a.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Changelog merged with 1.0.5 as the release was never announced.</li>
</ul>
</div>
<div class="section" id="version-1-0-3">
<span id="id4"></span><h2><a class="toc-backref" href="#id46">1.0.3</a><a class="headerlink" href="#version-1-0-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-05-15 03:00 p.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="important-notes">
<span id="v103-important"></span><h3><a class="toc-backref" href="#id47">Important notes</a><a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Messages are now acknowledged <em>just before</em> the task function is executed.</p>
<blockquote>
<div><p>This is the behavior we’ve wanted all along, but couldn’t have because of
limitations in the multiprocessing module.
The previous behavior wasn’t good, and the situation worsened with the
release of 1.0.1, so this change will definitely improve
reliability, performance and operations in general.</p>
<p>For more information please see <a class="reference external" href="http://bit.ly/9hom6T">http://bit.ly/9hom6T</a></p>
</div></blockquote>
</li>
<li><p class="first">Database result backend: result now explicitly sets <cite>null=True</cite> as
<cite>django-picklefield</cite> version 0.1.5 changed the default behavior
right under our noses :(</p>
<blockquote>
<div><p>See: <a class="reference external" href="http://bit.ly/d5OwMr">http://bit.ly/d5OwMr</a></p>
<p>This means those who created their Celery tables (via <code class="docutils literal notranslate"><span class="pre">syncdb</span></code> or
<code class="docutils literal notranslate"><span class="pre">celeryinit</span></code>) with <a class="reference external" href="https://pypi.python.org/pypi/django-picklefield`/">django-picklefield`</a>
versions &gt;= 0.1.5 has to alter their tables to
allow the result field to be <cite>NULL</cite> manually.</p>
<p>MySQL:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">celery_taskmeta</span> <span class="k">MODIFY</span> <span class="k">result</span> <span class="nb">TEXT</span> <span class="k">NULL</span>
</pre></div>
</div>
<p>PostgreSQL:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">celery_taskmeta</span> <span class="k">ALTER</span> <span class="k">COLUMN</span> <span class="k">result</span> <span class="k">DROP</span> <span class="k">NOT</span> <span class="k">NULL</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Removed <cite>Task.rate_limit_queue_type</cite>, as it wasn’t really useful
and made it harder to refactor some parts.</p>
</li>
<li><p class="first">Now depends on carrot &gt;= 0.10.4</p>
</li>
<li><p class="first">Now depends on billiard &gt;= 0.3.0</p>
</li>
</ul>
</div>
<div class="section" id="news">
<span id="v103-news"></span><h3><a class="toc-backref" href="#id48">News</a><a class="headerlink" href="#news" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">AMQP backend: Added timeout support for <cite>result.get()</cite> /
<cite>result.wait()</cite>.</p>
</li>
<li><p class="first">New task option: <cite>Task.acks_late</cite> (default: <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ACKS_LATE</span></code>)</p>
<blockquote>
<div><p>Late ack means the task messages will be acknowledged <strong>after</strong> the task
has been executed, not <em>just before</em>, which is the default behavior.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This means the tasks may be executed twice if the worker
crashes in mid-execution. Not acceptable for most
applications, but desirable for others.</p>
</div>
</div></blockquote>
</li>
<li><p class="first">Added Crontab-like scheduling to periodic tasks.</p>
<blockquote>
<div><p>Like a cronjob, you can specify units of time of when
you’d like the task to execute. While not a full implementation
of <strong class="command">cron</strong>’s features, it should provide a fair degree of common scheduling
needs.</p>
<p>You can specify a minute (0-59), an hour (0-23), and/or a day of the
week (0-6 where 0 is Sunday, or by names:
<code class="docutils literal notranslate"><span class="pre">sun,</span> <span class="pre">mon,</span> <span class="pre">tue,</span> <span class="pre">wed,</span> <span class="pre">thu,</span> <span class="pre">fri,</span> <span class="pre">sat</span></code>).</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">celery.schedules</span> <span class="kn">import</span> <span class="n">crontab</span>
<span class="kn">from</span> <span class="nn">celery.decorators</span> <span class="kn">import</span> <span class="n">periodic_task</span>

<span class="nd">@periodic_task</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="n">crontab</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">every_morning</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Runs every morning at 7:30a.m&#39;</span><span class="p">)</span>

<span class="nd">@periodic_task</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="n">crontab</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">day_of_week</span><span class="o">=</span><span class="s1">&#39;mon&#39;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">every_monday_morning</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Run every monday morning at 7:30a.m&#39;</span><span class="p">)</span>

<span class="nd">@periodic_task</span><span class="p">(</span><span class="n">run_every</span><span class="o">=</span><span class="n">crontab</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">every_hour</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Runs every hour on the clock (e.g., 1:30, 2:30, 3:30 etc.).&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This a late addition. While we have unit tests, due to the
nature of this feature we haven’t been able to completely test this
in practice, so consider this experimental.</p>
</div>
</div></blockquote>
</li>
<li><p class="first"><cite>TaskPool.apply_async</cite>: Now supports the <cite>accept_callback</cite> argument.</p>
</li>
<li><p class="first"><cite>apply_async</cite>: Now raises <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#ValueError" title="(in Python v3.8)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> if task args isn’t a list,
or kwargs isn’t a tuple (<span class="xref issue">Issue #95</span>).</p>
</li>
<li><p class="first"><cite>Task.max_retries</cite> can now be <cite>None</cite>, which means it will retry forever.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>: Now reuses the same connection when publishing large
sets of tasks.</p>
</li>
<li><p class="first">Modified the task locking example in the documentation to use
<cite>cache.add</cite> for atomic locking.</p>
</li>
<li><p class="first">Added experimental support for a <em>started</em> status on tasks.</p>
<blockquote>
<div><p>If <cite>Task.track_started</cite> is enabled the task will report its status
as “started” when the task is executed by a worker.</p>
<p>The default value is <cite>False</cite> as the normal behavior is to not
report that level of granularity. Tasks are either pending, finished,
or waiting to be retried. Having a “started” status can be useful for
when there are long running tasks and there’s a need to report which
task is currently running.</p>
<p>The global default can be overridden by the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TRACK_STARTED</span></code>
setting.</p>
</div></blockquote>
</li>
<li><p class="first">User Guide: New section <cite>Tips and Best Practices</cite>.</p>
<blockquote>
<div><p>Contributions welcome!</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="remote-control-commands">
<span id="v103-remote-control"></span><h3><a class="toc-backref" href="#id49">Remote control commands</a><a class="headerlink" href="#remote-control-commands" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Remote control commands can now send replies back to the caller.</p>
<blockquote>
<div><p>Existing commands has been improved to send replies, and the client
interface in <cite>celery.task.control</cite> has new keyword arguments: <cite>reply</cite>,
<cite>timeout</cite> and <cite>limit</cite>. Where reply means it will wait for replies,
timeout is the time in seconds to stop waiting for replies, and limit
is the maximum number of replies to get.</p>
<p>By default, it will wait for as many replies as possible for one second.</p>
<ul>
<li><p class="first">rate_limit(task_name, destination=all, reply=False, timeout=1, limit=0)</p>
<blockquote>
<div><p>Worker returns <cite>{‘ok’: message}</cite> on success,
or <cite>{‘failure’: message}</cite> on failure.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="k">import</span> <span class="n">rate_limit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rate_limit</span><span class="p">(</span><span class="s1">&#39;tasks.add&#39;</span><span class="p">,</span> <span class="s1">&#39;10/s&#39;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;worker1&#39;: {&#39;ok&#39;: &#39;new rate limit set successfully&#39;}},</span>
<span class="go"> {&#39;worker2&#39;: {&#39;ok&#39;: &#39;new rate limit set successfully&#39;}}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">ping(destination=all, reply=False, timeout=1, limit=0)</p>
<blockquote>
<div><p>Worker returns the simple message <cite>“pong”</cite>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="k">import</span> <span class="n">ping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ping</span><span class="p">(</span><span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;worker1&#39;: &#39;pong&#39;},</span>
<span class="go"> {&#39;worker2&#39;: &#39;pong&#39;},</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">revoke(destination=all, reply=False, timeout=1, limit=0)</p>
<blockquote>
<div><p>Worker simply returns <cite>True</cite>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="k">import</span> <span class="n">revoke</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">revoke</span><span class="p">(</span><span class="s1">&#39;419e46eb-cf6a-4271-86a8-442b7124132c&#39;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;worker1&#39;: True},</span>
<span class="go"> {&#39;worker2&#39;; True}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">You can now add your own remote control commands!</p>
<blockquote>
<div><p>Remote control commands are functions registered in the command
registry. Registering a command is done using
<a class="reference internal" href="../internals/reference/celery.worker.control.html#celery.worker.control.Panel.register" title="celery.worker.control.Panel.register"><code class="xref py py-meth docutils literal notranslate"><span class="pre">celery.worker.control.Panel.register()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="kn">import</span> <span class="n">Panel</span>

<span class="nd">@Panel.register</span>
<span class="k">def</span> <span class="nf">reset_broker_connection</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">state</span><span class="o">.</span><span class="n">consumer</span><span class="o">.</span><span class="n">reset_connection</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;ok&#39;</span><span class="p">:</span> <span class="s1">&#39;connection re-established&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>With this module imported in the worker, you can launch the command
using <cite>celery.task.control.broadcast</cite>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="k">import</span> <span class="n">broadcast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s1">&#39;reset_broker_connection&#39;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;worker1&#39;: {&#39;ok&#39;: &#39;connection re-established&#39;},</span>
<span class="go"> {&#39;worker2&#39;: {&#39;ok&#39;: &#39;connection re-established&#39;}}]</span>
</pre></div>
</div>
<p><strong>TIP</strong> You can choose the worker(s) to receive the command
by using the <cite>destination</cite> argument:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s1">&#39;reset_broker_connection&#39;</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;worker1&#39;</span><span class="p">])</span>
<span class="go">[{&#39;worker1&#39;: {&#39;ok&#39;: &#39;connection re-established&#39;}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">New remote control command: <cite>dump_reserved</cite></p>
<blockquote>
<div><p>Dumps tasks reserved by the worker, waiting to be executed:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="k">import</span> <span class="n">broadcast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s1">&#39;dump_reserved&#39;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;myworker1&#39;: [&lt;TaskRequest ....&gt;]}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">New remote control command: <cite>dump_schedule</cite></p>
<blockquote>
<div><p>Dumps the workers currently registered ETA schedule.
These are tasks with an <cite>eta</cite> (or <cite>countdown</cite>) argument
waiting to be executed by the worker.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="k">import</span> <span class="n">broadcast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">broadcast</span><span class="p">(</span><span class="s1">&#39;dump_schedule&#39;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{&#39;w1&#39;: []},</span>
<span class="go"> {&#39;w3&#39;: []},</span>
<span class="go"> {&#39;w2&#39;: [&#39;0. 2010-05-12 11:06:00 pri0 &lt;TaskRequest</span>
<span class="go">            {name:&#39;opalfeeds.tasks.refresh_feed_slice&#39;,</span>
<span class="go">             id:&#39;95b45760-4e73-4ce8-8eac-f100aa80273a&#39;,</span>
<span class="go">             args:&#39;(&lt;Feeds freq_max:3600 freq_min:60</span>
<span class="go">                           start:2184.0 stop:3276.0&gt;,)&#39;,</span>
<span class="go">             kwargs:&#39;{&#39;page&#39;: 2}&#39;}&gt;&#39;]},</span>
<span class="go"> {&#39;w4&#39;: [&#39;0. 2010-05-12 11:00:00 pri0 &lt;TaskRequest</span>
<span class="go">            {name:&#39;opalfeeds.tasks.refresh_feed_slice&#39;,</span>
<span class="go">             id:&#39;c053480b-58fb-422f-ae68-8d30a464edfe&#39;,</span>
<span class="go">             args:&#39;(&lt;Feeds freq_max:3600 freq_min:60</span>
<span class="go">                           start:1092.0 stop:2184.0&gt;,)&#39;,</span>
<span class="go">             kwargs:&#39;{\&#39;page\&#39;: 1}&#39;}&gt;&#39;,</span>
<span class="go">        &#39;1. 2010-05-12 11:12:00 pri0 &lt;TaskRequest</span>
<span class="go">            {name:&#39;opalfeeds.tasks.refresh_feed_slice&#39;,</span>
<span class="go">             id:&#39;ab8bc59e-6cf8-44b8-88d0-f1af57789758&#39;,</span>
<span class="go">             args:&#39;(&lt;Feeds freq_max:3600 freq_min:60</span>
<span class="go">                           start:3276.0 stop:4365&gt;,)&#39;,</span>
<span class="go">             kwargs:&#39;{\&#39;page\&#39;: 3}&#39;}&gt;&#39;]}]</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="fixes">
<span id="v103-fixes"></span><h3><a class="toc-backref" href="#id50">Fixes</a><a class="headerlink" href="#fixes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Mediator thread no longer blocks for more than 1 second.</p>
<blockquote>
<div><p>With rate limits enabled and when there was a lot of remaining time,
the mediator thread could block shutdown (and potentially block other
jobs from coming in).</p>
</div></blockquote>
</li>
<li><p class="first">Remote rate limits wasn’t properly applied (<span class="xref issue">Issue #98</span>).</p>
</li>
<li><p class="first">Now handles exceptions with Unicode messages correctly in
<cite>TaskRequest.on_failure</cite>.</p>
</li>
<li><p class="first">Database backend: <cite>TaskMeta.result</cite>: default value should be <cite>None</cite>
not empty string.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="version-1-0-2">
<span id="id5"></span><h2><a class="toc-backref" href="#id51">1.0.2</a><a class="headerlink" href="#version-1-0-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-03-31 12:50 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Deprecated: <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_BACKEND</span></code>, please use
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_RESULT_BACKEND</span></code> instead.</p>
</li>
<li><p class="first">We now use a custom logger in tasks. This logger supports task magic
keyword arguments in formats.</p>
<blockquote>
<div><p>The default format for tasks (<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_TASK_LOG_FORMAT</span></code>) now
includes the id and the name of tasks so the origin of task log messages
can easily be traced.</p>
<dl class="docutils">
<dt>Example output::</dt>
<dd><dl class="first last docutils">
<dt>[2010-03-25 13:11:20,317: INFO/PoolWorker-1]</dt>
<dd><p class="first last">[tasks.add(a6e1c5ad-60d9-42a0-8b24-9e39363125a4)] Hello from add</p>
</dd>
</dl>
</dd>
</dl>
<p>To revert to the previous behavior you can set:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">CELERYD_TASK_LOG_FORMAT</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    [</span><span class="si">%(asctime)s</span><span class="s2">: </span><span class="si">%(levelname)s</span><span class="s2">/</span><span class="si">%(processName)s</span><span class="s2">] </span><span class="si">%(message)s</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Unit tests: Don’t disable the django test database tear down,
instead fixed the underlying issue which was caused by modifications
to the <cite>DATABASE_NAME</cite> setting (<span class="xref issue">Issue #82</span>).</p>
</li>
<li><p class="first">Django Loader: New config <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_DB_REUSE_MAX</span></code> (max number of
tasks to reuse the same database connection)</p>
<blockquote>
<div><p>The default is to use a new connection for every task.
We’d very much like to reuse the connection, but a safe number of
reuses isn’t known, and we don’t have any way to handle the errors
that might happen, which may even be database dependent.</p>
<p>See: <a class="reference external" href="http://bit.ly/94fwdd">http://bit.ly/94fwdd</a></p>
</div></blockquote>
</li>
<li><p class="first">worker: The worker components are now configurable: <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_POOL</span></code>,
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_CONSUMER</span></code>, <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_MEDIATOR</span></code>, and
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_ETA_SCHEDULER</span></code>.</p>
<blockquote>
<div><p>The default configuration is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CELERYD_POOL</span> <span class="o">=</span> <span class="s1">&#39;celery.concurrency.processes.TaskPool&#39;</span>
<span class="n">CELERYD_MEDIATOR</span> <span class="o">=</span> <span class="s1">&#39;celery.worker.controllers.Mediator&#39;</span>
<span class="n">CELERYD_ETA_SCHEDULER</span> <span class="o">=</span> <span class="s1">&#39;celery.worker.controllers.ScheduleController&#39;</span>
<span class="n">CELERYD_CONSUMER</span> <span class="o">=</span> <span class="s1">&#39;celery.worker.consumer.Consumer&#39;</span>
</pre></div>
</div>
<p>The <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_POOL</span></code> setting makes it easy to swap out the
multiprocessing pool with a threaded pool, or how about a
twisted/eventlet pool?</p>
<p>Consider the competition for the first pool plug-in started!</p>
</div></blockquote>
</li>
<li><p class="first">Debian init-scripts: Use <cite>-a</cite> not <cite>&amp;&amp;</cite> (<span class="xref issue">Issue #82</span>).</p>
</li>
<li><p class="first">Debian init-scripts: Now always preserves <cite>$CELERYD_OPTS</cite> from the
<cite>/etc/default/celeryd</cite> and <cite>/etc/default/celerybeat</cite>.</p>
</li>
<li><p class="first">celery.beat.Scheduler: Fixed a bug where the schedule wasn’t properly
flushed to disk if the schedule hadn’t been properly initialized.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>: Now syncs the schedule to disk when receiving the <code class="xref std std-sig docutils literal notranslate"><span class="pre">SIGTERM</span></code>
and <code class="xref std std-sig docutils literal notranslate"><span class="pre">SIGINT</span></code> signals.</p>
</li>
<li><p class="first">Control commands: Make sure keywords arguments aren’t in Unicode.</p>
</li>
<li><p class="first">ETA scheduler: Was missing a logger object, so the scheduler crashed
when trying to log that a task had been revoked.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">management.commands.camqadm</span></code>: Fixed typo <cite>camqpadm</cite> -&gt; <cite>camqadm</cite>
(<span class="xref issue">Issue #83</span>).</p>
</li>
<li><p class="first">PeriodicTask.delta_resolution: wasn’t working for days and hours, now fixed
by rounding to the nearest day/hour.</p>
</li>
<li><p class="first">Fixed a potential infinite loop in <cite>BaseAsyncResult.__eq__</cite>, although
there’s no evidence that it has ever been triggered.</p>
</li>
<li><p class="first">worker: Now handles messages with encoding problems by acking them and
emitting an error message.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-0-1">
<span id="id6"></span><h2><a class="toc-backref" href="#id52">1.0.1</a><a class="headerlink" href="#version-1-0-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-02-24 07:05 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Tasks are now acknowledged early instead of late.</p>
<blockquote>
<div><p>This is done because messages can only be acknowledged within the same
connection channel, so if the connection is lost we’d’ve to
re-fetch the message again to acknowledge it.</p>
<p>This might or might not affect you, but mostly those running tasks with a
really long execution time are affected, as all tasks that’s made it
all the way into the pool needs to be executed before the worker can
safely terminate (this is at most the number of pool workers, multiplied
by the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_PREFETCH_MULTIPLIER</span></code> setting).</p>
<p>We multiply the prefetch count by default to increase the performance at
times with bursts of tasks with a short execution time. If this doesn’t
apply to your use case, you should be able to set the prefetch multiplier
to zero, without sacrificing performance.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A patch to <a class="reference external" href="https://docs.python.org/dev/library/multiprocessing.html#module-multiprocessing" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> is currently being
worked on, this patch would enable us to use a better solution, and is
scheduled for inclusion in the <cite>2.0.0</cite> release.</p>
</div>
</div></blockquote>
</li>
<li><p class="first">The worker now shutdowns cleanly when receiving the <code class="xref std std-sig docutils literal notranslate"><span class="pre">SIGTERM</span></code> signal.</p>
</li>
<li><p class="first">The worker now does a cold shutdown if the <code class="xref std std-sig docutils literal notranslate"><span class="pre">SIGINT</span></code> signal
is received (<kbd class="kbd docutils literal notranslate">Control-c</kbd>),
this means it tries to terminate as soon as possible.</p>
</li>
<li><p class="first">Caching of results now moved to the base backend classes, so no need
to implement this functionality in the base classes.</p>
</li>
<li><p class="first">Caches are now also limited in size, so their memory usage doesn’t grow
out of control.</p>
<blockquote>
<div><p>You can set the maximum number of results the cache
can hold using the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_MAX_CACHED_RESULTS</span></code> setting (the
default is five thousand results). In addition, you can re-fetch already
retrieved results using <cite>backend.reload_task_result</cite> +
<cite>backend.reload_taskset_result</cite> (that’s for those who want to send
results incrementally).</p>
</div></blockquote>
</li>
<li><p class="first">The worker now works on Windows again.</p>
<blockquote>
<div><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If you’re using Celery with Django, you can’t use <cite>project.settings</cite>
as the settings module name, but the following should work:</p>
<div class="last highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> python manage.py celeryd --settings<span class="o">=</span>settings
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p class="first">Execution: <cite>.messaging.TaskPublisher.send_task</cite> now
incorporates all the functionality apply_async previously did.</p>
<blockquote>
<div><p>Like converting countdowns to ETA, so <code class="xref py py-func docutils literal notranslate"><span class="pre">celery.execute.apply_async()</span></code> is
now simply a convenient front-end to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">celery.messaging.TaskPublisher.send_task()</span></code>, using
the task classes default options.</p>
<p>Also <code class="xref py py-func docutils literal notranslate"><span class="pre">celery.execute.send_task()</span></code> has been
introduced, which can apply tasks using just the task name (useful
if the client doesn’t have the destination task in its task registry).</p>
<p>Example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.execute</span> <span class="k">import</span> <span class="n">send_task</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">send_task</span><span class="p">(</span><span class="s1">&#39;celery.ping&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">&#39;pong&#39;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first"><cite>camqadm</cite>: This is a new utility for command-line access to the AMQP API.</p>
<blockquote>
<div><p>Excellent for deleting queues/bindings/exchanges, experimentation and
testing:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> camqadm
<span class="go">1&gt; help</span>
</pre></div>
</div>
<p>Gives an interactive shell, type <cite>help</cite> for a list of commands.</p>
<p>When using Django, use the management command instead:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> python manage.py camqadm
<span class="go">1&gt; help</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Redis result backend: To conform to recent Redis API changes, the following
settings has been deprecated:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><cite>REDIS_TIMEOUT</cite></li>
<li><cite>REDIS_CONNECT_RETRY</cite></li>
</ul>
</div></blockquote>
<p>These will emit a <cite>DeprecationWarning</cite> if used.</p>
<p>A <cite>REDIS_PASSWORD</cite> setting has been added, so you can use the new
simple authentication mechanism in Redis.</p>
</div></blockquote>
</li>
<li><p class="first">The redis result backend no longer calls <cite>SAVE</cite> when disconnecting,
as this is apparently better handled by Redis itself.</p>
</li>
<li><p class="first">If <cite>settings.DEBUG</cite> is on, the worker now warns about the possible
memory leak it can result in.</p>
</li>
<li><p class="first">The ETA scheduler now sleeps at most two seconds between iterations.</p>
</li>
<li><p class="first">The ETA scheduler now deletes any revoked tasks it might encounter.</p>
<blockquote>
<div><p>As revokes aren’t yet persistent, this is done to make sure the task
is revoked even though, for example, it’s currently being hold because
its ETA is a week into the future.</p>
</div></blockquote>
</li>
<li><p class="first">The <cite>task_id</cite> argument is now respected even if the task is executed
eagerly (either using apply, or <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ALWAYS_EAGER</span></code>).</p>
</li>
<li><p class="first">The internal queues are now cleared if the connection is reset.</p>
</li>
<li><p class="first">New magic keyword argument: <cite>delivery_info</cite>.</p>
<blockquote>
<div><p>Used by retry() to resend the task to its original destination using the same
exchange/routing_key.</p>
</div></blockquote>
</li>
<li><p class="first">Events: Fields wasn’t passed by <cite>.send()</cite> (fixes the UUID key errors
in celerymon)</p>
</li>
<li><p class="first">Added <cite>–schedule</cite>/<cite>-s</cite> option to the worker, so it is possible to
specify a custom schedule filename when using an embedded <code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>
server (the <cite>-B</cite>/<cite>–beat</cite>) option.</p>
</li>
<li><p class="first">Better Python 2.4 compatibility. The test suite now passes.</p>
</li>
<li><p class="first">task decorators: Now preserve docstring as <cite>cls.__doc__</cite>, (was previously
copied to <cite>cls.run.__doc__</cite>)</p>
</li>
<li><p class="first">The <cite>testproj</cite> directory has been renamed to <cite>tests</cite> and we’re now using
<cite>nose</cite> + <cite>django-nose</cite> for test discovery, and <cite>unittest2</cite> for test
cases.</p>
</li>
<li><p class="first">New pip requirements files available in <code class="file docutils literal notranslate"><span class="pre">requirements</span></code>.</p>
</li>
<li><p class="first">TaskPublisher: Declarations are now done once (per process).</p>
</li>
<li><p class="first">Added <cite>Task.delivery_mode</cite> and the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_DEFAULT_DELIVERY_MODE</span></code>
setting.</p>
<blockquote>
<div><p>These can be used to mark messages non-persistent (i.e., so they’re
lost if the broker is restarted).</p>
</div></blockquote>
</li>
<li><p class="first">Now have our own <cite>ImproperlyConfigured</cite> exception, instead of using the
Django one.</p>
</li>
<li><p class="first">Improvements to the Debian init-scripts: Shows an error if the program is
not executable. Does not modify <cite>CELERYD</cite> when using django with
virtualenv.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-0-0">
<span id="id7"></span><h2><a class="toc-backref" href="#id53">1.0.0</a><a class="headerlink" href="#version-1-0-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-02-10 04:00 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="backward-incompatible-changes">
<span id="v100-incompatible"></span><h3><a class="toc-backref" href="#id54">Backward incompatible changes</a><a class="headerlink" href="#backward-incompatible-changes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Celery doesn’t support detaching anymore, so you have to use the tools
available on your platform, or something like <a class="reference external" href="https://pypi.python.org/pypi/supervisor/">supervisor</a> to make
<code class="docutils literal notranslate"><span class="pre">celeryd</span></code>/<code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>/<code class="docutils literal notranslate"><span class="pre">celerymon</span></code> into background processes.</p>
<blockquote>
<div><p>We’ve had too many problems with the worker daemonizing itself, so it was
decided it has to be removed. Example start-up scripts has been added to
the <cite>extra/</cite> directory:</p>
<ul>
<li><p class="first">Debian, Ubuntu, (<strong class="command">start-stop-daemon</strong>)</p>
<blockquote>
<div><p><cite>extra/debian/init.d/celeryd</cite>
<cite>extra/debian/init.d/celerybeat</cite></p>
</div></blockquote>
</li>
<li><p class="first">macOS <strong class="command">launchd</strong></p>
<blockquote>
<div><p><cite>extra/mac/org.celeryq.celeryd.plist</cite>
<cite>extra/mac/org.celeryq.celerybeat.plist</cite>
<cite>extra/mac/org.celeryq.celerymon.plist</cite></p>
</div></blockquote>
</li>
<li><p class="first">Supervisor (<a class="reference external" href="http://supervisord.org">http://supervisord.org</a>)</p>
<blockquote>
<div><p><cite>extra/supervisord/supervisord.conf</cite></p>
</div></blockquote>
</li>
</ul>
<p>In addition to <cite>–detach</cite>, the following program arguments has been
removed: <cite>–uid</cite>, <cite>–gid</cite>, <cite>–workdir</cite>, <cite>–chroot</cite>, <cite>–pidfile</cite>,
<cite>–umask</cite>. All good daemonization tools should support equivalent
functionality, so don’t worry.</p>
<p>Also the following configuration keys has been removed:
<cite>CELERYD_PID_FILE</cite>, <cite>CELERYBEAT_PID_FILE</cite>, <cite>CELERYMON_PID_FILE</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">Default worker loglevel is now <cite>WARN</cite>, to enable the previous log level
start the worker with <cite>–loglevel=INFO</cite>.</p>
</li>
<li><p class="first">Tasks are automatically registered.</p>
<blockquote>
<div><p>This means you no longer have to register your tasks manually.
You don’t have to change your old code right away, as it doesn’t matter if
a task is registered twice.</p>
<p>If you don’t want your task to be automatically registered you can set
the <cite>abstract</cite> attribute</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>By using <cite>abstract</cite> only tasks subclassing this task will be automatically
registered (this works like the Django ORM).</p>
<p>If you don’t want subclasses to be registered either, you can set the
<cite>autoregister</cite> attribute to <cite>False</cite>.</p>
<p>Incidentally, this change also fixes the problems with automatic name
assignment and relative imports. So you also don’t have to specify a task name
anymore if you use relative imports.</p>
</div></blockquote>
</li>
<li><p class="first">You can no longer use regular functions as tasks.</p>
<blockquote>
<div><p>This change was added
because it makes the internals a lot more clean and simple. However, you can
now turn functions into tasks by using the <cite>&#64;task</cite> decorator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">celery.decorators</span> <span class="kn">import</span> <span class="n">task</span>

<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../userguide/tasks.html#guide-tasks"><span class="std std-ref">Tasks</span></a> for more information about the task decorators.</p>
</div>
</div></blockquote>
</li>
<li><p class="first">The periodic task system has been rewritten to a centralized solution.</p>
<blockquote>
<div><p>This means the worker no longer schedules periodic tasks by default,
but a new daemon has been introduced: <cite>celerybeat</cite>.</p>
<p>To launch the periodic task scheduler you have to run <code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> celerybeat
</pre></div>
</div>
<p>Make sure this is running on one server only, if you run it twice, all
periodic tasks will also be executed twice.</p>
<p>If you only have one worker server you can embed it into the worker like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> celeryd --beat <span class="c1"># Embed celerybeat in celeryd.</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">The supervisor has been removed.</p>
<blockquote>
<div><p>This means the <cite>-S</cite> and <cite>–supervised</cite> options to <cite>celeryd</cite> is
no longer supported. Please use something like <a class="reference external" href="http://supervisord.org">http://supervisord.org</a>
instead.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TaskSet.join</cite> has been removed, use <cite>TaskSetResult.join</cite> instead.</p>
</li>
<li><p class="first">The task status <cite>“DONE”</cite> has been renamed to <cite>“SUCCESS”</cite>.</p>
</li>
<li><p class="first"><cite>AsyncResult.is_done</cite> has been removed, use <cite>AsyncResult.successful</cite>
instead.</p>
</li>
<li><p class="first">The worker no longer stores errors if <cite>Task.ignore_result</cite> is set, to
revert to the previous behavior set
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_STORE_ERRORS_EVEN_IF_IGNORED</span></code> to <cite>True</cite>.</p>
</li>
<li><p class="first">The statistics functionality has been removed in favor of events,
so the <cite>-S</cite> and –statistics` switches has been removed.</p>
</li>
<li><p class="first">The module <cite>celery.task.strategy</cite> has been removed.</p>
</li>
<li><p class="first"><cite>celery.discovery</cite> has been removed, and it’s <code class="docutils literal notranslate"><span class="pre">autodiscover</span></code> function is
now in <cite>celery.loaders.djangoapp</cite>. Reason: Internal API.</p>
</li>
<li><p class="first">The <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CELERY_LOADER</span></code> environment variable now needs loader class name
in addition to module name,</p>
<blockquote>
<div><p>For example, where you previously had: <cite>“celery.loaders.default”</cite>, you now
need <cite>“celery.loaders.default.Loader”</cite>, using the previous syntax will result
in a <cite>DeprecationWarning</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">Detecting the loader is now lazy, and so isn’t done when importing
<cite>celery.loaders</cite>.</p>
<blockquote>
<div><p>To make this happen <cite>celery.loaders.settings</cite> has
been renamed to <cite>load_settings</cite> and is now a function returning the
settings object. <cite>celery.loaders.current_loader</cite> is now also
a function, returning the current loader.</p>
<p>So:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">loader</span> <span class="o">=</span> <span class="n">current_loader</span>
</pre></div>
</div>
<p>needs to be changed to:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">loader</span> <span class="o">=</span> <span class="n">current_loader</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="deprecations">
<span id="v100-deprecations"></span><h3><a class="toc-backref" href="#id55">Deprecations</a><a class="headerlink" href="#deprecations" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The following configuration variables has been renamed and will be
deprecated in v2.0:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CELERYD_DAEMON_LOG_FORMAT</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERYD_LOG_FORMAT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERYD_DAEMON_LOG_LEVEL</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERYD_LOG_LEVEL</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_CONNECTION_TIMEOUT</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERY_BROKER_CONNECTION_TIMEOUT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_CONNECTION_RETRY</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERY_BROKER_CONNECTION_RETRY</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_CONNECTION_MAX_RETRIES</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERY_BROKER_CONNECTION_MAX_RETRIES</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">SEND_CELERY_TASK_ERROR_EMAILS</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERY_SEND_TASK_ERROR_EMAILS</span></code></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The public API names in celery.conf has also changed to a consistent naming
scheme.</p>
</li>
<li><p class="first">We now support consuming from an arbitrary number of queues.</p>
<blockquote>
<div><p>To do this we had to rename the configuration syntax. If you use any of
the custom AMQP routing options (queue/exchange/routing_key, etc.), you
should read the new FAQ entry: <a class="reference internal" href="../faq.html#faq-task-routing"><span class="std std-ref">Can I send some tasks to only some servers?</span></a>.</p>
<p>The previous syntax is deprecated and scheduled for removal in v2.0.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TaskSet.run</cite> has been renamed to <cite>TaskSet.apply_async</cite>.</p>
<blockquote>
<div><p><cite>TaskSet.run</cite> has now been deprecated, and is scheduled for
removal in v2.0.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id56">News</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Rate limiting support (per task type, or globally).</p>
</li>
<li><p class="first">New periodic task system.</p>
</li>
<li><p class="first">Automatic registration.</p>
</li>
<li><p class="first">New cool task decorator syntax.</p>
</li>
<li><p class="first">worker: now sends events if enabled with the <cite>-E</cite> argument.</p>
<blockquote>
<div><p>Excellent for monitoring tools, one is already in the making
(<a class="reference external" href="https://github.com/celery/celerymon">https://github.com/celery/celerymon</a>).</p>
<p>Current events include: <a class="reference internal" href="../userguide/monitoring.html#std:event-worker-heartbeat"><code class="xref std std-event docutils literal notranslate"><span class="pre">worker-heartbeat</span></code></a>,
task-[received/succeeded/failed/retried],
<a class="reference internal" href="../userguide/monitoring.html#std:event-worker-online"><code class="xref std std-event docutils literal notranslate"><span class="pre">worker-online</span></code></a>, <a class="reference internal" href="../userguide/monitoring.html#std:event-worker-offline"><code class="xref std std-event docutils literal notranslate"><span class="pre">worker-offline</span></code></a>.</p>
</div></blockquote>
</li>
<li><p class="first">You can now delete (revoke) tasks that’s already been applied.</p>
</li>
<li><p class="first">You can now set the hostname the worker identifies as using the <cite>–hostname</cite>
argument.</p>
</li>
<li><p class="first">Cache backend now respects the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code> setting.</p>
</li>
<li><p class="first">Message format has been standardized and now uses ISO-8601 format
for dates instead of datetime.</p>
</li>
<li><p class="first">worker now responds to the <code class="xref std std-sig docutils literal notranslate"><span class="pre">SIGHUP</span></code> signal by restarting itself.</p>
</li>
<li><p class="first">Periodic tasks are now scheduled on the clock.</p>
<blockquote>
<div><p>That is, <cite>timedelta(hours=1)</cite> means every hour at :00 minutes, not every
hour from the server starts. To revert to the previous behavior you
can set <cite>PeriodicTask.relative = True</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">Now supports passing execute options to a TaskSets list of args.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">TaskSet</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;countdown&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span>
<span class="gp">... </span>                   <span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;countdown&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}),</span>
<span class="gp">... </span>                   <span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;countdown&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Got a 3x performance gain by setting the prefetch count to four times the
concurrency, (from an average task round-trip of 0.1s to 0.03s!).</p>
<blockquote>
<div><p>A new setting has been added: <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_PREFETCH_MULTIPLIER</span></code>, which
is set to <cite>4</cite> by default.</p>
</div></blockquote>
</li>
<li><p class="first">Improved support for webhook tasks.</p>
<blockquote>
<div><p><cite>celery.task.rest</cite> is now deprecated, replaced with the new and shiny
<cite>celery.task.http</cite>. With more reflective names, sensible interface,
and it’s possible to override the methods used to perform HTTP requests.</p>
</div></blockquote>
</li>
<li><p class="first">The results of task sets are now cached by storing it in the result
backend.</p>
</li>
</ul>
</div>
<div class="section" id="v100-changes">
<span id="id9"></span><h3><a class="toc-backref" href="#id57">Changes</a><a class="headerlink" href="#v100-changes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Now depends on <a class="reference external" href="https://pypi.python.org/pypi/carrot/">carrot</a> &gt;= 0.8.1</p>
</li>
<li><p class="first">New dependencies: <a class="reference external" href="https://pypi.python.org/pypi/billiard/">billiard</a>, <a class="reference external" href="https://pypi.python.org/pypi/python-dateutil/">python-dateutil</a>,
<a class="reference external" href="https://pypi.python.org/pypi/django-picklefield/">django-picklefield</a>.</p>
</li>
<li><p class="first">No longer depends on python-daemon</p>
</li>
<li><p class="first">The <cite>uuid</cite> distribution is added as a dependency when running Python 2.4.</p>
</li>
<li><p class="first">Now remembers the previously detected loader by keeping it in
the <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CELERY_LOADER</span></code> environment variable.</p>
<blockquote>
<div><p>This may help on windows where fork emulation is used.</p>
</div></blockquote>
</li>
<li><p class="first">ETA no longer sends datetime objects, but uses ISO 8601 date format in a
string for better compatibility with other platforms.</p>
</li>
<li><p class="first">No longer sends error mails for retried tasks.</p>
</li>
<li><p class="first">Task can now override the backend used to store results.</p>
</li>
<li><p class="first">Refactored the ExecuteWrapper, <cite>apply</cite> and <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ALWAYS_EAGER</span></code>
now also executes the task callbacks and signals.</p>
</li>
<li><p class="first">Now using a proper scheduler for the tasks with an ETA.</p>
<blockquote>
<div><p>This means waiting ETA tasks are sorted by time, so we don’t have
to poll the whole list all the time.</p>
</div></blockquote>
</li>
<li><p class="first">Now also imports modules listed in <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_IMPORTS</span></code> when running
with django (as documented).</p>
</li>
<li><p class="first">Log level for stdout/stderr changed from INFO to ERROR</p>
</li>
<li><p class="first">ImportErrors are now properly propagated when auto-discovering tasks.</p>
</li>
<li><p class="first">You can now use <cite>celery.messaging.establish_connection</cite> to establish a
connection to the broker.</p>
</li>
<li><p class="first">When running as a separate service the periodic task scheduler does some
smart moves to not poll too regularly.</p>
<blockquote>
<div><p>If you need faster poll times you can lower the value
of <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYBEAT_MAX_LOOP_INTERVAL</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first">You can now change periodic task intervals at runtime, by making
<cite>run_every</cite> a property, or subclassing <cite>PeriodicTask.is_due</cite>.</p>
</li>
<li><p class="first">The worker now supports control commands enabled through the use of a
broadcast queue, you can remotely revoke tasks or set the rate limit for
a task type. See <code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.task.control</span></code>.</p>
</li>
<li><p class="first">The services now sets informative process names (as shown in <cite>ps</cite>
listings) if the <a class="reference external" href="https://pypi.python.org/pypi/setproctitle/">setproctitle</a> module is installed.</p>
</li>
<li><p class="first"><a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.NotRegistered" title="celery.exceptions.NotRegistered"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotRegistered</span></code></a> now inherits from <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#KeyError" title="(in Python v3.8)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a>,
and <cite>TaskRegistry.__getitem__`+`pop</cite> raises <cite>NotRegistered</cite> instead</p>
</li>
<li><p class="first">You can set the loader via the <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CELERY_LOADER</span></code> environment variable.</p>
</li>
<li><p class="first">You can now set <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_IGNORE_RESULT</span></code> to ignore task results by
default (if enabled, tasks doesn’t save results or errors to the backend used).</p>
</li>
<li><p class="first">The worker now correctly handles malformed messages by throwing away and
acknowledging the message, instead of crashing.</p>
</li>
</ul>
</div>
<div class="section" id="bugs">
<span id="v100-bugs"></span><h3><a class="toc-backref" href="#id58">Bugs</a><a class="headerlink" href="#bugs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Fixed a race condition that could happen while storing task results in the
database.</li>
</ul>
</div>
<div class="section" id="documentation">
<span id="v100-documentation"></span><h3><a class="toc-backref" href="#id59">Documentation</a><a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Reference now split into two sections; API reference and internal module
reference.</li>
</ul>
</div>
</div>
<div class="section" id="version-0-8-4">
<span id="id10"></span><h2><a class="toc-backref" href="#id60">0.8.4</a><a class="headerlink" href="#version-0-8-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-02-05 01:52 p.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Now emits a warning if the –detach argument is used.
–detach shouldn’t be used anymore, as it has several not easily fixed
bugs related to it. Instead, use something like start-stop-daemon,
<a class="reference external" href="https://pypi.python.org/pypi/supervisor/">supervisor</a> or <strong class="command">launchd</strong> (macOS).</li>
<li>Make sure logger class is process aware, even if running Python &gt;= 2.6.</li>
<li>Error emails are not sent anymore when the task is retried.</li>
</ul>
</div>
<div class="section" id="version-0-8-3">
<span id="id11"></span><h2><a class="toc-backref" href="#id61">0.8.3</a><a class="headerlink" href="#version-0-8-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-12-22 09:43 a.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixed a possible race condition that could happen when storing/querying
task results using the database backend.</li>
<li>Now has console script entry points in the <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> file, so tools like
<a class="reference external" href="https://pypi.python.org/pypi/zc.buildout/">zc.buildout</a> will correctly install the programs <code class="docutils literal notranslate"><span class="pre">celeryd</span></code> and
<code class="docutils literal notranslate"><span class="pre">celeryinit</span></code>.</li>
</ul>
</div>
<div class="section" id="version-0-8-2">
<span id="id12"></span><h2><a class="toc-backref" href="#id62">0.8.2</a><a class="headerlink" href="#version-0-8-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-11-20 03:40 p.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>QOS Prefetch count wasn’t applied properly, as it was set for every message
received (which apparently behaves like, “receive one more”), instead of only
set when our wanted value changed.</li>
</ul>
</div>
<div class="section" id="version-0-8-1">
<span id="id13"></span><h2><a class="toc-backref" href="#id63">0.8.1</a><a class="headerlink" href="#version-0-8-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-11-16 05:21 p.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="very-important-note">
<span id="v081-very-important"></span><h3><a class="toc-backref" href="#id64">Very important note</a><a class="headerlink" href="#very-important-note" title="Permalink to this headline">¶</a></h3>
<p>This release (with carrot 0.8.0) enables AMQP QoS (quality of service), which
means the workers will only receive as many messages as it can handle at a
time. As with any release, you should test this version upgrade on your
development servers before rolling it out to production!</p>
</div>
<div class="section" id="important-changes">
<span id="v081-important"></span><h3><a class="toc-backref" href="#id65">Important changes</a><a class="headerlink" href="#important-changes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">If you’re using Python &lt; 2.6 and you use the multiprocessing backport, then
multiprocessing version 2.6.2.1 is required.</p>
</li>
<li><p class="first">All AMQP_* settings has been renamed to BROKER_*, and in addition
AMQP_SERVER has been renamed to BROKER_HOST, so before where you had:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">AMQP_SERVER</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
<span class="n">AMQP_PORT</span> <span class="o">=</span> <span class="mi">5678</span>
<span class="n">AMQP_USER</span> <span class="o">=</span> <span class="s1">&#39;myuser&#39;</span>
<span class="n">AMQP_PASSWORD</span> <span class="o">=</span> <span class="s1">&#39;mypassword&#39;</span>
<span class="n">AMQP_VHOST</span> <span class="o">=</span> <span class="s1">&#39;celery&#39;</span>
</pre></div>
</div>
<p>You need to change that to:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">BROKER_HOST</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
<span class="n">BROKER_PORT</span> <span class="o">=</span> <span class="mi">5678</span>
<span class="n">BROKER_USER</span> <span class="o">=</span> <span class="s1">&#39;myuser&#39;</span>
<span class="n">BROKER_PASSWORD</span> <span class="o">=</span> <span class="s1">&#39;mypassword&#39;</span>
<span class="n">BROKER_VHOST</span> <span class="o">=</span> <span class="s1">&#39;celery&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">Custom carrot backends now need to include the backend class name, so before
where you had:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">CARROT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;mycustom.backend.module&#39;</span>
</pre></div>
</div>
<p>you need to change it to:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">CARROT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;mycustom.backend.module.Backend&#39;</span>
</pre></div>
</div>
<p>where <cite>Backend</cite> is the class name. This is probably <cite>“Backend”</cite>, as
that was the previously implied name.</p>
</li>
<li><p class="first">New version requirement for carrot: 0.8.0</p>
</li>
</ul>
</div>
<div class="section" id="v081-changes">
<span id="id14"></span><h3><a class="toc-backref" href="#id66">Changes</a><a class="headerlink" href="#v081-changes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Incorporated the multiprocessing backport patch that fixes the
<cite>processName</cite> error.</li>
<li>Ignore the result of PeriodicTask’s by default.</li>
<li>Added a Redis result store backend</li>
<li>Allow <code class="file docutils literal notranslate"><span class="pre">/etc/default/celeryd</span></code> to define additional options
for the <code class="docutils literal notranslate"><span class="pre">celeryd</span></code> init-script.</li>
<li>MongoDB periodic tasks issue when using different time than UTC fixed.</li>
<li>Windows specific: Negate test for available <code class="docutils literal notranslate"><span class="pre">os.fork</span></code>
(thanks <a class="reference external" href="https://github.com/miracle2k/">&#64;miracle2k</a>).</li>
<li>Now tried to handle broken PID files.</li>
<li>Added a Django test runner to contrib that sets
<cite>CELERY_ALWAYS_EAGER = True</cite> for testing with the database backend.</li>
<li>Added a <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_CACHE_BACKEND</span></code> setting for using something other
than the Django-global cache backend.</li>
<li>Use custom implementation of <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code> for Python 2.4 support
(Probably still problems with running on 2.4, but it will eventually be
supported)</li>
<li>Prepare exception to pickle when saving <a class="reference internal" href="../userguide/tasks.html#std:state-RETRY"><code class="xref std std-state docutils literal notranslate"><span class="pre">RETRY</span></code></a> status for all backends.</li>
<li>SQLite no concurrency limit should only be effective if the database backend
is used.</li>
</ul>
</div>
</div>
<div class="section" id="version-0-8-0">
<span id="id15"></span><h2><a class="toc-backref" href="#id67">0.8.0</a><a class="headerlink" href="#version-0-8-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-09-22 03:06 p.m. CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="v080-incompatible">
<span id="id16"></span><h3><a class="toc-backref" href="#id68">Backward incompatible changes</a><a class="headerlink" href="#v080-incompatible" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Add traceback to result value on failure.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you use the database backend you have to re-create the
database table <cite>celery_taskmeta</cite>.</p>
<p class="last">Contact the <a class="reference internal" href="../getting-started/resources.html#mailing-list"><span class="std std-ref">Mailing list</span></a> or <a class="reference internal" href="../getting-started/resources.html#irc-channel"><span class="std std-ref">IRC</span></a> channel
for help doing this.</p>
</div>
</div></blockquote>
</li>
<li><p class="first">Database tables are now only created if the database backend is used,
so if you change back to the database backend at some point,
be sure to initialize tables (django: <cite>syncdb</cite>, python: <cite>celeryinit</cite>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is only applies if using Django version 1.1 or higher.</p>
</div>
</li>
<li><p class="first">Now depends on <cite>carrot</cite> version 0.6.0.</p>
</li>
<li><p class="first">Now depends on python-daemon 1.4.8</p>
</li>
</ul>
</div>
<div class="section" id="v080-important">
<span id="id17"></span><h3><a class="toc-backref" href="#id69">Important changes</a><a class="headerlink" href="#v080-important" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Celery can now be used in pure Python (outside of a Django project).</p>
<blockquote>
<div><p>This means Celery is no longer Django specific.</p>
<p>For more information see the FAQ entry
<a class="reference internal" href="../faq.html#faq-is-celery-for-django-only"><span class="std std-ref">Is Celery for Django only?</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Celery now supports task retries.</p>
<blockquote>
<div><p>See <a class="reference internal" href="../userguide/tasks.html#task-retry"><span class="std std-ref">Retrying</span></a> for more information.</p>
</div></blockquote>
</li>
<li><p class="first">We now have an AMQP result store backend.</p>
<blockquote>
<div><p>It uses messages to publish task return value and status. And it’s
incredibly fast!</p>
<p>See <span class="xref issue">issue #6</span> for more info!</p>
</div></blockquote>
</li>
<li><p class="first">AMQP QoS (prefetch count) implemented:</p>
<blockquote>
<div><p>This to not receive more messages than we can handle.</p>
</div></blockquote>
</li>
<li><p class="first">Now redirects stdout/stderr to the workers log file when detached</p>
</li>
<li><dl class="first docutils">
<dt>Now uses <cite>inspect.getargspec</cite> to only pass default arguments</dt>
<dd><p class="first last">the task supports.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Add Task.on_success, .on_retry, .on_failure handlers</dt>
<dd><dl class="first last docutils">
<dt>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">celery.task.base.Task.on_success()</span></code>,</dt>
<dd><p class="first last"><code class="xref py py-meth docutils literal notranslate"><span class="pre">celery.task.base.Task.on_retry()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">celery.task.base.Task.on_failure()</span></code>,</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>celery.utils.gen_unique_id</cite>: Workaround for</dt>
<dd><p class="first last"><a class="reference external" href="http://bugs.python.org/issue4607">http://bugs.python.org/issue4607</a></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>You can now customize what happens at worker start, at process init, etc.,</dt>
<dd><p class="first last">by creating your own loaders (see <a class="reference internal" href="../reference/celery.loaders.default.html#module-celery.loaders.default" title="celery.loaders.default"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.loaders.default</span></code></a>,
<code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.loaders.djangoapp</span></code>, <a class="reference internal" href="../reference/celery.loaders.html#module-celery.loaders" title="celery.loaders"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.loaders</span></code></a>).</p>
</dd>
</dl>
</li>
<li><p class="first">Support for multiple AMQP exchanges and queues.</p>
<blockquote>
<div><p>This feature misses documentation and tests, so anyone interested
is encouraged to improve this situation.</p>
</div></blockquote>
</li>
<li><p class="first">The worker now survives a restart of the AMQP server!</p>
<p>Automatically re-establish AMQP broker connection if it’s lost.</p>
<p>New settings:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>AMQP_CONNECTION_RETRY</dt>
<dd>Set to <cite>True</cite> to enable connection retries.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>AMQP_CONNECTION_MAX_RETRIES.</dt>
<dd>Maximum number of restarts before we give up. Default: <cite>100</cite>.</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="v080-news">
<span id="id18"></span><h3><a class="toc-backref" href="#id70">News</a><a class="headerlink" href="#v080-news" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><dl class="first docutils">
<dt>Fix an incompatibility between python-daemon and multiprocessing,</dt>
<dd>which resulted in the <cite>[Errno 10] No child processes</cite> problem when
detaching.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Fixed a possible DjangoUnicodeDecodeError being raised when saving pickled</dt>
<dd>data to Django`s Memcached cache backend.</dd>
</dl>
</li>
<li>Better Windows compatibility.</li>
<li><dl class="first docutils">
<dt>New version of the pickled field (taken from</dt>
<dd><a class="reference external" href="http://www.djangosnippets.org/snippets/513/">http://www.djangosnippets.org/snippets/513/</a>)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>New signals introduced: <cite>task_sent</cite>, <cite>task_prerun</cite> and</dt>
<dd><cite>task_postrun</cite>, see <a class="reference internal" href="../reference/celery.signals.html#module-celery.signals" title="celery.signals"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.signals</span></code></a> for more information.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>TaskSetResult.join</cite> caused <cite>TypeError</cite> when <cite>timeout=None</cite>.</dt>
<dd>Thanks Jerzy Kozera. Closes #31</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>views.apply</cite> should return <cite>HttpResponse</cite> instance.</dt>
<dd>Thanks to Jerzy Kozera. Closes #32</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><cite>PeriodicTask</cite>: Save conversion of <cite>run_every</cite> from <cite>int</cite></dt>
<dd>to <cite>timedelta</cite> to the class attribute instead of on the instance.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Exceptions has been moved to <cite>celery.exceptions</cite>, but are still</dt>
<dd>available in the previous module.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Try to rollback transaction and retry saving result if an error happens</dt>
<dd>while setting task status with the database backend.</dd>
</dl>
</li>
<li>jail() refactored into <code class="xref py py-class docutils literal notranslate"><span class="pre">celery.execute.ExecuteWrapper</span></code>.</li>
<li><cite>views.apply</cite> now correctly sets mime-type to “application/json”</li>
<li><cite>views.task_status</cite> now returns exception if state is <a class="reference internal" href="../userguide/tasks.html#std:state-RETRY"><code class="xref std std-state docutils literal notranslate"><span class="pre">RETRY</span></code></a></li>
<li><dl class="first docutils">
<dt><cite>views.task_status</cite> now returns traceback if state is <a class="reference internal" href="../userguide/tasks.html#std:state-FAILURE"><code class="xref std std-state docutils literal notranslate"><span class="pre">FAILURE</span></code></a></dt>
<dd>or <a class="reference internal" href="../userguide/tasks.html#std:state-RETRY"><code class="xref std std-state docutils literal notranslate"><span class="pre">RETRY</span></code></a></dd>
</dl>
</li>
<li>Documented default task arguments.</li>
<li>Add a sensible __repr__ to ExceptionInfo for easier debugging</li>
<li><dl class="first docutils">
<dt>Fix documentation typo <cite>.. import map</cite> -&gt; <cite>.. import dmap</cite>.</dt>
<dd>Thanks to <a class="reference external" href="https://github.com/mikedizon/">&#64;mikedizon</a>.</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="version-0-6-0">
<span id="id19"></span><h2><a class="toc-backref" href="#id71">0.6.0</a><a class="headerlink" href="#version-0-6-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-08-07 06:54 a.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="v060-important">
<span id="id20"></span><h3><a class="toc-backref" href="#id72">Important changes</a><a class="headerlink" href="#v060-important" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><dl class="first docutils">
<dt>Fixed a bug where tasks raising unpickleable exceptions crashed pool</dt>
<dd>workers. So if you’ve had pool workers mysteriously disappearing, or
problems with the worker stopping working, this has been fixed in this
version.</dd>
</dl>
</li>
<li>Fixed a race condition with periodic tasks.</li>
<li><dl class="first docutils">
<dt>The task pool is now supervised, so if a pool worker crashes,</dt>
<dd>goes away or stops responding, it is automatically replaced with
a new one.</dd>
</dl>
</li>
<li>Task.name is now automatically generated out of class module+name, for
example <cite>“djangotwitter.tasks.UpdateStatusesTask”</cite>. Very convenient.
No idea why we didn’t do this before. Some documentation is updated to not
manually specify a task name.</li>
</ul>
</div>
<div class="section" id="v060-news">
<span id="id21"></span><h3><a class="toc-backref" href="#id73">News</a><a class="headerlink" href="#v060-news" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Tested with Django 1.1</li>
<li>New Tutorial: Creating a click counter using Carrot and Celery</li>
<li><dl class="first docutils">
<dt>Database entries for periodic tasks are now created at the workers</dt>
<dd>start-up instead of for each check (which has been a forgotten TODO/XXX
in the code for a long time)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>New settings variable: <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code></dt>
<dd>Time (in seconds, or a <cite>datetime.timedelta</cite> object) for when after
stored task results are deleted. For the moment this only works for the
database backend.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>The worker now emits a debug log message for which periodic tasks</dt>
<dd>has been launched.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>The periodic task table is now locked for reading while getting</dt>
<dd>periodic task status (MySQL only so far, seeking patches for other
engines)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>A lot more debugging information is now available by turning on the</dt>
<dd><cite>DEBUG</cite> log level (<cite>–loglevel=DEBUG</cite>).</dd>
</dl>
</li>
<li>Functions/methods with a timeout argument now works correctly.</li>
<li><dl class="first docutils">
<dt>New: <cite>celery.strategy.even_time_distribution</cite>:</dt>
<dd>With an iterator yielding task args, kwargs tuples, evenly distribute
the processing of its tasks throughout the time window available.</dd>
</dl>
</li>
<li>Log message <cite>Unknown task ignored…</cite> now has log level <cite>ERROR</cite></li>
<li><dl class="first docutils">
<dt>Log message when task is received is now emitted for all tasks, even if</dt>
<dd>the task has an ETA (estimated time of arrival). Also the log message now
includes the ETA for the task (if any).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Acknowledgment now happens in the pool callback. Can’t do ack in the job</dt>
<dd>target, as it’s not pickleable (can’t share AMQP connection, etc.).</dd>
</dl>
</li>
<li>Added note about .delay hanging in README</li>
<li>Tests now passing in Django 1.1</li>
<li>Fixed discovery to make sure app is in INSTALLED_APPS</li>
<li><dl class="first docutils">
<dt>Previously overridden pool behavior (process reap, wait until pool worker</dt>
<dd>available, etc.) is now handled by <cite>multiprocessing.Pool</cite> itself.</dd>
</dl>
</li>
<li>Convert statistics data to Unicode for use as kwargs. Thanks Lucy!</li>
</ul>
</div>
</div>
<div class="section" id="version-0-4-1">
<span id="id22"></span><h2><a class="toc-backref" href="#id74">0.4.1</a><a class="headerlink" href="#version-0-4-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-07-02 01:42 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixed a bug with parsing the message options (<cite>mandatory</cite>,
<cite>routing_key</cite>, <cite>priority</cite>, <cite>immediate</cite>)</li>
</ul>
</div>
<div class="section" id="version-0-4-0">
<span id="id23"></span><h2><a class="toc-backref" href="#id75">0.4.0</a><a class="headerlink" href="#version-0-4-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-07-01 07:29 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Adds eager execution. <cite>celery.execute.apply`|`Task.apply</cite> executes the
function blocking until the task is done, for API compatibility it
returns a <cite>celery.result.EagerResult</cite> instance. You can configure
Celery to always run tasks locally by setting the
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ALWAYS_EAGER</span></code> setting to <cite>True</cite>.</li>
<li>Now depends on <cite>anyjson</cite>.</li>
<li>99% coverage using Python <cite>coverage</cite> 3.0.</li>
</ul>
</div>
<div class="section" id="version-0-3-20">
<span id="id24"></span><h2><a class="toc-backref" href="#id76">0.3.20</a><a class="headerlink" href="#version-0-3-20" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-06-25 08:42 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">New arguments to <cite>apply_async</cite> (the advanced version of
<cite>delay_task</cite>), <cite>countdown</cite> and <cite>eta</cite>;</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run 10 seconds into the future.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">apply_async</span><span class="p">(</span><span class="n">MyTask</span><span class="p">,</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run 1 day from now</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">apply_async</span><span class="p">(</span><span class="n">MyTask</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">eta</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p class="first">Now unlinks stale PID files</p>
</li>
<li><p class="first">Lots of more tests.</p>
</li>
<li><p class="first">Now compatible with carrot &gt;= 0.5.0.</p>
</li>
<li><p class="first"><strong>IMPORTANT</strong> The <cite>subtask_ids</cite> attribute on the <cite>TaskSetResult</cite>
instance has been removed. To get this information instead use:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subtask_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">subtask</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">subtask</span> <span class="ow">in</span> <span class="n">ts_res</span><span class="o">.</span><span class="n">subtasks</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first"><cite>Taskset.run()</cite> now respects extra message options from the task class.</p>
</li>
<li><p class="first">Task: Add attribute <cite>ignore_result</cite>: Don’t store the status and
return value. This means you can’t use the
<cite>celery.result.AsyncResult</cite> to check if the task is
done, or get its return value. Only use if you need the performance
and is able live without these features. Any exceptions raised will
store the return value/status as usual.</p>
</li>
<li><p class="first">Task: Add attribute <cite>disable_error_emails</cite> to disable sending error
emails for that task.</p>
</li>
<li><p class="first">Should now work on Windows (although running in the background won’t
work, so using the <cite>–detach</cite> argument results in an exception
being raised).</p>
</li>
<li><p class="first">Added support for statistics for profiling and monitoring.
To start sending statistics start the worker with the
<cite>–statistics option. Then after a while you can dump the results
by running `python manage.py celerystats</cite>. See
<cite>celery.monitoring</cite> for more information.</p>
</li>
<li><p class="first">The Celery daemon can now be supervised (i.e., it is automatically
restarted if it crashes). To use this start the worker with the
–supervised` option (or alternatively <cite>-S</cite>).</p>
</li>
<li><p class="first">views.apply: View calling a task.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http://e.com/celery/apply/task_name/arg1/arg2//?kwarg1=a&amp;kwarg2=b
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Use with caution! Don’t expose this URL to the public
without first ensuring that your code is safe!</p>
</div>
</div></blockquote>
</li>
<li><p class="first">Refactored <cite>celery.task</cite>. It’s now split into three modules:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">celery.task</span></code></p>
<blockquote>
<div><p>Contains <cite>apply_async</cite>, <cite>delay_task</cite>, <cite>discard_all</cite>, and task
shortcuts, plus imports objects from <cite>celery.task.base</cite> and
<cite>celery.task.builtins</cite></p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">celery.task.base</span></code></p>
<blockquote>
<div><p>Contains task base classes: <cite>Task</cite>, <cite>PeriodicTask</cite>,
<cite>TaskSet</cite>, <cite>AsynchronousMapTask</cite>, <cite>ExecuteRemoteTask</cite>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">celery.task.builtins</span></code></p>
<blockquote>
<div><p>Built-in tasks: <cite>PingTask</cite>, <cite>DeleteExpiredTaskMetaTask</cite>.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-0-3-7">
<span id="id25"></span><h2><a class="toc-backref" href="#id77">0.3.7</a><a class="headerlink" href="#version-0-3-7" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2008-06-16 11:41 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first"><strong>IMPORTANT</strong> Now uses AMQP`s <cite>basic.consume</cite> instead of
<cite>basic.get</cite>. This means we’re no longer polling the broker for
new messages.</p>
</li>
<li><p class="first"><strong>IMPORTANT</strong> Default concurrency limit is now set to the number of CPUs
available on the system.</p>
</li>
<li><p class="first"><strong>IMPORTANT</strong> <cite>tasks.register</cite>: Renamed <cite>task_name</cite> argument to
<cite>name</cite>, so:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tasks</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;mytask&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>has to be replaced with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tasks</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mytask&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">The daemon now correctly runs if the pidfile is stale.</p>
</li>
<li><p class="first">Now compatible with carrot 0.4.5</p>
</li>
<li><p class="first">Default AMQP connection timeout is now 4 seconds.</p>
</li>
<li><p class="first"><cite>AsyncResult.read()</cite> was always returning <cite>True</cite>.</p>
</li>
<li><p class="first">Only use README as long_description if the file exists so easy_install
doesn’t break.</p>
</li>
<li><p class="first"><cite>celery.view</cite>: JSON responses now properly set its mime-type.</p>
</li>
<li><p class="first"><cite>apply_async</cite> now has a <cite>connection</cite> keyword argument so you
can re-use the same AMQP connection if you want to execute
more than one task.</p>
</li>
<li><p class="first">Handle failures in task_status view such that it won’t throw 500s.</p>
</li>
<li><p class="first">Fixed typo <cite>AMQP_SERVER</cite> in documentation to <cite>AMQP_HOST</cite>.</p>
</li>
<li><p class="first">Worker exception emails sent to administrators now works properly.</p>
</li>
<li><p class="first">No longer depends on <cite>django</cite>, so installing <cite>celery</cite> won’t affect
the preferred Django version installed.</p>
</li>
<li><p class="first">Now works with PostgreSQL (<a class="reference external" href="https://pypi.python.org/pypi/psycopg2/">psycopg2</a>) again by registering the
<cite>PickledObject</cite> field.</p>
</li>
<li><p class="first">Worker: Added <cite>–detach</cite> option as an alias to <cite>–daemon</cite>, and
it’s the term used in the documentation from now on.</p>
</li>
<li><p class="first">Make sure the pool and periodic task worker thread is terminated
properly at exit (so <kbd class="kbd docutils literal notranslate">Control-c</kbd> works again).</p>
</li>
<li><p class="first">Now depends on <cite>python-daemon</cite>.</p>
</li>
<li><p class="first">Removed dependency to <cite>simplejson</cite></p>
</li>
<li><p class="first">Cache Backend: Re-establishes connection for every task process
if the Django cache backend is <a class="reference external" href="https://pypi.python.org/pypi/python-memcached/">python-memcached</a>/<a class="reference external" href="https://pypi.python.org/pypi/libmemcached/">libmemcached</a>.</p>
</li>
<li><p class="first">Tyrant Backend: Now re-establishes the connection for every task
executed.</p>
</li>
</ul>
</div>
<div class="section" id="version-0-3-3">
<span id="id26"></span><h2><a class="toc-backref" href="#id78">0.3.3</a><a class="headerlink" href="#version-0-3-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-06-08 01:07 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>The <cite>PeriodicWorkController</cite> now sleeps for 1 second between checking
for periodic tasks to execute.</li>
</ul>
</div>
<div class="section" id="version-0-3-2">
<span id="id27"></span><h2><a class="toc-backref" href="#id79">0.3.2</a><a class="headerlink" href="#version-0-3-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-06-08 01:07 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>worker: Added option <cite>–discard</cite>: Discard (delete!) all waiting
messages in the queue.</li>
<li>Worker: The <cite>–wakeup-after</cite> option wasn’t handled as a float.</li>
</ul>
</div>
<div class="section" id="version-0-3-1">
<span id="id28"></span><h2><a class="toc-backref" href="#id80">0.3.1</a><a class="headerlink" href="#version-0-3-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-06-08 01:07 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>The <cite>PeriodicTask</cite> worker is now running in its own thread instead
of blocking the <cite>TaskController</cite> loop.</li>
<li>Default <cite>QUEUE_WAKEUP_AFTER</cite> has been lowered to <cite>0.1</cite> (was <cite>0.3</cite>)</li>
</ul>
</div>
<div class="section" id="version-0-3-0">
<span id="id29"></span><h2><a class="toc-backref" href="#id81">0.3.0</a><a class="headerlink" href="#version-0-3-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-06-08 12:41 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a development version, for the stable release, please
see versions 0.2.x.</p>
</div>
<p><strong>VERY IMPORTANT:</strong> Pickle is now the encoder used for serializing task
arguments, so be sure to flush your task queue before you upgrade.</p>
<ul>
<li><p class="first"><strong>IMPORTANT</strong> TaskSet.run() now returns a <code class="docutils literal notranslate"><span class="pre">celery.result.TaskSetResult</span></code>
instance, which lets you inspect the status and return values of a
taskset as it was a single entity.</p>
</li>
<li><p class="first"><strong>IMPORTANT</strong> Celery now depends on carrot &gt;= 0.4.1.</p>
</li>
<li><p class="first">The Celery daemon now sends task errors to the registered admin emails.
To turn off this feature, set <cite>SEND_CELERY_TASK_ERROR_EMAILS</cite> to
<cite>False</cite> in your <cite>settings.py</cite>. Thanks to Grégoire Cachet.</p>
</li>
<li><p class="first">You can now run the Celery daemon by using <cite>manage.py</cite>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> python manage.py celeryd
</pre></div>
</div>
<p>Thanks to Grégoire Cachet.</p>
</li>
<li><p class="first">Added support for message priorities, topic exchanges, custom routing
keys for tasks. This means we’ve introduced
<cite>celery.task.apply_async</cite>, a new way of executing tasks.</p>
<p>You can use <cite>celery.task.delay</cite> and <cite>celery.Task.delay</cite> like usual, but
if you want greater control over the message sent, you want
<cite>celery.task.apply_async</cite> and <cite>celery.Task.apply_async</cite>.</p>
<p>This also means the AMQP configuration has changed. Some settings has
been renamed, while others are new:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_EXCHANGE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_PUBLISHER_ROUTING_KEY</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_CONSUMER_ROUTING_KEY</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_CONSUMER_QUEUE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_EXCHANGE_TYPE</span></code></li>
</ul>
</div></blockquote>
<p>See the entry <a class="reference internal" href="../faq.html#faq-task-routing"><span class="std std-ref">Can I send some tasks to only some servers?</span></a> in the
<a class="reference internal" href="../faq.html#faq"><span class="std std-ref">FAQ</span></a> for more information.</p>
</li>
<li><p class="first">Task errors are now logged using log level <cite>ERROR</cite> instead of <cite>INFO</cite>,
and stack-traces are dumped. Thanks to Grégoire Cachet.</p>
</li>
<li><p class="first">Make every new worker process re-establish it’s Django DB connection,
this solving the “MySQL connection died?” exceptions.
Thanks to Vitaly Babiy and Jirka Vejrazka.</p>
</li>
<li><p class="first"><strong>IMPORTANT</strong> Now using pickle to encode task arguments. This means you
now can pass complex Python objects to tasks as arguments.</p>
</li>
<li><p class="first">Removed dependency to <cite>yadayada</cite>.</p>
</li>
<li><p class="first">Added a FAQ, see <cite>docs/faq.rst</cite>.</p>
</li>
<li><p class="first">Now converts any Unicode keys in task <cite>kwargs</cite> to regular strings.
Thanks Vitaly Babiy.</p>
</li>
<li><p class="first">Renamed the <cite>TaskDaemon</cite> to <cite>WorkController</cite>.</p>
</li>
<li><p class="first"><cite>celery.datastructures.TaskProcessQueue</cite> is now renamed to
<cite>celery.pool.TaskPool</cite>.</p>
</li>
<li><p class="first">The pool algorithm has been refactored for greater performance and
stability.</p>
</li>
</ul>
</div>
<div class="section" id="version-0-2-0">
<span id="id30"></span><h2><a class="toc-backref" href="#id82">0.2.0</a><a class="headerlink" href="#version-0-2-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-20 05:14 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Final release of 0.2.0</li>
<li>Compatible with carrot version 0.4.0.</li>
<li>Fixes some syntax errors related to fetching results
from the database backend.</li>
</ul>
</div>
<div class="section" id="pre3">
<span id="version-0-2-0-pre3"></span><h2><a class="toc-backref" href="#id83">0.2.0-pre3</a><a class="headerlink" href="#pre3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-20 05:14 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><em>Internal release</em>. Improved handling of unpickleable exceptions,
<cite>get_result</cite> now tries to recreate something looking like the
original exception.</li>
</ul>
</div>
<div class="section" id="pre2">
<span id="version-0-2-0-pre2"></span><h2><a class="toc-backref" href="#id84">0.2.0-pre2</a><a class="headerlink" href="#pre2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-20 01:56 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Now handles unpickleable exceptions (like the dynamically generated
subclasses of <cite>django.core.exception.MultipleObjectsReturned</cite>).</li>
</ul>
</div>
<div class="section" id="pre1">
<span id="version-0-2-0-pre1"></span><h2><a class="toc-backref" href="#id85">0.2.0-pre1</a><a class="headerlink" href="#pre1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-20 12:33 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>It’s getting quite stable, with a lot of new features, so bump
version to 0.2. This is a pre-release.</li>
<li><cite>celery.task.mark_as_read()</cite> and <cite>celery.task.mark_as_failure()</cite> has
been removed. Use <cite>celery.backends.default_backend.mark_as_read()</cite>,
and <cite>celery.backends.default_backend.mark_as_failure()</cite> instead.</li>
</ul>
</div>
<div class="section" id="version-0-1-15">
<span id="id31"></span><h2><a class="toc-backref" href="#id86">0.1.15</a><a class="headerlink" href="#version-0-1-15" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-19 04:13 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>The Celery daemon was leaking AMQP connections, this should be fixed,
if you have any problems with too many files open (like <cite>emfile</cite>
errors in <cite>rabbit.log</cite>, please contact us!</li>
</ul>
</div>
<div class="section" id="version-0-1-14">
<span id="id32"></span><h2><a class="toc-backref" href="#id87">0.1.14</a><a class="headerlink" href="#version-0-1-14" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-19 01:08 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixed a syntax error in the <cite>TaskSet</cite> class (no such variable
<cite>TimeOutError</cite>).</li>
</ul>
</div>
<div class="section" id="version-0-1-13">
<span id="id33"></span><h2><a class="toc-backref" href="#id88">0.1.13</a><a class="headerlink" href="#version-0-1-13" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-19 12:36 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Forgot to add <cite>yadayada</cite> to install requirements.</p>
</li>
<li><p class="first">Now deletes all expired task results, not just those marked as done.</p>
</li>
<li><p class="first">Able to load the Tokyo Tyrant backend class without django
configuration, can specify tyrant settings directly in the class
constructor.</p>
</li>
<li><p class="first">Improved API documentation</p>
</li>
<li><p class="first">Now using the Sphinx documentation system, you can build
the html documentation by doing:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> docs
<span class="gp">$</span> make html
</pre></div>
</div>
</div></blockquote>
<p>and the result will be in <cite>docs/_build/html</cite>.</p>
</li>
</ul>
</div>
<div class="section" id="version-0-1-12">
<span id="id34"></span><h2><a class="toc-backref" href="#id89">0.1.12</a><a class="headerlink" href="#version-0-1-12" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-18 04:38 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first"><cite>delay_task()</cite> etc. now returns <cite>celery.task.AsyncResult</cite> object,
which lets you check the result and any failure that might’ve
happened. It kind of works like the <cite>multiprocessing.AsyncResult</cite>
class returned by <cite>multiprocessing.Pool.map_async</cite>.</p>
</li>
<li><p class="first">Added <code class="docutils literal notranslate"><span class="pre">dmap()</span></code> and <code class="docutils literal notranslate"><span class="pre">dmap_async()</span></code>. This works like the
<cite>multiprocessing.Pool</cite> versions except they’re tasks
distributed to the Celery server. Example:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task</span> <span class="kn">import</span> <span class="n">dmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">operator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmap</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task</span> <span class="kn">import</span> <span class="n">dmap_async</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">operator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dmap_async</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">result</span>
<span class="go">[4, 8, 16]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Refactored the task meta-data cache and database backends, and added
a new backend for Tokyo Tyrant. You can set the backend in your django
settings file.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;database&#39;</span><span class="p">;</span> <span class="c1"># Uses the database</span>
<span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;cache&#39;</span><span class="p">;</span> <span class="c1"># Uses the django cache framework</span>
<span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;tyrant&#39;</span><span class="p">;</span> <span class="c1"># Uses Tokyo Tyrant</span>
<span class="n">TT_HOST</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span> <span class="c1"># Hostname for the Tokyo Tyrant server.</span>
<span class="n">TT_PORT</span> <span class="o">=</span> <span class="mi">6657</span><span class="p">;</span> <span class="c1"># Port of the Tokyo Tyrant server.</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-0-1-11">
<span id="id35"></span><h2><a class="toc-backref" href="#id90">0.1.11</a><a class="headerlink" href="#version-0-1-11" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-12 02:08 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>The logging system was leaking file descriptors, resulting in
servers stopping with the EMFILES (too many open files) error (fixed).</li>
</ul>
</div>
<div class="section" id="version-0-1-10">
<span id="id36"></span><h2><a class="toc-backref" href="#id91">0.1.10</a><a class="headerlink" href="#version-0-1-10" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-11 12:46 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Tasks now supports both positional arguments and keyword arguments.</li>
<li>Requires carrot 0.3.8.</li>
<li>The daemon now tries to reconnect if the connection is lost.</li>
</ul>
</div>
<div class="section" id="version-0-1-8">
<span id="id37"></span><h2><a class="toc-backref" href="#id92">0.1.8</a><a class="headerlink" href="#version-0-1-8" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-05-07 12:27 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Better test coverage</li>
<li>More documentation</li>
<li>The worker doesn’t emit <cite>Queue is empty</cite> message if
<cite>settings.CELERYD_EMPTY_MSG_EMIT_EVERY</cite> is 0.</li>
</ul>
</div>
<div class="section" id="version-0-1-7">
<span id="id38"></span><h2><a class="toc-backref" href="#id93">0.1.7</a><a class="headerlink" href="#version-0-1-7" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-04-30 01:50 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Added some unit tests</li>
<li>Can now use the database for task meta-data (like if the task has
been executed or not). Set <cite>settings.CELERY_TASK_META</cite></li>
<li>Can now run <cite>python setup.py test</cite> to run the unit tests from
within the <cite>tests</cite> project.</li>
<li>Can set the AMQP exchange/routing key/queue using
<cite>settings.CELERY_AMQP_EXCHANGE</cite>, <cite>settings.CELERY_AMQP_ROUTING_KEY</cite>,
and <cite>settings.CELERY_AMQP_CONSUMER_QUEUE</cite>.</li>
</ul>
</div>
<div class="section" id="version-0-1-6">
<span id="id39"></span><h2><a class="toc-backref" href="#id94">0.1.6</a><a class="headerlink" href="#version-0-1-6" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-04-28 02:13 p.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Introducing <cite>TaskSet</cite>. A set of subtasks is executed and you can
find out how many, or if all them, are done (excellent for progress
bars and such)</p>
</li>
<li><p class="first">Now catches all exceptions when running <cite>Task.__call__</cite>, so the
daemon doesn’t die. This doesn’t happen for pure functions yet, only
<cite>Task</cite> classes.</p>
</li>
<li><p class="first"><cite>autodiscover()</cite> now works with zipped eggs.</p>
</li>
<li><p class="first">Worker: Now adds current working directory to <cite>sys.path</cite> for
convenience.</p>
</li>
<li><p class="first">The <cite>run_every</cite> attribute of <cite>PeriodicTask</cite> classes can now be a
<cite>datetime.timedelta()</cite> object.</p>
</li>
<li><p class="first">Worker: You can now set the <cite>DJANGO_PROJECT_DIR</cite> variable
for the worker and it will add that to <cite>sys.path</cite> for easy launching.</p>
</li>
<li><p class="first">Can now check if a task has been executed or not via HTTP.</p>
</li>
<li><p class="first">You can do this by including the Celery <cite>urls.py</cite> into your project,</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^celery/$&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;celery.urls&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>then visiting the following URL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>http://mysite/celery/$task_id/done/
</pre></div>
</div>
<p>this will return a JSON dictionary, for example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;task&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;TASK_ID&quot;</span><span class="p">,</span> <span class="nt">&quot;executed&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p class="first"><cite>delay_task</cite> now returns string id, not <cite>uuid.UUID</cite> instance.</p>
</li>
<li><p class="first">Now has <cite>PeriodicTasks</cite>, to have <cite>cron</cite> like functionality.</p>
</li>
<li><p class="first">Project changed name from <cite>crunchy</cite> to <cite>celery</cite>. The details of
the name change request is in <cite>docs/name_change_request.txt</cite>.</p>
</li>
</ul>
</div>
<div class="section" id="version-0-1-0">
<span id="id40"></span><h2><a class="toc-backref" href="#id95">0.1.0</a><a class="headerlink" href="#version-0-1-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2009-04-24 11:28 a.m. CET</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Initial release</li>
</ul>
<p>Sphinx started sucking by removing images from _static, so we need to add
them here into actual content to ensure they are included :-(</p>
<img alt="../_images/celery-banner.png" src="../_images/celery-banner.png" />
<img alt="../_images/celery-banner-small.png" src="../_images/celery-banner-small.png" />
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/celery_512.png" alt="Logo"/>
            </a></p><iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
<div id="donate">
    <b>Please help support this community project with a donation:</b>
    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
    <input type="hidden" name="cmd" value="_s-xclick">
    <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHTwYJKoZIhvcNAQcEoIIHQDCCBzwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYA2+c723xlntHKQYQR9yn9BEtUhDoUUlnOqhniqvNMWB4k2R0JpVkrNSu5JCbdjNOqDXKHoRfIWe3HXJJMPZBJKFMD5Izprb6xEZlTGaWnlrGXFfkdBaILQQgWYqV0DnuNmtDXCvfYmyu0p1K04wLjAJ1ufnBSP1UaS6BTcoIOOuTELMAkGBSsOAwIaBQAwgcwGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIFg/2qPwa7UCAgah20QLIllcp0VHazYo2C9h8c6gn8MTcTnpW0WFXhz9ylc/i5dCXabkrrLBBfg8NygAuvYRr4k1zdC0AJIgsV/6rSAhehabRvjRDH2EZ8OieqHfIPfkAcTm+JqbS6Z27lXkebYPnJzhkZxW7+ZC6hU/H40JFXChTag8lhqJfZELiOZLWxxilj2mkwlkdMx1YL6lcPAA7ajpAwjsnJYd/9VxLA6MDmcOu+TKgggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xNTEyMTAxOTEzMzBaMCMGCSqGSIb3DQEJBDEWBBTUno4gI/mmaVaGVpgB/CWwQd3DeDANBgkqhkiG9w0BAQEFAASBgFmZ1j1Ss/FNl/JRIOakhBJEdm2KGLH0d2ewwTYIgIkEKSdc5Rg2/2xFS/dglcs5Te3R2GzaqjGlNSKldsk/MgZP/BudpHAASQ09hrfDy5TaBlRRl1Yu0WzGBKcVm/WRh0v2TVV8vBHVGiJD+aY5epgRXXI/XUKD0bp8tVV1T7LS-----END PKCS7-----
    ">
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>
</div>
  <h4>Previous topic</h4>
  <p class="topless"><a href="changelog-2.0.html"
                        title="previous chapter">Change history for Celery 2.0</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../glossary.html"
                        title="next chapter">Glossary</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/history/changelog-1.0.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../glossary.html" title="Glossary"
             >next</a> |</li>
        <li class="right" >
          <a href="changelog-2.0.html" title="Change history for Celery 2.0"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Celery 4.2.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >History</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> 2009-2017, Ask Solem &amp; contributors.
    </div>
  </body>
</html>