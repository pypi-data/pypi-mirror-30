

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Introduction to the EQcorrscan package &mdash; EQcorrscan 0.2.7-dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/EQcorrscan_logo.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="EQcorrscan 0.2.7-dev documentation" href="index.html"/>
        <link rel="next" title="2. What’s new" href="updates.html"/>
        <link rel="prev" title="EQcorrscan" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> EQcorrscan
          

          
            
            <img src="_static/EQcorrscan_logo.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Introduction to the EQcorrscan package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#why-eqcorrscan">1.1. Why EQcorrscan?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-updated-for-version-0-2-7">1.2. Installation - Updated for version 0.2.7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#non-python-dependancies-without-conda-ubuntu">1.2.1. Non-Python dependancies (without conda): Ubuntu:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-python-dependancies-osx">1.2.2. Non-Python dependancies: OSX:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#non-python-dependancies-windows">1.2.3. Non-Python dependancies: Windows:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eqcorrscan-install-via-pip">1.2.4. EQcorrscan install via pip:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#supported-environments">1.3. Supported environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">1.4. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-tests">1.5. Running tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="updates.html">2. What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">EQcorrscan tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">3. Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">4. Utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EQcorrscan</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>1. Introduction to the EQcorrscan package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-to-the-eqcorrscan-package">
<h1>1. Introduction to the EQcorrscan package<a class="headerlink" href="#introduction-to-the-eqcorrscan-package" title="Permalink to this headline">¶</a></h1>
<p>This document is designed to give you an overview of the capabilities and
implementation of the EQcorrscan Python package.</p>
<div class="section" id="why-eqcorrscan">
<h2>1.1. Why EQcorrscan?<a class="headerlink" href="#why-eqcorrscan" title="Permalink to this headline">¶</a></h2>
<p>EQcorrscan is designed to compute detections of earthquakes, or any seismic signal
(explosions work <em>really</em> well) using more advanced routines than standard
amplitude-ratio methods.</p>
<p>This package was originally based around a matched-filter detection routine
which works by comparing templates with continuous data.
The main benefit of EQcorrscan’s matched-filter routine is the level of parallel
processing that can be achieved.  EQcorrscan will run on anything from a 1GB RAM
single-board computer to a multi-hundred-GB RAM, thousand CPU high-performance
computer.  Because the internals of EQcorrscan’s matched-filter routine scale
reasonably well, the developers have observed speed-ups of 150x (from 2 months
to 10 hours) by migrating from a small cluster
to a large one (for a 6.5 year long continuous dataset and 800 templates).</p>
<p>The authors of EQcorrscan foresee this project as an open repository for the
development of software for the detection and analysis of repeating and
near-repeating earthquakes.  This repository will continue to grow and develop
and any and all help/criticism will be appreciated.</p>
<p>There are a lot of things that could be added to this project - if you want to
get involved the best place to start, and the most valuable thing for your
understanding, and for the health of this package would be to contribute tests and
documentation.</p>
</div>
<div class="section" id="installation-updated-for-version-0-2-7">
<h2>1.2. Installation - Updated for version 0.2.7<a class="headerlink" href="#installation-updated-for-version-0-2-7" title="Permalink to this headline">¶</a></h2>
<p>In general we recommend users to install EQcorrscan in a virtual environment,
<a href="https://conda.io/docs/" target="_blank">conda</a> will simplify your install greatly (install instuction for anaconda
or miniconda are here: <a href="https://conda.io/docs/user-guide/install/index.html#installing-conda-on-a-system-that-has-other-python-installations-or-packages" target="_blank">conda installation</a>) - we recommend creating a conda
environment with the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda config --add channels conda-forge
conda create -n eqcorrscan colorama numpy scipy matplotlib obspy bottleneck pyproj
<span class="c1"># If using bash run:</span>
<span class="nb">source</span> activate eqcorrscan
<span class="c1"># If not you should get away with:</span>
activate eqcorrscan
</pre></div>
</div>
<p>To then install EQcorrscan you can simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install eqcorrscan
</pre></div>
</div>
<p>And you are done! Otherwise, if you want to install via pip then the following applies:</p>
<div class="section" id="non-python-dependancies-without-conda-ubuntu">
<h3>1.2.1. Non-Python dependancies (without conda): Ubuntu:<a class="headerlink" href="#non-python-dependancies-without-conda-ubuntu" title="Permalink to this headline">¶</a></h3>
<p>Prior to installing the python routines you will need to install the fftw
library.  On linux use apt (or your default package manager - note you may need
sudo access):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt-get install libfftw3-dev
</pre></div>
</div>
</div>
<div class="section" id="non-python-dependancies-osx">
<h3>1.2.2. Non-Python dependancies: OSX:<a class="headerlink" href="#non-python-dependancies-osx" title="Permalink to this headline">¶</a></h3>
<p>For OS-X systems install fftw from conda, available via the menpo channel:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install -c menpo fftw
</pre></div>
</div>
<p>On OSX you will have to ensure that the gcc used for install is an actual gcc,
not clang. To do this you should also install gcc into your conda environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda install gcc
</pre></div>
</div>
<p>Note that you can install fftw and gcc from other sources, however, we know there
is an issue with homebrew gcc-4.9 (but not with macports gcc-4.9) - other
gcc versions tested do work however.</p>
</div>
<div class="section" id="non-python-dependancies-windows">
<h3>1.2.3. Non-Python dependancies: Windows:<a class="headerlink" href="#non-python-dependancies-windows" title="Permalink to this headline">¶</a></h3>
<p>For Windows systems you should follow the instructions on the <a href="http://www.fftw.org/install/windows.html" target="_blank">fftw-windows install</a>
page and use the pre-compiled dynamic libraries. These should be installed
somewhere on your system path, or the install location added to your path.
The correlation routines use openMP for parallel workflows, however, some aspects
of this run into issues with version of MSVC &lt; 10.0 (due to old C standards being
used), as such, by default, the correlation routines are compiled as serial
workflows on windows.  If you have a need for this threading in windows please
get in touch with the developers.</p>
</div>
<div class="section" id="eqcorrscan-install-via-pip">
<h3>1.2.4. EQcorrscan install via pip:<a class="headerlink" href="#eqcorrscan-install-via-pip" title="Permalink to this headline">¶</a></h3>
<p>Once you have installed fftw the EQcorrscan install should be as simple as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install eqcorrscan
</pre></div>
</div>
<p>Note you may have issues with these installs if you don’t have numpy installed: but if
you don’t have numpy installed then you have bigger issues…</p>
<p>If you plan to run the <em>bright_lights</em> or generating a synthetic grid of
templates you will need to have grid csv files, which the authors have
previously used NonLinLoc to generate.  This is not provided here and should
be sourced from <a href="http://alomax.free.fr/nlloc/" target="_blank">NonLinLoc</a>. This will provide
the Grid2Time routine which is required to set-up a lag-time grid for your
velocity model.  You should read the NonLinLoc documentation for more
information regarding how this process works and the input files you are
required to give.</p>
</div>
</div>
<div class="section" id="supported-environments">
<h2>1.3. Supported environments<a class="headerlink" href="#supported-environments" title="Permalink to this headline">¶</a></h2>
<p>We support Linux, OSX and Windows environments running Python 2.7, 3.4 and 3.5.
We don’t run our tests on other versions of Python so you might have some issues
with other Python 3.x series, if you do, let us know.</p>
<p>We do <strong>not</strong> support Python 2.6.</p>
</div>
<div class="section" id="functions">
<h2>1.4. Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>This package is divided into sub-directories of <a class="reference internal" href="core.html"><span class="doc">core</span></a> and <a class="reference internal" href="utils.html"><span class="doc">utils</span></a>.  The
<a class="reference internal" href="utils.html"><span class="doc">utils</span></a> directory contains simple functions for integration with <a href="http://seisan.info/" target="_blank">Seisan</a>,
these are in the <span class="xref std std-doc">sfile_util</span>
module and functions therein which are essentially barebones and do not have the
full functionality that seisan can handle.  <a class="reference internal" href="utils.html"><span class="doc">utils</span></a> also contains a simple
peak-finding algorithm <a class="reference internal" href="submodules/utils.findpeaks.html"><span class="doc">findpeaks</span></a> which looks for peaks within noisy data
above a certain threshold and within windows.</p>
<p>Many other functions have been
added to this module to handle the analysis of repeating and near-repeating
earthquakes, including stacking routines, clustering algorithms, magnitude
calculation both by amplitude picking and by singular value decomposition.  I
recommend you take a look in here to see if any of it is useful.  There are also
some plotting routines that make handling large datasets a little simpler.  Most
recently I have added a simple synthetic seismogram generator, which is currently
my main project focus.</p>
<p>Since earlier versions the <a class="reference internal" href="core.html"><span class="doc">core</span></a> modules have moved away from using parameter
files, and instead rely on explicit argument calls.  The parameter files are
still included by not documented here (see inside the par files), and remain
useful when generating batch scripts (see the scripts in the github repo).</p>
<p>Within <a class="reference internal" href="core.html"><span class="doc">core</span></a> you will find the core routines to generate templates,
(<a class="reference internal" href="submodules/core.template_gen.html"><span class="doc">template_gen</span></a>) search for likely templates
(<a class="reference internal" href="submodules/core.bright_lights.html"><span class="doc">bright_lights</span></a>) and
compute cross-channel correlations from these templates (<a class="reference internal" href="submodules/core.match_filter.html"><span class="doc">match_filter</span></a>).  The
bright_lights and match_filter submodules have been designed with parallel
computing in mind, to the extent that the more cores and machines you have
running them the better.  These rely on the python multiprocessing module to
handle parallelisation at lower-levels.  You can also do some ‘brute-force’
parallelisation on a day level when computing detections over multiple days.
I tend to run one day per node of a cluster computer, with each day running
templates in parallel.</p>
</div>
<div class="section" id="running-tests">
<h2>1.5. Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>One of the main goals of EQcorrscan is to improve reliability and reproducibility
of earthquake detection.  To this end, EQcorrscan has a moderate test-base (you
can check how much of our codebase if tested by looked at the badges in the
<a href="https://github.com/eqcorrscan/EQcorrscan" target="_blank">github</a> repository).  You can also run these tests yourself locally to ensure
that everything runs as you would expect in your environment.  Although every
effort has been made to ensure these tests run smoothly on all supported environments
(using the ci bots), if you do find any issues, please let us know on the
<a href="https://github.com/eqcorrscan/EQcorrscan" target="_blank">github</a> page.</p>
<p>To run the tests you will need to have pytest installed along with a couple of
extras (pytest-pep8 and pytest-cov).  These can be installed by pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pytest pytest-pep8 pytest-cov
</pre></div>
</div>
<p>You will also need to have a clone of the github repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/eqcorrscan/EQcorrscan.git
</pre></div>
</div>
<p>You can then run the tests from within the repository directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python setup.py <span class="nb">test</span>
</pre></div>
</div>
<p>Tests will take about half an hour to run (as of v.0.1.4) and will provide
a coverage report at the end and notify you of any failures.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="updates.html" class="btn btn-neutral float-right" title="2. What’s new" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="EQcorrscan" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016: EQcorrscan developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.7-dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>