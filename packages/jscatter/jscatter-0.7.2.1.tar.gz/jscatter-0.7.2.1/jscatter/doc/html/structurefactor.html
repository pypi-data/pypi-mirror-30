
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>7. structurefactor (sf) &#8212; jscatter 0.7.2.1 documentation</title>
    <link rel="stylesheet" href="_static//default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.7.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/Jscatter-32x-32.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. dynamic" href="dynamic.html" />
    <link rel="prev" title="6. formfactor (ff)" href="formfactor.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dynamic.html" title="8. dynamic"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="formfactor.html" title="6. formfactor (ff)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.7.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="structurefactor-sf">
<h1>7. structurefactor (sf)<a class="headerlink" href="#structurefactor-sf" title="Permalink to this headline">¶</a></h1>
<p>Structure factors and directly related functions for scattering
related to interaction potentials between particles.</p>
<p>Return values are dataArrays were useful.</p>
<p>To get only Y values use .Y</p>
<p>For RMSA an improved algorithm is used based on the original idea described in <a href="#id36"><span class="problematic" id="id1">[1]_</span></a> (see Notes in RMSA).</p>
<div class="section" id="structure-factors">
<h2>7.1. Structure Factors<a class="headerlink" href="#structure-factors" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.RMSA" title="jscatter.structurefactor.RMSA"><code class="xref py py-obj docutils literal"><span class="pre">RMSA</span></code></a>(q,&nbsp;R,&nbsp;scl,&nbsp;gamma[,&nbsp;molarity,&nbsp;eta,&nbsp;useHP])</td>
<td>Structure factor for a screened coulomb interaction in rescaled mean spherical approximation (RMSA).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.PercusYevick" title="jscatter.structurefactor.PercusYevick"><code class="xref py py-obj docutils literal"><span class="pre">PercusYevick</span></code></a>(q,&nbsp;R[,&nbsp;molarity,&nbsp;eta])</td>
<td>The Percus-Yevick structure factor.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.PercusYevick1D" title="jscatter.structurefactor.PercusYevick1D"><code class="xref py py-obj docutils literal"><span class="pre">PercusYevick1D</span></code></a>(q[,&nbsp;R,&nbsp;eta])</td>
<td>The PercusYevick structure factor in 1D</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.PercusYevick2D" title="jscatter.structurefactor.PercusYevick2D"><code class="xref py py-obj docutils literal"><span class="pre">PercusYevick2D</span></code></a>(q[,&nbsp;R,&nbsp;eta,&nbsp;a])</td>
<td>The PercusYevick structure factor in 2D</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.stickyHardSphere" title="jscatter.structurefactor.stickyHardSphere"><code class="xref py py-obj docutils literal"><span class="pre">stickyHardSphere</span></code></a>(q,&nbsp;R,&nbsp;width,&nbsp;depth[,&nbsp;…])</td>
<td>Structure factor of a square well potential with depth and width (sticky hard spheres).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.adhesiveHardSphere" title="jscatter.structurefactor.adhesiveHardSphere"><code class="xref py py-obj docutils literal"><span class="pre">adhesiveHardSphere</span></code></a>(q,&nbsp;R,&nbsp;tau,&nbsp;delta[,&nbsp;…])</td>
<td>structure factor of a adhesive hard sphere potential (a square well potential)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.criticalSystem" title="jscatter.structurefactor.criticalSystem"><code class="xref py py-obj docutils literal"><span class="pre">criticalSystem</span></code></a>(q,&nbsp;corrlength,&nbsp;isothermalcompress)</td>
<td>structure factor of a critical system should take the Ornstein-Zernike form</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hydrodynamics">
<h2>7.2. Hydrodynamics<a class="headerlink" href="#hydrodynamics" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.hydrodynamicFunct" title="jscatter.structurefactor.hydrodynamicFunct"><code class="xref py py-obj docutils literal"><span class="pre">hydrodynamicFunct</span></code></a>(wavevector,&nbsp;Rh,&nbsp;molarity)</td>
<td>Hydrodynamic function H(Q) from hydrodynamic pair interaction of spheres in suspension.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pair-correlation">
<h2>7.3. Pair Correlation<a class="headerlink" href="#pair-correlation" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.sq2gr" title="jscatter.structurefactor.sq2gr"><code class="xref py py-obj docutils literal"><span class="pre">sq2gr</span></code></a>(Sq,&nbsp;R[,&nbsp;interpolatefactor])</td>
<td>Radial distribution function g(r) from structure factor Sq.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="lattice">
<h2>7.4. Lattice<a class="headerlink" href="#lattice" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.bravaisLattice" title="jscatter.structurefactor.bravaisLattice"><code class="xref py py-obj docutils literal"><span class="pre">bravaisLattice</span></code></a>(latticeVectors,&nbsp;size)</td>
<td>Create a bravais lattice.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.scLattice" title="jscatter.structurefactor.scLattice"><code class="xref py py-obj docutils literal"><span class="pre">scLattice</span></code></a>(abc,&nbsp;size)</td>
<td>Simple Cubic lattice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.bccLattice" title="jscatter.structurefactor.bccLattice"><code class="xref py py-obj docutils literal"><span class="pre">bccLattice</span></code></a>(abc,&nbsp;size[,&nbsp;b])</td>
<td>Body centered cubic lattice.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.fccLattice" title="jscatter.structurefactor.fccLattice"><code class="xref py py-obj docutils literal"><span class="pre">fccLattice</span></code></a>(abc,&nbsp;size)</td>
<td>Face centered cubic lattice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.hexLattice" title="jscatter.structurefactor.hexLattice"><code class="xref py py-obj docutils literal"><span class="pre">hexLattice</span></code></a>(ab,&nbsp;c,&nbsp;size)</td>
<td>Hexagonal lattice.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.hcpLattice" title="jscatter.structurefactor.hcpLattice"><code class="xref py py-obj docutils literal"><span class="pre">hcpLattice</span></code></a>(ab,&nbsp;size)</td>
<td>Hexagonal closed packed lattice.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice" title="jscatter.structurefactor.rhombicLattice"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice</span></code></a>(latticeVectors,&nbsp;size[,&nbsp;…])</td>
<td>Create a rhombic lattice.</td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.X" title="jscatter.structurefactor.rhombicLattice.X"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.X</span></code></a></td>
<td>X coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.Y" title="jscatter.structurefactor.rhombicLattice.Y"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.Y</span></code></a></td>
<td>Y coordinates</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.Z" title="jscatter.structurefactor.rhombicLattice.Z"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.Z</span></code></a></td>
<td>Z coordinates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.b" title="jscatter.structurefactor.rhombicLattice.b"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.b</span></code></a></td>
<td>Scattering length</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.filter" title="jscatter.structurefactor.rhombicLattice.filter"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.filter</span></code></a>(funktion)</td>
<td>Filter lattice points according to a function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.centerOfMass" title="jscatter.structurefactor.rhombicLattice.centerOfMass"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.centerOfMass</span></code></a>()</td>
<td>CenterOf mass</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.planeSide" title="jscatter.structurefactor.rhombicLattice.planeSide"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.planeSide</span></code></a>(vector[,&nbsp;invert])</td>
<td>Select points on one side of a plane.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.move" title="jscatter.structurefactor.rhombicLattice.move"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.move</span></code></a>(vector)</td>
<td>Move all points by vector.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.inSphere" title="jscatter.structurefactor.rhombicLattice.inSphere"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.inSphere</span></code></a>(R)</td>
<td>Choose lattice points in sphere</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.show" title="jscatter.structurefactor.rhombicLattice.show"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.show</span></code></a>()</td>
<td>Show the lattice in matplotlib.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jscatter.structurefactor.rhombicLattice.limit2Cube" title="jscatter.structurefactor.rhombicLattice.limit2Cube"><code class="xref py py-obj docutils literal"><span class="pre">rhombicLattice.limit2Cube</span></code></a>(a,&nbsp;b,&nbsp;c)</td>
<td>Cut at cube with edges at</td>
</tr>
</tbody>
</table>
<p>Lattice objects describing a lattice of points.</p>
<p>Included are methods to select sublattices as cubes, sphere or side of planes.</p>
<p>The small angle scattering can is calculated by js.ff.cloudScattering.</p>
<p>The same method can be used to calculate the wide angle scattering with bragg peaks
using larger scattering vectors.</p>
<p><strong>Examples</strong></p>
<p>A hollow sphere cut to a wedge.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">grid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">inSphere</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">inSphere</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">limit2Cube</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">planeSide</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">planeSide</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">grid</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ffe</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">nFib</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ffe</span><span class="p">)</span>
</pre></div>
</div>
<p>A comparison of sc, bcc and fcc nanoparticles (takes a while )</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">1500</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">3</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">800</span><span class="n">j</span><span class="p">]</span>
<span class="n">cubelength</span><span class="o">=</span><span class="mf">1.5</span>
<span class="n">N</span><span class="o">=</span><span class="mi">8</span>
<span class="n">grid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">scLattice</span><span class="p">(</span><span class="n">cubelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">sc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">nFib</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">grid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="n">cubelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">bcc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">nFib</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">grid</span><span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="n">cubelength</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">fcc</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">cloudScattering</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span><span class="n">nFib</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># smooth with Gaussian to include instrument resolution</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;sc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bcc</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">bcc</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;bcc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fcc</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">js</span><span class="o">.</span><span class="n">formel</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">fcc</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;fcc&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison sc, bcc, fcc lattice for a nano cube&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;I(Q)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Q / A\S-1&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;cube formfactor&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;Bragg peaks&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">charsize</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<span class="target" id="module-jscatter.structurefactor"></span><p>Structure factors and directly related functions for scattering
related to interaction potentials between particles.</p>
<p>Return values are dataArrays were useful.</p>
<p>To get only Y values use .Y</p>
<p>For RMSA an improved algorithm is used based on the original idea described in <a href="#id37"><span class="problematic" id="id2">[1]_</span></a> (see Notes in RMSA).</p>
<dl class="function">
<dt id="jscatter.structurefactor.PercusYevick">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">PercusYevick</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>molarity=None</em>, <em>eta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#PercusYevick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.PercusYevick" title="Permalink to this definition">¶</a></dt>
<dd><p>The Percus-Yevick structure factor.</p>
<p>Structure factor for the potential U(r)= (inf for 0&lt;r&lt;R) and (0 for R&lt;r).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>scattering vector; units 1/(R[unit])</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>Radius of the object</p>
</div></blockquote>
<p><strong>eta</strong> : float</p>
<blockquote>
<div><p>volume fraction as eta=4/3*pi*R**3*n  with number density n in units or R</p>
</div></blockquote>
<p><strong>molarity</strong> : float</p>
<blockquote>
<div><p>number density in mol/l and defines q and R units to 1/nm and nm to be correct 
preferred over eta if both given</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataArray</p>
<blockquote class="last">
<div><p>structure factor for given q</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Problem is given in <a class="reference internal" href="#r221" id="id3">[R221]</a>; solution in <a class="reference internal" href="#r222" id="id4">[R222]</a> and best description of the solution is in <a class="reference internal" href="#r223" id="id5">[R223]</a>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r221" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R221]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> <ol class="last upperalpha simple" start="10">
<li><ol class="first upperalpha" start="11">
<li>Percus and G. J. Yevick, Phys. Rev. 110, 1 (1958).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r222" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R222]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> <ol class="last upperalpha simple" start="13">
<li><ol class="first upperalpha" start="19">
<li>Wertheim, Phys. Rev. Lett. 10, 321 (1963).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r223" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R223]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> <ol class="last upperalpha simple" start="4">
<li><ol class="first upperalpha" start="10">
<li>Kinning and E. L. Thomas, Macromolecules 17, 1712 (1984).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.PercusYevick1D">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">PercusYevick1D</code><span class="sig-paren">(</span><em>q</em>, <em>R=1</em>, <em>eta=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#PercusYevick1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.PercusYevick1D" title="Permalink to this definition">¶</a></dt>
<dd><p>The PercusYevick structure factor in 1D</p>
<p>Structure factor for the potential U(r)= (inf for 0&lt;r&lt;R) and (0 for R&lt;r).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>scattering vector; units 1/(R[unit])</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>Radius of the object</p>
</div></blockquote>
<p><strong>eta</strong> : float</p>
<blockquote>
<div><p>packing fraction as eta=2*R*n  with number density n</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataArray</p>
<p class="last">[q,structure factor]</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<table class="docutils citation" frame="void" id="r224" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R224]</td><td>Exact solution of the Percus-Yevick equation for a hard-core fluid in odd dimensions
Leutheusser E  Physica A 1984 vol: 127 (3) pp: 667-676</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r225" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R225]</td><td>On the equivalence of the Ornstein–Zernike relation and Baxter’s relations for a one-dimensional simple fluid
Chen M Journal of Mathematical Physics 1975 vol: 16 (5) pp: 1150</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.PercusYevick2D">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">PercusYevick2D</code><span class="sig-paren">(</span><em>q</em>, <em>R=1</em>, <em>eta=0.1</em>, <em>a=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#PercusYevick2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.PercusYevick2D" title="Permalink to this definition">¶</a></dt>
<dd><p>The PercusYevick structure factor in 2D</p>
<p>Structure factor for the potential U(r)= (inf for 0&lt;r&lt;R) and (0 for R&lt;r).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>scattering vector; units 1/(R[unit])</p>
</div></blockquote>
<p><strong>R</strong> : float, default 1</p>
<blockquote>
<div><p>Radius of the object</p>
</div></blockquote>
<p><strong>eta</strong> : float, default 0.1</p>
<blockquote>
<div><p>packing fraction as eta=pi*R**2*n  with number density n
maximum hexagonal closed = (np.pi*R**2)/(3/2.*3**0.5*a**2)
Rmax=a*3**0.5/2. with max packing of 0.9069</p>
</div></blockquote>
<p><strong>a</strong> : float, default None</p>
<blockquote>
<div><p>hexagonal lattice constant
if not None the packing fraction in hexagonal lattice
as eta=(np.pi*R**2)/(3/2.*3**0.5*a**2) is used</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dataArary</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r226" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[R226]</a></td><td>Free-energy model for the inhomogeneous hard-sphere fluid in D dimensions:
Structure factors for the hard-disk (D=2) mixtures in simple explicit form
Yaakov Rosenfeld Phys. Rev. A 42, 5978</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.RMSA">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">RMSA</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>scl</em>, <em>gamma</em>, <em>molarity=None</em>, <em>eta=None</em>, <em>useHP=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#RMSA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.RMSA" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure factor for a screened coulomb interaction in rescaled mean spherical approximation (RMSA).</p>
<p>Structure factor according to Hayter-Penfold <a class="reference internal" href="#r227" id="id10">[R227]</a> <a class="reference internal" href="#r228" id="id11">[R228]</a> .
Consider a scattering system consisting of macro ions, counter ions  and solvent.
Here an improved algorithm is used based on the original idea described in <a class="reference internal" href="#r227" id="id12">[R227]</a> (see Notes).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>Scattering vector; units 1/nm</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>Radius of the object; units nm</p>
</div></blockquote>
<p><strong>molarity</strong> : float</p>
<blockquote>
<div><p>Number density n in units mol/l. Overides eta, if both given.</p>
</div></blockquote>
<p><strong>scl</strong> : float&gt;0</p>
<blockquote>
<div><p>Screening length; units nm; negative values evaluate to scl=0.</p>
</div></blockquote>
<p><strong>gamma</strong> : float</p>
<blockquote>
<div><div class="line-block">
<div class="line">contact potential; units kT</div>
<div class="line">gamma=Zm/(pi*e0*e*R*(2+k*R))</div>
<div class="line-block">
<div class="line">Zm = Z* effective surface charge</div>
<div class="line">e0,e free permittivity and dielectric constant</div>
<div class="line">k=1/scl inverse screening length of Debye-Hückel potential</div>
</div>
</div>
</div></blockquote>
<p><strong>eta</strong> : float</p>
<blockquote>
<div><p>Volume fraction as eta=4/3*pi*R**3*n  with number density n.</p>
</div></blockquote>
<p><strong>useHP</strong> : True, default False</p>
<blockquote>
<div><p>To use the original Hayter/Penfold algorithm. This gives wrong results for some parameter conditions.
It should ONLY be used for testing.
See example examples/test_newRMSAAlgorithm.py for a direct comparison.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dataArray</strong> : .</p>
<blockquote class="last">
<div><ul class="simple">
<li>.volumeFraction = eta</li>
<li>.rescaledVolumeFraction</li>
<li>.screeningLength</li>
<li>.gamma=gamma</li>
<li>.contactpotential</li>
<li>.S0 structure factor at q=0</li>
<li>.scalingfactor factor for rescaling to get g+1=0; if =1 nothing was scaled and it is MSA</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>Improved algorithm</dt>
<dd>The Python code is deduced from the original Hayter-Penfold Fortran code (1981, ILL Grenoble).
This is also used in other common SAS programs as SASfit or SASview (translated to C).
The original algorithm determines the root of a quartic F(w1,w2,w3,w4) by an estimate (named PW estimate),
refining it by a Newton algorithm. As the PW estimate is somtimes not good enough this results in an
arbitrary root of the quartic in the Newton algorithm. The solution therefore jumps between different
posibilities by small changes of the parameters.
We use here the original idea from <a class="reference internal" href="#r227" id="id13">[R227]</a> to calculate G(r&lt;0) for all four roots of F(w1,w2,w3,w4) and use
the physical solution with G(r&lt;R)=0.
See examples/test_newRMSAAlgorithm.py for a direct comparison.</dd>
<dt>Validity</dt>
<dd>The calculation of charge at the surface or screening length from a solute ion concentration is explicitly dedicate
to the user. The Debye-Hückel theory for a macro ion in screened solution is a far field theory as a linearization
of the Poisson-Boltzmann (PB) theory and from limited validity (far field or low charge -&gt; linearization).
Things like reverting charge layer, ion condensation at the surface, pH changes at the surface or other things
might appear. Before calculating please take these things into account. Close to the surface the PB has to be solved.
The DH theory can still be used if the charge is thus an effective charge named Z*, which might be different from the
real surface charge.
See Ref <a class="reference internal" href="#r229" id="id14">[R229]</a> for details.</dd>
</dl>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r227" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R227]</td><td><em>(<a class="fn-backref" href="#id10">1</a>, <a class="fn-backref" href="#id12">2</a>, <a class="fn-backref" href="#id13">3</a>, <a class="fn-backref" href="#id15">4</a>)</em> <ol class="last upperalpha simple" start="10">
<li><ol class="first upperalpha" start="2">
<li>Hayter and J. Penfold, Mol. Phys. 42, 109 (1981).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r228" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R228]</td><td><em>(<a class="fn-backref" href="#id11">1</a>, <a class="fn-backref" href="#id16">2</a>)</em> J.-P. Hansen and J. B. Hayter, Mol. Phys. 46, 651 (2006).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r229" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R229]</td><td><em>(<a class="fn-backref" href="#id14">1</a>, <a class="fn-backref" href="#id17">2</a>)</em> <ol class="last upperalpha simple" start="12">
<li>Belloni, J. Phys. Condens. Matter 12, R549 (2000).</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.adhesiveHardSphere">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">adhesiveHardSphere</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>tau</em>, <em>delta</em>, <em>molarity=None</em>, <em>eta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#adhesiveHardSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.adhesiveHardSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>structure factor of a adhesive hard sphere potential (a square well potential)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>scattering vector; units 1/(R[unit])</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>radius of the hard core</p>
</div></blockquote>
<p><strong>eta</strong> : float</p>
<blockquote>
<div><p>volume fraction of the hard core particles</p>
</div></blockquote>
<p><strong>molarity</strong> : float</p>
<blockquote>
<div><p>number density in mol/l and defines q and R units to 1/nm and nm to be correct
preferred over eta if both given</p>
</div></blockquote>
<p><strong>tau</strong> : float</p>
<blockquote>
<div><p>stickiness</p>
</div></blockquote>
<p><strong>delta</strong> : float</p>
<blockquote class="last">
<div><p>width of the square well</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The potential U(r) is defined as 
r&lt;2R             U(r)=infinity
2R&lt;r&lt;2R+delta    U(r)=-depth=ln(12*tau*delta/(2R+delta))   
r &gt;2R+delta      U(r)=0</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r230" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[R230]</a></td><td><ol class="first last upperalpha simple" start="3">
<li>Regnaut and J. C. Ravey, J. Chem. Phys. 91, 1211 (1989).</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r231" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id19">[R231]</a></td><td><ol class="first last upperalpha simple" start="3">
<li>Regnaut and J. C. Ravey, J. Chem. Phys. 92 (5) (1990), 3250 Erratum</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.criticalSystem">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">criticalSystem</code><span class="sig-paren">(</span><em>q</em>, <em>corrlength</em>, <em>isothermalcompress</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#criticalSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.criticalSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>structure factor of a critical system should take the Ornstein-Zernike form</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>scattering vector; units 1/(R[unit])</p>
</div></blockquote>
<p><strong>corrlength</strong> : float</p>
<blockquote>
<div><p>correlation length</p>
</div></blockquote>
<p><strong>isothermalcompress</strong> : float</p>
<blockquote class="last">
<div><p>isothermal compressibility of the system</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The peaking of the structure factor near Q=0 region is due to attractive interaction.
Away from it the structure factor should be close to the hard sphere structure factor.
Near the critical point we should find 
S(Q)=S_PY(Q)+S_OZ(Q)
S_PY Percus Yevik structure factor
S_OZ this function</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r232" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id20">[R232]</a></td><td>Analysis of Critical Scattering Data from AOT/D2O/n-Decane Microemulsions
S. H. Chen, T. L. Lin, M. Kotlarchyk
Surfactants in Solution pp 1315-1330</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.hydrodynamicFunct">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">hydrodynamicFunct</code><span class="sig-paren">(</span><em>wavevector</em>, <em>Rh</em>, <em>molarity</em>, <em>intrinsicVisc=None</em>, <em>DsoverD0=None</em>, <em>structureFactor=None</em>, <em>structureFactorArgs={}</em>, <em>numberOfPoints=50</em>, <em>ncpu=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#hydrodynamicFunct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.hydrodynamicFunct" title="Permalink to this definition">¶</a></dt>
<dd><p>Hydrodynamic function H(Q) from hydrodynamic pair interaction of spheres in suspension.</p>
<p>We use the theory from Beenakker and Mazur <a class="reference internal" href="#r234" id="id21">[R234]</a> as given by Genz <a class="reference internal" href="#r233" id="id22">[R233]</a>.
The <span class="math">\delta\gamma</span>-expansion of Beenakker expresses many body hydrodynamic 
interaction within the renormalization approach dependent on the structure factor S(q).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>wavevector</strong> : array</p>
<blockquote>
<div><p>scattering vector q in units 1/nm</p>
</div></blockquote>
<p><strong>Rh</strong> : float</p>
<blockquote>
<div><p>effective hydrodynamic radius of particles in nm.</p>
</div></blockquote>
<p><strong>molarity</strong> : float</p>
<blockquote>
<div><div class="line-block">
<div class="line">molarity in mol/l</div>
<div class="line">This overides a parameter ‘molarity’ in the structureFactorArgs.</div>
<div class="line">Rh and molarity define the hydrodynamic interaction, the volume fraction and Ds/D0 for H(Q).</div>
<div class="line">The structure factor may have a radius different from Rh e.g. for attenuated hydrodynamic interactions.</div>
</div>
</div></blockquote>
<p><strong>DsoverD0</strong> : float</p>
<blockquote>
<div><div class="line-block">
<div class="line">The high Q limit of the hydrodynamic function is for low volume fractions</div>
<div class="line">Ds/D0= 1/(1+intrinsicVisc * volumeFraction ) with self diffusion Ds.</div>
<div class="line">Ds is calculated from molarity and Rh.</div>
<div class="line">This explicit value overrides intrinsic viscosity and calculated Ds/D0.</div>
</div>
</div></blockquote>
<p><strong>structureFactor</strong> : function, None</p>
<blockquote>
<div><div class="line-block">
<div class="line">Structure factor S(q) with S(q=inf)=1.0 recommended.</div>
<div class="line">1: If structurefactor is None a Percus-Yevik is assumed with molarity and R=Rh.</div>
<div class="line">2: A function S(q,…) is given as structure factor, which might be an</div>
<div class="line-block">
<div class="line">empirical function (e.g. polynominal fit of a measurement)</div>
<div class="line">First parameter needs to be wavevector q .</div>
<div class="line">If “molarity” parameter is present it is overwriten by molarity above.</div>
</div>
</div>
</div></blockquote>
<p><strong>structureFactorArgs</strong> : dictionary</p>
<blockquote>
<div><p>Any extra arguments to structureFactor e.g. structFactorArgs={‘x’:0.123,R=3,….}</p>
</div></blockquote>
<p><strong>intrinsicVisc</strong> : float</p>
<blockquote>
<div><div class="line-block">
<div class="line">Defines the high q limit for the hydrodynamic function.</div>
<div class="line">effective_viscosity= eta_solvent * (1-intrinsicVisc*Volumefraction )</div>
<div class="line">intrinsicVisc = 2.5 Einstein hard sphere density 1 g/cm**3</div>
<div class="line">For proteins instead of volume fraction  the protein concentration in g/ml with typical</div>
<div class="line">protein density 1.37 g/cm^3 is often used.</div>
<div class="line">Intrinsic Viscosity depends on protein shape (see HYDROPRO).</div>
<div class="line">Typical real values for intrinsicVisc in practical units cm^3/g</div>
<div class="line-block">
<div class="line">sphere 1.76 cm^3/g= 2.5    sphere with protein density</div>
<div class="line">ADH    3.9        = 5.5    a tetrameric protein</div>
<div class="line">PGK    4.0        = 5.68   two domains with hinge-&gt; elongated</div>
<div class="line">Rnase  3.2        = 4.54   one domain</div>
</div>
<div class="line">eta_solvent/effective_viscosity = (1-intrinsicVisc * Volumefraction )=Dself/D0</div>
</div>
</div></blockquote>
<p><strong>numberOfPoints</strong> : integer, default 50</p>
<blockquote>
<div><p>Determines number of integration points in equ 5 of ref <a class="reference internal" href="#r233" id="id23">[R233]</a> and therfore accuracy of integration.
The typical accuracy of this function is &lt;1e-4 for (H(q) -highQLimit) and &lt;1e-3 for Ds/D0.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataArray</p>
<blockquote class="last">
<div><div class="line-block">
<div class="line">[0] q values</div>
<div class="line">[1] hydrodynamic function</div>
<div class="line">[2] hydrodynamic function only Q dependent part = H(q) -highQLimit</div>
<div class="line">[3] structure factor for H(q) calculation</div>
<div class="line">.selfdiffusion Ds</div>
</div>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Ds is calculated according to equ 11 in <a class="reference internal" href="#r233" id="id24">[R233]</a> which is valid for volume fractions up to 0.5.
With this assumption the deviation of self diffusion Ds from 
Ds=Do*[1-1.73*phi+0.88*phi**2+ O(phi**3)] is smaller 5% for phi&lt;0.2 (10% for phi&lt;0.3)</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r233" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R233]</td><td><em>(<a class="fn-backref" href="#id22">1</a>, <a class="fn-backref" href="#id23">2</a>, <a class="fn-backref" href="#id24">3</a>, <a class="fn-backref" href="#id25">4</a>)</em> <ol class="last upperalpha simple" start="21">
<li>Genz and R. Klein, Phys. A Stat. Mech. Its Appl. 171, 26 (1991).</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r234" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R234]</td><td><em>(<a class="fn-backref" href="#id21">1</a>, <a class="fn-backref" href="#id26">2</a>)</em> <ol class="last upperalpha simple" start="3">
<li><ol class="first upperalpha" start="23">
<li><ol class="first upperalpha" start="10">
<li>Beenakker and P. Mazur, Phys. A Stat. Mech. Its Appl. 126, 349 (1984).</li>
</ol>
</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r235" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id27">[R235]</a></td><td><ol class="first last upperalpha simple" start="3">
<li><ol class="first upperalpha" start="23">
<li><ol class="first upperalpha" start="10">
<li>Beenakker and P. Mazur, Phys. A Stat. Mech. Its Appl. 120, 388 (1983).</li>
</ol>
</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.sq2gr">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">sq2gr</code><span class="sig-paren">(</span><em>Sq</em>, <em>R</em>, <em>interpolatefactor=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#sq2gr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.sq2gr" title="Permalink to this definition">¶</a></dt>
<dd><p>Radial distribution function g(r) from structure factor Sq.</p>
<p>The result strongly depends on quality of S(Q) (number of data points, Q range, smoothness).
Read <a class="reference internal" href="#r237" id="id28">[R237]</a> for details of this inversion problem and why it may fail.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Sq</strong> : dataArray</p>
<blockquote>
<div><dl class="docutils">
<dt>Structure factor e.g. in units as [Q]=1/nm</dt>
<dd><ul class="first last simple">
<li>.X wavevector</li>
<li>.Y structure factor</li>
</ul>
</dd>
</dl>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>Estimate for the radius of the particles.</p>
</div></blockquote>
<p><strong>interpolatefactor</strong> : int</p>
<blockquote>
<div><p>Number of points between points in interpolation for rfft.
2 doubles the points</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataArray</p>
<blockquote class="last">
<div><p>.n0  approximated from <span class="math">2\pi^2 n_0=\int_0^{Q_{max}}  [S(Q) -1]Q^2 dQ</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>One finds that</p>
<div class="math">
<p><span class="math">g(r)-1=(2\pi^2 n_0 r)^{-1} \int_0^\infty  [S(Q) -1]Qsin(qr)dQ</span></p>
</div><p>with <span class="math">2\pi^2 n_0=\int_0^\infty  [S(Q) -1]Q^2 dQ</span> defining <span class="math">n_0</span>.</p>
<p>As we have only a limited Q range (<span class="math">0 &lt; Q &lt; \infty</span> ), limited accuracy and number of Q values
we require that <span class="math">mean(g(R/2&lt;r&lt;R3/4))=0</span>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r236" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id29">[R236]</a></td><td>Yarnell, J. L., Katz, M. J., Wenzel, R. G., &amp; Koenig, S. H. (1973).
Structure factor and radial distribution function for liquid argon at 85 K.
Physical Review A, 7(6), 2130.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r237" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R237]</td><td><em>(<a class="fn-backref" href="#id28">1</a>, <a class="fn-backref" href="#id30">2</a>)</em> On the determination of the pair correlation function from liquid structure factor measurements
A.K. Soper Chemical Physics 107, 61-74, (1986)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">p</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">grace</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">multi</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">q</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">13</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">();</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">R</span><span class="o">=</span><span class="mf">2.5</span>
<span class="n">eta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">;</span><span class="n">scl</span><span class="o">=</span><span class="mi">5</span>
<span class="n">n</span><span class="o">=</span><span class="n">eta</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># unit 1/nm**3</span>
<span class="n">sf</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">RMSA</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">scl</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
<span class="n">gr</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">sq2gr</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">interpolatefactor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sfcut</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">RMSA</span><span class="p">(</span><span class="n">js</span><span class="o">.</span><span class="n">loglist</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">10</span><span class="p">),</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">scl</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
<span class="n">grcut</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">sq2gr</span><span class="p">(</span><span class="n">sfcut</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">interpolatefactor</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">X</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">,</span><span class="n">sf</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=50&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">R</span><span class="p">,</span><span class="n">gr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=50&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grcut</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">R</span><span class="p">,</span><span class="n">grcut</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=50 \f</span><span class="si">{}</span><span class="s1">Q\smax\N=10&#39;</span><span class="p">)</span>
<span class="n">sfh</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">RMSA</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span><span class="n">scl</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">)</span>
<span class="n">grh</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">sq2gr</span><span class="p">(</span><span class="n">sfh</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">interpolatefactor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sfh</span><span class="o">.</span><span class="n">X</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="p">,</span><span class="n">sfh</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=0.01&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grh</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">R</span><span class="p">,</span><span class="n">grh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">le</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\xG=0.01&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;2RQ&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;r/(2R)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;S(Q)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;g(r)&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison RMSA&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subtitle</span><span class="p">(</span><span class="s1">&#39;R=</span><span class="si">%.2g</span><span class="s1">, eta=</span><span class="si">%.2g</span><span class="s1">, scl=</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">eta</span><span class="p">,</span><span class="n">scl</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="jscatter.structurefactor.stickyHardSphere">
<code class="descclassname">jscatter.structurefactor.</code><code class="descname">stickyHardSphere</code><span class="sig-paren">(</span><em>q</em>, <em>R</em>, <em>width</em>, <em>depth</em>, <em>molarity=None</em>, <em>phi=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/structurefactor.html#stickyHardSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.stickyHardSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure factor of a square well potential with depth and width (sticky hard spheres).</p>
<p>Sticky hard sphere model is derived using a perturbative solution of the factorized
form of the Ornstein-Zernike equation and the Percus-Yevick closure relation.
The perturbation parameter is width/(width+2R)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>q</strong> : array; N dim</p>
<blockquote>
<div><p>Scattering vector; units 1/(R[unit])</p>
</div></blockquote>
<p><strong>R</strong> : float</p>
<blockquote>
<div><p>Radius of the hard sphere</p>
</div></blockquote>
<p><strong>phi</strong> : float</p>
<blockquote>
<div><p>Volume fraction of the hard core particles</p>
</div></blockquote>
<p><strong>molarity</strong> : float</p>
<blockquote>
<div><p>Number density in mol/l and defines q and R units to 1/nm and nm to be correct
Preferred over phi if both given.</p>
</div></blockquote>
<p><strong>depth</strong> : float</p>
<blockquote>
<div><p>Potential well depth in kT
depth &gt;0 (U&lt;0); positive potential allowed (repulsive) see <a class="reference internal" href="#r238" id="id31">[R238]</a>.</p>
</div></blockquote>
<p><strong>width</strong> : float</p>
<blockquote class="last">
<div><p>Width of the square well</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="line-block">
<div class="line">The potential U(r) is defined as</div>
<div class="line">r&lt;2R             U(r)=infinity</div>
<div class="line">2R&lt;r&lt;2R+width    U(r)=-depth   in [kT]</div>
<div class="line">r &gt;2R+width      U(r)=0</div>
</div>
<p>eps=width/(2*R+width) 
stickyness=exp(-depth)/12./eps</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r238" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R238]</td><td><em>(<a class="fn-backref" href="#id31">1</a>, <a class="fn-backref" href="#id32">2</a>)</em> S.V. G. Menon, C. Manohar, and K. S. Rao, J. Chem. Phys. 95, 9186 (1991)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r239" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id33">[R239]</a></td><td><ol class="first last upperalpha simple" start="13">
<li>Sztucki, T. Narayanan, G. Belina, A. Moussaïd, F. Pignon, and H. Hoekstra, Phys. Rev. E 74, 051504 (2006)</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r240" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id34">[R240]</a></td><td>W.-R. Chen, S.-H. Chen, and F. Mallamace, Phys. Rev. E 66, 021403 (2002)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r241" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id35">[R241]</a></td><td><ol class="first last upperalpha simple" start="7">
<li>Foffi, E. Zaccarelli, F. Sciortino, P. Tartaglia, and K. A. Dawson, J. Stat. Phys. 100, 363 (2000)</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.rhombicLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">rhombicLattice</code><span class="sig-paren">(</span><em>latticeVectors</em>, <em>size</em>, <em>primitive=None</em>, <em>b=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a rhombic lattice.</p>
<p>Allows to create 1D, 2D or 3D latices by using 1, 2 or 3 latticeVectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>latticeVectors</strong> : list of array 3x1</p>
<blockquote>
<div><p>Lattice primitive vectors defining the translation of the unit cell along its principal axes.</p>
</div></blockquote>
<p><strong>size :3x integer or integer</strong></p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
<p><strong>primitive</strong> : list of 3x1 array, None=[0,0,0]</p>
<blockquote>
<div><p>Position vectors of atoms in the primitive cell.</p>
</div></blockquote>
<p><strong>b</strong> : list of float</p>
<blockquote>
<div><p>Corresponding scattering length of atoms in the primitive cell.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array
.primitiveVolume         V = a1*a2 x a3 with latticeVectors a1, a2, a3;  if existing.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="c1"># cubic lattice with diatomic base</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">rhombicLattice</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="jscatter.structurefactor.rhombicLattice.X">
<code class="descname">X</code><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.X" title="Permalink to this definition">¶</a></dt>
<dd><p>X coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.rhombicLattice.Y">
<code class="descname">Y</code><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>Y coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.rhombicLattice.Z">
<code class="descname">Z</code><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Z coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.rhombicLattice.array">
<code class="descname">array</code><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates and scattering length as array</p>
</dd></dl>

<dl class="attribute">
<dt id="jscatter.structurefactor.rhombicLattice.b">
<code class="descname">b</code><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.b" title="Permalink to this definition">¶</a></dt>
<dd><p>Scattering length</p>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.centerOfMass">
<code class="descname">centerOfMass</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.centerOfMass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.centerOfMass" title="Permalink to this definition">¶</a></dt>
<dd><p>CenterOf mass</p>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.filter">
<code class="descname">filter</code><span class="sig-paren">(</span><em>funktion</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter lattice points according to a function.</p>
<p>The existing points in the lattice size are tested.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>funktion</strong> : function returning bool</p>
<blockquote>
<div><p>Function to select lattice points.
The function is applied with the point coordinates (array) as input.
This corresponds to .points[:,:3]</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To select points inside of a sphere with radius 50 around [0,0,0]:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">xyz</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xyz</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">50</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.inSphere">
<code class="descname">inSphere</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.inSphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.inSphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose lattice points in sphere</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>R: float</strong></p>
<blockquote class="last">
<div><p>Radius of sphere around origin.
If negative the points outside are choosen</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.limit2Cube">
<code class="descname">limit2Cube</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.limit2Cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.limit2Cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Cut at cube with edges at</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a,b,c</strong> : float</p>
<blockquote class="last">
<div><p>Cut at +-[a,0,0],+-[0,b,0],+-[0,0,c]</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.move">
<code class="descname">move</code><span class="sig-paren">(</span><em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.move" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all points by vector.
Parameters
———-
vector : list of float</p>
<blockquote>
<div>Vector to shift the points.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.planeSide">
<code class="descname">planeSide</code><span class="sig-paren">(</span><em>vector</em>, <em>invert=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.planeSide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.planeSide" title="Permalink to this definition">¶</a></dt>
<dd><p>Select points on one side of a plane.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>vector</strong> : list 3x float</p>
<blockquote>
<div><p>Vector from origin to plane, perpendicular to plane.</p>
</div></blockquote>
<p><strong>invert</strong> : bool</p>
<blockquote class="last">
<div><p>False choose points at origin side. True other side.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="jscatter.structurefactor.rhombicLattice.show">
<code class="descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.rhombicLattice.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the lattice in matplotlib.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">rhombicLattice</code><span class="sig-paren">(</span><em>latticeVectors</em>, <em>size</em>, <em>primitive=None</em>, <em>b=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#rhombicLattice"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Create a rhombic lattice.</p>
<p>Allows to create 1D, 2D or 3D latices by using 1, 2 or 3 latticeVectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>latticeVectors</strong> : list of array 3x1</p>
<blockquote>
<div><p>Lattice primitive vectors defining the translation of the unit cell along its principal axes.</p>
</div></blockquote>
<p><strong>size :3x integer or integer</strong></p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
<p><strong>primitive</strong> : list of 3x1 array, None=[0,0,0]</p>
<blockquote>
<div><p>Position vectors of atoms in the primitive cell.</p>
</div></blockquote>
<p><strong>b</strong> : list of float</p>
<blockquote>
<div><p>Corresponding scattering length of atoms in the primitive cell.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array
.primitiveVolume         V = a1*a2 x a3 with latticeVectors a1, a2, a3;  if existing.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="c1"># cubic lattice with diatomic base</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">rhombicLattice</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.bravaisLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">bravaisLattice</code><span class="sig-paren">(</span><em>latticeVectors</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#bravaisLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.bravaisLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a bravais lattice. Lattice with one atom in the primitive cell.</p>
<p>See rhombicLattice for methods and attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>latticeVectors</strong> : list of array 1x3</p>
<blockquote>
<div><p>Lattice primitive vectors defining the translation of the unit cell along its principal axes.</p>
</div></blockquote>
<p><strong>size :3x integer, integer</strong></p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points asnumpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.scLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">scLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#scLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.scLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple Cubic lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>abc</strong> : float</p>
<blockquote>
<div><p>Point distance.</p>
</div></blockquote>
<p><strong>size</strong> : 3x integer, integer</p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.bccLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">bccLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em>, <em>b=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#bccLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.bccLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Body centered cubic lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>abc</strong> : float</p>
<blockquote>
<div><p>Point distance.</p>
</div></blockquote>
<p><strong>size</strong> : 3x integer, integer</p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">bccLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.fccLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">fccLattice</code><span class="sig-paren">(</span><em>abc</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#fccLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.fccLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Face centered cubic lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>abc</strong> : float</p>
<blockquote>
<div><p>Point distance.</p>
</div></blockquote>
<p><strong>size</strong> : 3x integer, integer</p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">fccLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.hexLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">hexLattice</code><span class="sig-paren">(</span><em>ab</em>, <em>c</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#hexLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.hexLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Hexagonal lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ab,c</strong> : float</p>
<blockquote>
<div><p>Point distance.
ab is distance in hexagonal plane, c perpendicular.
For c/a = (8/3)**0.5 the hcp structure</p>
</div></blockquote>
<p><strong>size</strong> : 3x integer, integer</p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">hexLattice</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">array</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="jscatter.structurefactor.hcpLattice">
<em class="property">class </em><code class="descclassname">jscatter.structurefactor.</code><code class="descname">hcpLattice</code><span class="sig-paren">(</span><em>ab</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jscatter/lattice.html#hcpLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jscatter.structurefactor.hcpLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Hexagonal closed packed lattice.</p>
<p>See rhombicLattice for methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ab</strong> : float</p>
<blockquote>
<div><p>Point distance.
ab is distance in hexagonal plane, c = ab* (8/3)**0.5</p>
</div></blockquote>
<p><strong>size</strong> : 3x integer, integer</p>
<blockquote>
<div><p>A list of integers describing the size in direction of the respective latticeVectors.
Size is symmetric around zero in interval [-i,..,i] with length 2i+1.
If one integer is given it is used for all 3 dimensions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lattice object</p>
<blockquote class="last">
<div><p>.array  grid points as numpy array</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jscatter</span> <span class="k">as</span> <span class="nn">js</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">Axes3D</span>
<span class="n">grid</span><span class="o">=</span><span class="n">js</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">hcpLattice</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">array</span>
<span class="c1">#</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">grid</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Jscatter1.gif" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">7. structurefactor (sf)</a><ul>
<li><a class="reference internal" href="#structure-factors">7.1. Structure Factors</a></li>
<li><a class="reference internal" href="#hydrodynamics">7.2. Hydrodynamics</a></li>
<li><a class="reference internal" href="#pair-correlation">7.3. Pair Correlation</a></li>
<li><a class="reference internal" href="#lattice">7.4. Lattice</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="formfactor.html"
                        title="previous chapter">6. formfactor (ff)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dynamic.html"
                        title="next chapter">8. dynamic</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/structurefactor.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dynamic.html" title="8. dynamic"
             >next</a> |</li>
        <li class="right" >
          <a href="formfactor.html" title="6. formfactor (ff)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">jscatter 0.7.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Ralf Biehl.
      Last updated on Mar 27, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>