
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Faceting &#8212; Haystack 2.5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Autocomplete" href="autocomplete.html" />
    <link rel="prev" title="Highlighting" href="highlighting.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="faceting">
<span id="ref-faceting"></span><h1>Faceting<a class="headerlink" href="#faceting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-faceting">
<h2>What Is Faceting?<a class="headerlink" href="#what-is-faceting" title="Permalink to this headline">¶</a></h2>
<p>Faceting is a way to provide users with feedback about the number of documents
which match terms they may be interested in. At its simplest, it gives
document counts based on words in the corpus, date ranges, numeric ranges or
even advanced queries.</p>
<p>Faceting is particularly useful when trying to provide users with drill-down
capabilities. The general workflow in this regard is:</p>
<blockquote>
<div><ol class="arabic simple">
<li>You can choose what you want to facet on.</li>
<li>The search engine will return the counts it sees for that match.</li>
<li>You display those counts to the user and provide them with a link.</li>
<li>When the user chooses a link, you narrow the search query to only include
those conditions and display the results, potentially with further facets.</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Faceting can be difficult, especially in providing the user with the right
number of options and/or the right areas to be able to drill into. This
is unique to every situation and demands following what real users need.</p>
<p class="last">You may want to consider logging queries and looking at popular terms to
help you narrow down how you can help your users.</p>
</div>
<p>Haystack provides functionality so that all of the above steps are possible.
From the ground up, let’s build a faceted search setup. This assumes that you
have been to work through the <a class="reference internal" href="tutorial.html"><span class="doc">Getting Started with Haystack</span></a> and have a working Haystack
installation. The same setup from the <a class="reference internal" href="tutorial.html"><span class="doc">Getting Started with Haystack</span></a> applies here.</p>
</div>
<div class="section" id="determine-facets-and-searchqueryset">
<h2>1. Determine Facets And <code class="docutils literal"><span class="pre">SearchQuerySet</span></code><a class="headerlink" href="#determine-facets-and-searchqueryset" title="Permalink to this headline">¶</a></h2>
<p>Determining what you want to facet on isn’t always easy. For our purposes,
we’ll facet on the <code class="docutils literal"><span class="pre">author</span></code> field.</p>
<p>In order to facet effectively, the search engine should store both a standard
representation of your data as well as exact version to facet on. This is
generally accomplished by duplicating the field and storing it via two
different types. Duplication is suggested so that those fields are still
searchable in the standard ways.</p>
<p>To inform Haystack of this, you simply pass along a <code class="docutils literal"><span class="pre">faceted=True</span></code> parameter
on the field(s) you wish to facet on. So to modify our existing example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NoteIndex</span><span class="p">(</span><span class="n">SearchIndex</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">Indexable</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">document</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_template</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">model_attr</span><span class="o">=</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="n">faceted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">model_attr</span><span class="o">=</span><span class="s1">&#39;pub_date&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Haystack quietly handles all of the backend details for you, creating a similar
field to the type you specified with <code class="docutils literal"><span class="pre">_exact</span></code> appended. Our example would now
have both a <code class="docutils literal"><span class="pre">author</span></code> and <code class="docutils literal"><span class="pre">author_exact</span></code> field, though this is largely an
implementation detail.</p>
<p>To pull faceting information out of the index, we’ll use the
<code class="docutils literal"><span class="pre">SearchQuerySet.facet</span></code> method to setup the facet and the
<code class="docutils literal"><span class="pre">SearchQuerySet.facet_counts</span></code> method to retrieve back the counts seen.</p>
<p>Experimenting in a shell (<code class="docutils literal"><span class="pre">./manage.py</span> <span class="pre">shell</span></code>) is a good way to get a feel
for what various facets might look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">haystack.query</span> <span class="k">import</span> <span class="n">SearchQuerySet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span><span class="o">.</span><span class="n">facet_counts</span><span class="p">()</span>
<span class="go">{</span>
<span class="go">    &#39;dates&#39;: {},</span>
<span class="go">    &#39;fields&#39;: {</span>
<span class="go">        &#39;author&#39;: [</span>
<span class="go">            (&#39;john&#39;, 4),</span>
<span class="go">            (&#39;daniel&#39;, 2),</span>
<span class="go">            (&#39;sally&#39;, 1),</span>
<span class="go">            (&#39;terry&#39;, 1),</span>
<span class="go">        ],</span>
<span class="go">    },</span>
<span class="go">    &#39;queries&#39;: {}</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that, despite the duplication of fields, you should provide the
regular name of the field when faceting. Haystack will intelligently
handle the underlying details and mapping.</p>
</div>
<p>As you can see, we get back a dictionary which provides access to the three
types of facets available: <code class="docutils literal"><span class="pre">fields</span></code>, <code class="docutils literal"><span class="pre">dates</span></code> and <code class="docutils literal"><span class="pre">queries</span></code>. Since we only
faceted on the <code class="docutils literal"><span class="pre">author</span></code> field (which actually facets on the <code class="docutils literal"><span class="pre">author_exact</span></code>
field managed by Haystack), only the <code class="docutils literal"><span class="pre">fields</span></code> key has any data
associated with it. In this case, we have a corpus of eight documents with four
unique authors.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Facets are chainable, like most <code class="docutils literal"><span class="pre">SearchQuerySet</span></code> methods. However, unlike
most <code class="docutils literal"><span class="pre">SearchQuerySet</span></code> methods, they are <em>NOT</em> affected by <code class="docutils literal"><span class="pre">filter</span></code> or
similar methods. The only method that has any effect on facets is the
<code class="docutils literal"><span class="pre">narrow</span></code> method (which is how you provide drill-down).</p>
</div>
<div class="section" id="configuring-facet-behaviour">
<h3>Configuring facet behaviour<a class="headerlink" href="#configuring-facet-behaviour" title="Permalink to this headline">¶</a></h3>
<p>You can configure the behaviour of your facets by passing options
for each facet in your SearchQuerySet. These options can be backend specific.</p>
<p><strong>limit</strong>
<em>tested on Solr</em></p>
<p>The <code class="docutils literal"><span class="pre">limit</span></code> parameter limits the results for each query. On Solr, the default <a class="reference external" href="https://wiki.apache.org/solr/SimpleFacetParameters#facet.limit">facet.limit</a> is 100 and a
negative number removes the limit.</p>
<p>Example usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">haystack.query</span> <span class="k">import</span> <span class="n">SearchQuerySet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span><span class="o">.</span><span class="n">facet_counts</span><span class="p">()</span>
<span class="go">{</span>
<span class="go">    &#39;dates&#39;: {},</span>
<span class="go">    &#39;fields&#39;: {</span>
<span class="go">        &#39;author&#39;: [</span>
<span class="go">            (&#39;abraham&#39;, 1),</span>
<span class="go">            (&#39;benny&#39;, 2),</span>
<span class="go">            (&#39;cindy&#39;, 1),</span>
<span class="go">            (&#39;diana&#39;, 5),</span>
<span class="go">        ],</span>
<span class="go">    },</span>
<span class="go">    &#39;queries&#39;: {}</span>
<span class="go">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span><span class="o">.</span><span class="n">facet_counts</span><span class="p">()</span>
<span class="go">{</span>
<span class="go">    &#39;dates&#39;: {},</span>
<span class="go">    &#39;fields&#39;: {</span>
<span class="go">        &#39;author&#39;: [</span>
<span class="go">            (&#39;abraham&#39;, 1),</span>
<span class="go">            (&#39;benny&#39;, 2),</span>
<span class="go">        ],</span>
<span class="go">    },</span>
<span class="go">    &#39;queries&#39;: {}</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>sort</strong>
<em>tested on Solr</em></p>
<p>The <code class="docutils literal"><span class="pre">sort</span></code> parameter will sort the results for each query. Solr’s default
<a class="reference external" href="https://wiki.apache.org/solr/SimpleFacetParameters#facet.sort">facet.sort</a> is <code class="docutils literal"><span class="pre">index</span></code>, which will sort the facets alphabetically. Changing
the parameter to <code class="docutils literal"><span class="pre">count</span></code> will sort the facets by the number of results for
each facet value.</p>
<p>Example usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">haystack.query</span> <span class="k">import</span> <span class="n">SearchQuerySet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span><span class="o">.</span><span class="n">facet_counts</span><span class="p">()</span>
<span class="go">{</span>
<span class="go">    &#39;dates&#39;: {},</span>
<span class="go">    &#39;fields&#39;: {</span>
<span class="go">        &#39;author&#39;: [</span>
<span class="go">            (&#39;abraham&#39;, 1),</span>
<span class="go">            (&#39;benny&#39;, 2),</span>
<span class="go">            (&#39;cindy&#39;, 1),</span>
<span class="go">            (&#39;diana&#39;, 5),</span>
<span class="go">        ],</span>
<span class="go">    },</span>
<span class="go">    &#39;queries&#39;: {}</span>
<span class="go">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">facet</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqs</span><span class="o">.</span><span class="n">facet_counts</span><span class="p">()</span>
<span class="go">{</span>
<span class="go">    &#39;dates&#39;: {},</span>
<span class="go">    &#39;fields&#39;: {</span>
<span class="go">        &#39;author&#39;: [</span>
<span class="go">            (&#39;diana&#39;, 5),</span>
<span class="go">            (&#39;benny&#39;, 2),</span>
<span class="go">            (&#39;abraham&#39;, 1),</span>
<span class="go">            (&#39;cindy&#39;, 1),</span>
<span class="go">        ],</span>
<span class="go">    },</span>
<span class="go">    &#39;queries&#39;: {}</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Now that we have the facet we want, it’s time to implement it.</p>
</div>
</div>
<div class="section" id="switch-to-the-facetedsearchview-and-facetedsearchform">
<h2>2. Switch to the <code class="docutils literal"><span class="pre">FacetedSearchView</span></code> and <code class="docutils literal"><span class="pre">FacetedSearchForm</span></code><a class="headerlink" href="#switch-to-the-facetedsearchview-and-facetedsearchform" title="Permalink to this headline">¶</a></h2>
<p>There are three things that we’ll need to do to expose facets to our frontend.
The first is construct the <code class="docutils literal"><span class="pre">SearchQuerySet</span></code> we want to use. We should have
that from the previous step. The second is to switch to the
<code class="docutils literal"><span class="pre">FacetedSearchView</span></code>. This view is useful because it prepares the facet counts
and provides them in the context as <code class="docutils literal"><span class="pre">facets</span></code>.</p>
<p>Optionally, the third step is to switch to the <code class="docutils literal"><span class="pre">FacetedSearchForm</span></code>. As it
currently stands, this is only useful if you want to provide drill-down, though
it may provide more functionality in the future. We’ll do it for the sake of
having it in place but know that it’s not required.</p>
<p>In your URLconf, you’ll need to switch to the <code class="docutils literal"><span class="pre">FacetedSearchView</span></code>. Your
URLconf should resemble:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="k">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">haystack.forms</span> <span class="k">import</span> <span class="n">FacetedSearchForm</span>
<span class="kn">from</span> <span class="nn">haystack.views</span> <span class="k">import</span> <span class="n">FacetedSearchView</span>


<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">FacetedSearchView</span><span class="p">(</span><span class="n">form_class</span><span class="o">=</span><span class="n">FacetedSearchForm</span><span class="p">,</span> <span class="n">facet_fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;haystack_search&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">FacetedSearchView</span></code> will now instantiate the <code class="docutils literal"><span class="pre">FacetedSearchForm</span></code>.
The specified <code class="docutils literal"><span class="pre">facet_fields</span></code> will be present in the context variable
<code class="docutils literal"><span class="pre">facets</span></code>. This is added in an overridden <code class="docutils literal"><span class="pre">extra_context</span></code> method.</p>
</div>
<div class="section" id="display-the-facets-in-the-template">
<h2>3. Display The Facets In The Template<a class="headerlink" href="#display-the-facets-in-the-template" title="Permalink to this headline">¶</a></h2>
<p>Templating facets involves simply adding an extra bit of processing to display
the facets (and optionally to link to provide drill-down). An example template
might look like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;form method=&quot;get&quot; action=&quot;.&quot;&gt;
    &lt;table&gt;
        &lt;tbody&gt;
            {{ form.as_table }}
            &lt;tr&gt;
                &lt;td&gt;&amp;nbsp;&lt;/td&gt;
                &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;Search&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/form&gt;

{% if query %}
    &lt;!-- Begin faceting. --&gt;
    &lt;h2&gt;By Author&lt;/h2&gt;

    &lt;div&gt;
        &lt;dl&gt;
            {% if facets.fields.author %}
                &lt;dt&gt;Author&lt;/dt&gt;
                {# Provide only the top 5 authors #}
                {% for author in facets.fields.author|slice:&quot;:5&quot; %}
                    &lt;dd&gt;&lt;a href=&quot;{{ request.get_full_path }}&amp;amp;selected_facets=author_exact:{{ author.0|urlencode }}&quot;&gt;{{ author.0 }}&lt;/a&gt; ({{ author.1 }})&lt;/dd&gt;
                {% endfor %}
            {% else %}
                &lt;p&gt;No author facets.&lt;/p&gt;
            {% endif %}
        &lt;/dl&gt;
    &lt;/div&gt;
    &lt;!-- End faceting --&gt;

    &lt;!-- Display results... --&gt;
    {% for result in page.object_list %}
        &lt;div class=&quot;search_result&quot;&gt;
            &lt;h3&gt;&lt;a href=&quot;{{ result.object.get_absolute_url }}&quot;&gt;{{ result.object.title }}&lt;/a&gt;&lt;/h3&gt;

            &lt;p&gt;{{ result.object.body|truncatewords:80 }}&lt;/p&gt;
        &lt;/div&gt;
    {% empty %}
        &lt;p&gt;Sorry, no results found.&lt;/p&gt;
    {% endfor %}
{% endif %}
</pre></div>
</div>
<p>Displaying the facets is a matter of looping through the facets you want and
providing the UI to suit. The <code class="docutils literal"><span class="pre">author.0</span></code> is the facet text from the backend
and the <code class="docutils literal"><span class="pre">author.1</span></code> is the facet count.</p>
</div>
<div class="section" id="narrowing-the-search">
<h2>4. Narrowing The Search<a class="headerlink" href="#narrowing-the-search" title="Permalink to this headline">¶</a></h2>
<p>We’ve also set ourselves up for the last bit, the drill-down aspect. By
appending on the <code class="docutils literal"><span class="pre">selected_facets</span></code> to the URLs, we’re informing the
<code class="docutils literal"><span class="pre">FacetedSearchForm</span></code> that we want to narrow our results to only those
containing the author we provided.</p>
<p>For a concrete example, if the facets on author come back as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;dates&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;john&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;daniel&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;sally&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;terry&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">},</span>
    <span class="s1">&#39;queries&#39;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You should present a list similar to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/search/?q=Haystack&amp;selected_facets=author_exact:john&quot;</span><span class="o">&gt;</span><span class="n">john</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/search/?q=Haystack&amp;selected_facets=author_exact:daniel&quot;</span><span class="o">&gt;</span><span class="n">daniel</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/search/?q=Haystack&amp;selected_facets=author_exact:sally&quot;</span><span class="o">&gt;</span><span class="n">sally</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/search/?q=Haystack&amp;selected_facets=author_exact:terry&quot;</span><span class="o">&gt;</span><span class="n">terry</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Haystack can automatically handle most details around faceting. However,
since <code class="docutils literal"><span class="pre">selected_facets</span></code> is passed directly to narrow, it must use the
duplicated field name. Improvements to this are planned but incomplete.</p>
</div>
<p>This is simply the default behavior but it is possible to override or provide
your own form which does additional processing. You could also write your own
faceted <code class="docutils literal"><span class="pre">SearchView</span></code>, which could provide additional/different facets based
on facets chosen. There is a wide range of possibilities available to help the
user navigate your content.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="toc.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Faceting</a><ul>
<li><a class="reference internal" href="#what-is-faceting">What Is Faceting?</a></li>
<li><a class="reference internal" href="#determine-facets-and-searchqueryset">1. Determine Facets And <code class="docutils literal"><span class="pre">SearchQuerySet</span></code></a><ul>
<li><a class="reference internal" href="#configuring-facet-behaviour">Configuring facet behaviour</a></li>
</ul>
</li>
<li><a class="reference internal" href="#switch-to-the-facetedsearchview-and-facetedsearchform">2. Switch to the <code class="docutils literal"><span class="pre">FacetedSearchView</span></code> and <code class="docutils literal"><span class="pre">FacetedSearchForm</span></code></a></li>
<li><a class="reference internal" href="#display-the-facets-in-the-template">3. Display The Facets In The Template</a></li>
<li><a class="reference internal" href="#narrowing-the-search">4. Narrowing The Search</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="toc.html">Documentation overview</a><ul>
  <li><a href="index.html">Welcome to Haystack!</a><ul>
      <li>Previous: <a href="highlighting.html" title="previous chapter">Highlighting</a></li>
      <li>Next: <a href="autocomplete.html" title="next chapter">Autocomplete</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/faceting.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2009-2016, Daniel Lindsley.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/faceting.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>