
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started with Haystack &#8212; Haystack 2.5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Views &amp; Forms" href="views_and_forms.html" />
    <link rel="prev" title="Welcome to Haystack!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started-with-haystack">
<span id="ref-tutorial"></span><h1>Getting Started with Haystack<a class="headerlink" href="#getting-started-with-haystack" title="Permalink to this headline">¶</a></h1>
<p>Search is a topic of ever increasing importance. Users increasing rely on search
to separate signal from noise and find what they’re looking for quickly. In
addition, search can provide insight into what things are popular (many
searches), what things are difficult to find on the site and ways you can
improve the site better.</p>
<p>To this end, Haystack tries to make integrating custom search as easy as
possible while being flexible/powerful enough to handle more advanced use cases.</p>
<p>Haystack is a reusable app (that is, it relies only on its own code and focuses
on providing just search) that plays nicely with both apps you control as well as
third-party apps (such as <code class="docutils literal"><span class="pre">django.contrib.*</span></code>) without having to modify the
sources.</p>
<p>Haystack also does pluggable backends (much like Django’s database
layer), so virtually all of the code you write ought to be portable between
whichever search engine you choose.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you hit a stumbling block, there is both a <a class="reference external" href="http://groups.google.com/group/django-haystack">mailing list</a> and
<a class="reference external" href="irc://irc.freenode.net/haystack">#haystack on irc.freenode.net</a> to get help.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can participate in and/or track the development of Haystack by
subscribing to the <a class="reference external" href="http://groups.google.com/group/django-haystack-dev">development mailing list</a>.</p>
</div>
<p>This tutorial assumes that you have a basic familiarity with the various major
parts of Django (models/forms/views/settings/URLconfs) and tailored to the
typical use case. There are shortcuts available as well as hooks for much
more advanced setups, but those will not be covered here.</p>
<p>For example purposes, we’ll be adding search functionality to a simple
note-taking application. Here is <code class="docutils literal"><span class="pre">myapp/models.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="k">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="k">import</span> <span class="n">User</span>


<span class="k">class</span> <span class="nc">Note</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
<p>Finally, before starting with Haystack, you will want to choose a search
backend to get started. There is a quick-start guide to
<a class="reference internal" href="installing_search_engines.html"><span class="doc">Installing Search Engines</span></a>, though you may want to defer to each engine’s
official instructions.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Use your favorite Python package manager to install the app from PyPI, e.g.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">django</span><span class="o">-</span><span class="n">haystack</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-haystack-to-installed-apps">
<h3>Add Haystack To <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code><a class="headerlink" href="#add-haystack-to-installed-apps" title="Permalink to this headline">¶</a></h3>
<p>As with most Django applications, you should add Haystack to the
<code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code> within your settings file (usually <code class="docutils literal"><span class="pre">settings.py</span></code>).</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sites&#39;</span><span class="p">,</span>

    <span class="c1"># Added.</span>
    <span class="s1">&#39;haystack&#39;</span><span class="p">,</span>

    <span class="c1"># Then your usual apps...</span>
    <span class="s1">&#39;blog&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="modify-your-settings-py">
<h3>Modify Your <code class="docutils literal"><span class="pre">settings.py</span></code><a class="headerlink" href="#modify-your-settings-py" title="Permalink to this headline">¶</a></h3>
<p>Within your <code class="docutils literal"><span class="pre">settings.py</span></code>, you’ll need to add a setting to indicate where your
site configuration file will live and which backend to use, as well as other
settings for that backend.</p>
<p><code class="docutils literal"><span class="pre">HAYSTACK_CONNECTIONS</span></code> is a required setting and should be at least one of
the following:</p>
<div class="section" id="solr">
<h4>Solr<a class="headerlink" href="#solr" title="Permalink to this headline">¶</a></h4>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HAYSTACK_CONNECTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack.backends.solr_backend.SolrEngine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;URL&#39;</span><span class="p">:</span> <span class="s1">&#39;http://127.0.0.1:8983/solr&#39;</span>
        <span class="c1"># ...or for multicore...</span>
        <span class="c1"># &#39;URL&#39;: &#39;http://127.0.0.1:8983/solr/mysite&#39;,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="elasticsearch">
<h4>Elasticsearch<a class="headerlink" href="#elasticsearch" title="Permalink to this headline">¶</a></h4>
<p>Example (ElasticSearch 1.x):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HAYSTACK_CONNECTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack.backends.elasticsearch_backend.ElasticsearchSearchEngine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;URL&#39;</span><span class="p">:</span> <span class="s1">&#39;http://127.0.0.1:9200/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;INDEX_NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example (ElasticSearch 2.x):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HAYSTACK_CONNECTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack.backends.elasticsearch2_backend.Elasticsearch2SearchEngine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;URL&#39;</span><span class="p">:</span> <span class="s1">&#39;http://127.0.0.1:9200/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;INDEX_NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="whoosh">
<h4>Whoosh<a class="headerlink" href="#whoosh" title="Permalink to this headline">¶</a></h4>
<p>Requires setting <code class="docutils literal"><span class="pre">PATH</span></code> to the place on your filesystem where the
Whoosh index should be located. Standard warnings about permissions and keeping
it out of a place your webserver may serve documents out of apply.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">HAYSTACK_CONNECTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack.backends.whoosh_backend.WhooshEngine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PATH&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;whoosh_index&#39;</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="xapian">
<h4>Xapian<a class="headerlink" href="#xapian" title="Permalink to this headline">¶</a></h4>
<p>First, install the Xapian backend (via
<a class="reference external" href="http://github.com/notanumber/xapian-haystack/tree/master">http://github.com/notanumber/xapian-haystack/tree/master</a>) per the instructions
included with the backend.</p>
<p>Requires setting <code class="docutils literal"><span class="pre">PATH</span></code> to the place on your filesystem where the
Xapian index should be located. Standard warnings about permissions and keeping
it out of a place your webserver may serve documents out of apply.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">HAYSTACK_CONNECTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;xapian_backend.XapianEngine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PATH&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;xapian_index&#39;</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="simple">
<h4>Simple<a class="headerlink" href="#simple" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">simple</span></code> backend using very basic matching via the database itself. It’s
not recommended for production use but it will return results.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This backend does <em>NOT</em> work like the other backends do. Data preparation
does nothing &amp; advanced filtering calls do not work. You really probably
don’t want this unless you’re in an environment where you just want to
silence Haystack.</p>
</div>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HAYSTACK_CONNECTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;haystack.backends.simple_backend.SimpleEngine&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="handling-data">
<h2>Handling Data<a class="headerlink" href="#handling-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-searchindexes">
<h3>Creating <code class="docutils literal"><span class="pre">SearchIndexes</span></code><a class="headerlink" href="#creating-searchindexes" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">SearchIndex</span></code> objects are the way Haystack determines what data should be
placed in the search index and handles the flow of data in. You can think of
them as being similar to Django <code class="docutils literal"><span class="pre">Models</span></code> or <code class="docutils literal"><span class="pre">Forms</span></code> in that they are
field-based and manipulate/store data.</p>
<p>You generally create a unique <code class="docutils literal"><span class="pre">SearchIndex</span></code> for each type of <code class="docutils literal"><span class="pre">Model</span></code> you
wish to index, though you can reuse the same <code class="docutils literal"><span class="pre">SearchIndex</span></code> between different
models if you take care in doing so and your field names are very standardized.</p>
<p>To build a <code class="docutils literal"><span class="pre">SearchIndex</span></code>, all that’s necessary is to subclass both
<code class="docutils literal"><span class="pre">indexes.SearchIndex</span></code> &amp; <code class="docutils literal"><span class="pre">indexes.Indexable</span></code>,
define the fields you want to store data with and define a <code class="docutils literal"><span class="pre">get_model</span></code> method.</p>
<p>We’ll create the following <code class="docutils literal"><span class="pre">NoteIndex</span></code> to correspond to our <code class="docutils literal"><span class="pre">Note</span></code>
model. This code generally goes in a <code class="docutils literal"><span class="pre">search_indexes.py</span></code> file within the app
it applies to, though that is not required. This allows
Haystack to automatically pick it up. The <code class="docutils literal"><span class="pre">NoteIndex</span></code> should look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">haystack</span> <span class="k">import</span> <span class="n">indexes</span>
<span class="kn">from</span> <span class="nn">myapp.models</span> <span class="k">import</span> <span class="n">Note</span>


<span class="k">class</span> <span class="nc">NoteIndex</span><span class="p">(</span><span class="n">indexes</span><span class="o">.</span><span class="n">SearchIndex</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">Indexable</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">document</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_template</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">model_attr</span><span class="o">=</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">indexes</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">model_attr</span><span class="o">=</span><span class="s1">&#39;pub_date&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Note</span>

    <span class="k">def</span> <span class="nf">index_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">using</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Used when the entire index for model is updated.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_model</span><span class="p">()</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__lte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</pre></div>
</div>
<p>Every <code class="docutils literal"><span class="pre">SearchIndex</span></code> requires there be one (and only one) field with
<code class="docutils literal"><span class="pre">document=True</span></code>. This indicates to both Haystack and the search engine about
which field is the primary field for searching within.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>When you choose a <code class="docutils literal"><span class="pre">document=True</span></code> field, it should be consistently named
across all of your <code class="docutils literal"><span class="pre">SearchIndex</span></code> classes to avoid confusing the backend.
The convention is to name this field <code class="docutils literal"><span class="pre">text</span></code>.</p>
<p class="last">There is nothing special about the <code class="docutils literal"><span class="pre">text</span></code> field name used in all of the
examples. It could be anything; you could call it <code class="docutils literal"><span class="pre">pink_polka_dot</span></code> and
it won’t matter. It’s simply a convention to call it <code class="docutils literal"><span class="pre">text</span></code>.</p>
</div>
<p>Additionally, we’re providing <code class="docutils literal"><span class="pre">use_template=True</span></code> on the <code class="docutils literal"><span class="pre">text</span></code> field. This
allows us to use a data template (rather than error-prone concatenation) to
build the document the search engine will index. You’ll need to
create a new template inside your template directory called
<code class="docutils literal"><span class="pre">search/indexes/myapp/note_text.txt</span></code> and place the following inside:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">title</span> <span class="p">}}</span>
<span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">get_full_name</span> <span class="p">}}</span>
<span class="p">{{</span> <span class="nb">object</span><span class="o">.</span><span class="n">body</span> <span class="p">}}</span>
</pre></div>
</div>
<p>In addition, we added several other fields (<code class="docutils literal"><span class="pre">author</span></code> and <code class="docutils literal"><span class="pre">pub_date</span></code>). These
are useful when you want to provide additional filtering options. Haystack comes
with a variety of <code class="docutils literal"><span class="pre">SearchField</span></code> classes to handle most types of data.</p>
<p>A common theme is to allow admin users to add future content but have it not
display on the site until that future date is reached. We specify a custom
<code class="docutils literal"><span class="pre">index_queryset</span></code> method to prevent those future items from being indexed.</p>
</div>
</div>
<div class="section" id="setting-up-the-views">
<h2>Setting Up The Views<a class="headerlink" href="#setting-up-the-views" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-the-searchview-to-your-urlconf">
<h3>Add The <code class="docutils literal"><span class="pre">SearchView</span></code> To Your URLconf<a class="headerlink" href="#add-the-searchview-to-your-urlconf" title="Permalink to this headline">¶</a></h3>
<p>Within your URLconf, add the following line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^search/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;haystack.urls&#39;</span><span class="p">)),</span>
</pre></div>
</div>
<p>This will pull in the default URLconf for Haystack. It consists of a single
URLconf that points to a <code class="docutils literal"><span class="pre">SearchView</span></code> instance. You can change this class’s
behavior by passing it any of several keyword arguments or override it entirely
with your own view.</p>
</div>
<div class="section" id="search-template">
<h3>Search Template<a class="headerlink" href="#search-template" title="Permalink to this headline">¶</a></h3>
<p>Your search template (<code class="docutils literal"><span class="pre">search/search.html</span></code> for the default case) will likely
be very simple. The following is enough to get going (your template/block names
will likely differ):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="s1">&#39;base.html&#39;</span> <span class="o">%</span><span class="p">}</span>

<span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">content</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="n">Search</span><span class="o">&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">form</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;get&quot;</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">table</span><span class="o">&gt;</span>
            <span class="p">{{</span> <span class="n">form</span><span class="o">.</span><span class="n">as_table</span> <span class="p">}}</span>
            <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;&amp;</span><span class="n">nbsp</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Search&quot;</span><span class="o">&gt;</span>
                <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>

        <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">query</span> <span class="o">%</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="n">Results</span><span class="o">&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>

            <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">object_list</span> <span class="o">%</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{{ result.object.get_absolute_url }}&quot;</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">result</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">title</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
                <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
            <span class="p">{</span><span class="o">%</span> <span class="n">empty</span> <span class="o">%</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">No</span> <span class="n">results</span> <span class="n">found</span><span class="o">.&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
            <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>

            <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">has_previous</span> <span class="ow">or</span> <span class="n">page</span><span class="o">.</span><span class="n">has_next</span> <span class="o">%</span><span class="p">}</span>
                <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">has_previous</span> <span class="o">%</span><span class="p">}</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;?q={{ query }}&amp;amp;page={{ page.previous_page_number }}&quot;</span><span class="o">&gt;</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span><span class="o">&amp;</span><span class="n">laquo</span><span class="p">;</span> <span class="n">Previous</span><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">has_previous</span> <span class="o">%</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
                    <span class="o">|</span>
                    <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">has_next</span> <span class="o">%</span><span class="p">}</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;?q={{ query }}&amp;amp;page={{ page.next_page_number }}&quot;</span><span class="o">&gt;</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span><span class="n">Next</span> <span class="o">&amp;</span><span class="n">raquo</span><span class="p">;{</span><span class="o">%</span> <span class="k">if</span> <span class="n">page</span><span class="o">.</span><span class="n">has_next</span> <span class="o">%</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span><span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
                <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
            <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="c1"># Show some example queries to run, maybe query syntax, something else? #}</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal"><span class="pre">page.object_list</span></code> is actually a list of <code class="docutils literal"><span class="pre">SearchResult</span></code>
objects instead of individual models. These objects have all the data returned
from that record within the search index as well as score. They can also
directly access the model for the result via <code class="docutils literal"><span class="pre">{{</span> <span class="pre">result.object</span> <span class="pre">}}</span></code>. So the
<code class="docutils literal"><span class="pre">{{</span> <span class="pre">result.object.title</span> <span class="pre">}}</span></code> uses the actual <code class="docutils literal"><span class="pre">Note</span></code> object in the database
and accesses its <code class="docutils literal"><span class="pre">title</span></code> field.</p>
</div>
<div class="section" id="reindex">
<h3>Reindex<a class="headerlink" href="#reindex" title="Permalink to this headline">¶</a></h3>
<p>The final step, now that you have everything setup, is to put your data in
from your database into the search index. Haystack ships with a management
command to make this process easy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you’re using the Solr backend, you have an extra step. Solr’s
configuration is XML-based, so you’ll need to manually regenerate the
schema. You should run
<code class="docutils literal"><span class="pre">./manage.py</span> <span class="pre">build_solr_schema</span></code> first, drop the XML output in your
Solr’s <code class="docutils literal"><span class="pre">schema.xml</span></code> file and restart your Solr server.</p>
</div>
<p>Simply run <code class="docutils literal"><span class="pre">./manage.py</span> <span class="pre">rebuild_index</span></code>. You’ll get some totals of how many
models were processed and placed in the index.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Using the standard <code class="docutils literal"><span class="pre">SearchIndex</span></code>, your search index content is only
updated whenever you run either <code class="docutils literal"><span class="pre">./manage.py</span> <span class="pre">update_index</span></code> or start
afresh with <code class="docutils literal"><span class="pre">./manage.py</span> <span class="pre">rebuild_index</span></code>.</p>
<p>You should cron up a <code class="docutils literal"><span class="pre">./manage.py</span> <span class="pre">update_index</span></code> job at whatever interval
works best for your site (using <code class="docutils literal"><span class="pre">--age=&lt;num_hours&gt;</span></code> reduces the number of
things to update).</p>
<p class="last">Alternatively, if you have low traffic and/or your search engine can handle
it, the <code class="docutils literal"><span class="pre">RealtimeSignalProcessor</span></code> automatically handles updates/deletes
for you.</p>
</div>
</div>
</div>
<div class="section" id="complete">
<h2>Complete!<a class="headerlink" href="#complete" title="Permalink to this headline">¶</a></h2>
<p>You can now visit the search section of your site, enter a search query and
receive search results back for the query! Congratulations!</p>
</div>
<div class="section" id="what-s-next">
<h2>What’s Next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>This tutorial just scratches the surface of what Haystack provides. The
<code class="docutils literal"><span class="pre">SearchQuerySet</span></code> is the underpinning of all search in Haystack and provides
a powerful, <code class="docutils literal"><span class="pre">QuerySet</span></code>-like API (see <a class="reference internal" href="searchqueryset_api.html#ref-searchqueryset-api"><span class="std std-ref">SearchQuerySet API</span></a>). You can
use much more complicated <code class="docutils literal"><span class="pre">SearchForms</span></code>/<code class="docutils literal"><span class="pre">SearchViews</span></code> to give users a better
UI (see <a class="reference internal" href="views_and_forms.html#ref-views-and-forms"><span class="std std-ref">Views &amp; Forms</span></a>). And the <a class="reference internal" href="best_practices.html#ref-best-practices"><span class="std std-ref">Best Practices</span></a> provides
insight into non-obvious or advanced usages of Haystack.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="toc.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting Started with Haystack</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#add-haystack-to-installed-apps">Add Haystack To <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code></a></li>
<li><a class="reference internal" href="#modify-your-settings-py">Modify Your <code class="docutils literal"><span class="pre">settings.py</span></code></a><ul>
<li><a class="reference internal" href="#solr">Solr</a></li>
<li><a class="reference internal" href="#elasticsearch">Elasticsearch</a></li>
<li><a class="reference internal" href="#whoosh">Whoosh</a></li>
<li><a class="reference internal" href="#xapian">Xapian</a></li>
<li><a class="reference internal" href="#simple">Simple</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#handling-data">Handling Data</a><ul>
<li><a class="reference internal" href="#creating-searchindexes">Creating <code class="docutils literal"><span class="pre">SearchIndexes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-up-the-views">Setting Up The Views</a><ul>
<li><a class="reference internal" href="#add-the-searchview-to-your-urlconf">Add The <code class="docutils literal"><span class="pre">SearchView</span></code> To Your URLconf</a></li>
<li><a class="reference internal" href="#search-template">Search Template</a></li>
<li><a class="reference internal" href="#reindex">Reindex</a></li>
</ul>
</li>
<li><a class="reference internal" href="#complete">Complete!</a></li>
<li><a class="reference internal" href="#what-s-next">What’s Next?</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="toc.html">Documentation overview</a><ul>
  <li><a href="index.html">Welcome to Haystack!</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Haystack!</a></li>
      <li>Next: <a href="views_and_forms.html" title="next chapter">Views &amp; Forms</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2009-2016, Daniel Lindsley.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>