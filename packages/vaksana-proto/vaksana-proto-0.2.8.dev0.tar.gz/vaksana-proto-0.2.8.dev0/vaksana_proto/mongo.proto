syntax = "proto3";

option objc_class_prefix = "VAKSANA";

import "vaksana.proto";

package mongoclient;

service MongoC {
    // To confirm if the service is up
    rpc IsActive        (vaksana.Void)         returns (vaksana.Void)    {}
    rpc Cleanup         (Module)               returns (vaksana.ErrCode) {}
    rpc SaveCredentials (vaksana.Credentials)  returns (vaksana.ErrCode) {}

    rpc Register        (Module)               returns (vaksana.ErrCode) {}
    rpc Connect         (vaksana.Server)               returns (vaksana.ErrCode) {}

    rpc Set             (Record)               returns (vaksana.ErrCode) {}
    rpc Get             (Query)                returns (stream Data)     {}
    rpc UpdateOrInsert  (KeyVal)               returns (vaksana.ErrCode) {}
    rpc Delete          (Query)                returns (vaksana.ErrCode) {}
}

message Module {
    string dbname = 1;
    string collection = 2;
}

message Data {
	string data = 1;
}

message Record {
    Module module = 1;
    Data data = 2;
    int32 ttl = 3;
}

message Query {
	Module module = 1;
	Data query = 2;
	Data fields = 3;
	Data sortq = 4;
}

message KeyVal {
	Query  key = 1;
	Record val = 2;
}
