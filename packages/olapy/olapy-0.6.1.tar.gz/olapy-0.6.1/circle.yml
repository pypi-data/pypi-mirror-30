machine:
  post:
    - pyenv global 2.7.11 3.6.2
  services:
    - postgresql
    - mysql

database:
  override:
    - createdb sales_postgres
    - echo "CREATE USER IF NOT EXISTS 'root_db'@'localhost' IDENTIFIED BY 'toor'" | mysql -u root
    - echo "GRANT ALL PRIVILEGES ON *.* TO 'root_db'@'localhost' WITH GRANT OPTION" | mysql -u root
    - echo "FLUSH PRIVILEGES" | mysql -u root
    - echo "CREATE DATABASE IF NOT EXISTS sales_mysql" | mysql -u root

dependencies:
  cache_directories:
     - "~/.cache/"
  override:
    - pip install -U pip tox tox-pyenv wheel
    # Just to fill up the cache (to speed up later builds)
    - pyenv local 2.7.11 3.6.2
    - pip install -q -r requirements.txt

test:
  override:
    - tox
